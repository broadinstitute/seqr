(self.webpackChunkseqr=self.webpackChunkseqr||[]).push([[854],{37345:function(t,e,n){"use strict";n.d(e,{oh:function(){return m},Kn:function(){return l.Z},eF:function(){return l.D}});var i=n(3839),r=n(42274),a=n(69607),o=n(5130),s=n(92992),l=n(14827),u=n(12828);function c(t){return function(){return t}}function h(t,e,n,i,r,a,o,s,l,u){this.target=t,this.type=e,this.subject=n,this.identifier=i,this.active=r,this.x=a,this.y=o,this.dx=s,this.dy=l,this._=u}function f(){return!r.B.ctrlKey&&!r.B.button}function d(){return this.parentNode}function p(t){return null==t?{x:r.B.x,y:r.B.y}:t}function _(){return navigator.maxTouchPoints||"ontouchstart"in this}function m(){var t,e,n,m,y=f,g=d,x=p,v=_,b={},w=(0,i.Z)("start","drag","end"),z=0,k=0;function M(t){t.on("mousedown.drag",T).filter(v).on("touchstart.drag",S).on("touchmove.drag",N).on("touchend.drag touchcancel.drag",Z).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function T(){if(!m&&y.apply(this,arguments)){var i=O("mouse",g.apply(this,arguments),a.Z,this,arguments);i&&((0,o.Z)(r.B.view).on("mousemove.drag",E,!0).on("mouseup.drag",A,!0),(0,l.Z)(r.B.view),(0,u.r)(),n=!1,t=r.B.clientX,e=r.B.clientY,i("start"))}}function E(){if((0,u.Z)(),!n){var i=r.B.clientX-t,a=r.B.clientY-e;n=i*i+a*a>k}b.mouse("drag")}function A(){(0,o.Z)(r.B.view).on("mousemove.drag mouseup.drag",null),(0,l.D)(r.B.view,n),(0,u.Z)(),b.mouse("end")}function S(){if(y.apply(this,arguments)){var t,e,n=r.B.changedTouches,i=g.apply(this,arguments),a=n.length;for(t=0;t<a;++t)(e=O(n[t].identifier,i,s.Z,this,arguments))&&((0,u.r)(),e("start"))}}function N(){var t,e,n=r.B.changedTouches,i=n.length;for(t=0;t<i;++t)(e=b[n[t].identifier])&&((0,u.Z)(),e("drag"))}function Z(){var t,e,n=r.B.changedTouches,i=n.length;for(m&&clearTimeout(m),m=setTimeout((function(){m=null}),500),t=0;t<i;++t)(e=b[n[t].identifier])&&((0,u.r)(),e("end"))}function O(t,e,n,i,a){var o,s,l,u=n(e,t),c=w.copy();if((0,r._H)(new h(M,"beforestart",o,t,z,u[0],u[1],0,0,c),(function(){return null!=(r.B.subject=o=x.apply(i,a))&&(s=o.x-u[0]||0,l=o.y-u[1]||0,!0)})))return function f(d){var p,_=u;switch(d){case"start":b[t]=f,p=z++;break;case"end":delete b[t],--z;case"drag":u=n(e,t),p=z}(0,r._H)(new h(M,d,o,t,p,u[0]+s,u[1]+l,u[0]-_[0],u[1]-_[1],c),c.apply,c,[d,i,a])}}return M.filter=function(t){return arguments.length?(y="function"==typeof t?t:c(!!t),M):y},M.container=function(t){return arguments.length?(g="function"==typeof t?t:c(t),M):g},M.subject=function(t){return arguments.length?(x="function"==typeof t?t:c(t),M):x},M.touchable=function(t){return arguments.length?(v="function"==typeof t?t:c(!!t),M):v},M.on=function(){var t=w.on.apply(w,arguments);return t===w?M:t},M.clickDistance=function(t){return arguments.length?(k=(t=+t)*t,M):Math.sqrt(k)},M}h.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t}},14827:function(t,e,n){"use strict";n.d(e,{Z:function(){return a},D:function(){return o}});var i=n(5130),r=n(12828);function a(t){var e=t.document.documentElement,n=(0,i.Z)(t).on("dragstart.drag",r.Z,!0);"onselectstart"in e?n.on("selectstart.drag",r.Z,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function o(t,e){var n=t.document.documentElement,a=(0,i.Z)(t).on("dragstart.drag",null);e&&(a.on("click.drag",r.Z,!0),setTimeout((function(){a.on("click.drag",null)}),0)),"onselectstart"in n?a.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}},12828:function(t,e,n){"use strict";n.d(e,{r:function(){return r},Z:function(){return a}});var i=n(42274);function r(){i.B.stopImmediatePropagation()}function a(){i.B.preventDefault(),i.B.stopImmediatePropagation()}},47367:function(t,e,n){"use strict";function i(t,e){return t.parent===e.parent?1:2}function r(t,e){return t+e.x}function a(t,e){return Math.max(t,e.y)}function o(){var t=i,e=1,n=1,o=!1;function s(i){var s,l=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(r,0)/t.length}(n),e.y=function(t){return 1+t.reduce(a,0)}(n)):(e.x=s?l+=t(e,s):0,e.y=0,s=e)}));var u=function(t){for(var e;e=t.children;)t=e[0];return t}(i),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),h=u.x-t(u,c)/2,f=c.x+t(c,u)/2;return i.eachAfter(o?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-h)/(f-h)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return s.separation=function(e){return arguments.length?(t=e,s):t},s.size=function(t){return arguments.length?(o=!1,e=+t[0],n=+t[1],s):o?null:[e,n]},s.nodeSize=function(t){return arguments.length?(o=!0,e=+t[0],n=+t[1],s):o?[e,n]:null},s}function s(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;--i>=0;)e+=n[i].value;else e=1;t.value=e}function l(t,e){var n,i,r,a,o,s=new f(t),l=+t.value&&(s.value=t.value),c=[s];for(null==e&&(e=u);n=c.pop();)if(l&&(n.value=+n.data.value),(r=e(n.data))&&(o=r.length))for(n.children=new Array(o),a=o-1;a>=0;--a)c.push(i=n.children[a]=new f(r[a])),i.parent=n,i.depth=n.depth+1;return s.eachBefore(h)}function u(t){return t.children}function c(t){t.data=t.data.data}function h(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function f(t){this.data=t,this.depth=this.height=0,this.parent=null}n.d(e,{ki:function(){return o},bT:function(){return l},P2:function(){return B},O1:function(){return p},jA:function(){return E},uK:function(){return q},QP:function(){return j},G_:function(){return J},pN:function(){return nt},wL:function(){return it},LQ:function(){return C},eA:function(){return at},Km:function(){return $},E_:function(){return rt},o$:function(){return et}}),f.prototype=l.prototype={constructor:f,count:function(){return this.eachAfter(s)},each:function(t){var e,n,i,r,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(i=0,r=n.length;i<r;++i)o.push(n[i])}while(o.length);return this},eachAfter:function(t){for(var e,n,i,r=this,a=[r],o=[];r=a.pop();)if(o.push(r),e=r.children)for(n=0,i=e.length;n<i;++n)a.push(e[n]);for(;r=o.pop();)t(r);return this},eachBefore:function(t){for(var e,n,i=this,r=[i];i=r.pop();)if(t(i),e=i.children)for(n=e.length-1;n>=0;--n)r.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;t=n.pop(),e=i.pop();for(;t===e;)r=t,t=n.pop(),e=i.pop();return r}(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return l(this).eachBefore(c)}};var d=Array.prototype.slice;function p(t){for(var e,n,i=0,r=(t=function(t){for(var e,n,i=t.length;i;)n=Math.random()*i--|0,e=t[i],t[i]=t[n],t[n]=e;return t}(d.call(t))).length,a=[];i<r;)e=t[i],n&&y(n,e)?++i:(n=x(a=_(a,e)),i=0);return n}function _(t,e){var n,i;if(g(e,t))return[e];for(n=0;n<t.length;++n)if(m(e,t[n])&&g(v(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(m(v(t[n],t[i]),e)&&m(v(t[n],e),t[i])&&m(v(t[i],e),t[n])&&g(b(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}function m(t,e){var n=t.r-e.r,i=e.x-t.x,r=e.y-t.y;return n<0||n*n<i*i+r*r}function y(t,e){var n=t.r-e.r+1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function g(t,e){for(var n=0;n<e.length;++n)if(!y(t,e[n]))return!1;return!0}function x(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return v(t[0],t[1]);case 3:return b(t[0],t[1],t[2])}var e}function v(t,e){var n=t.x,i=t.y,r=t.r,a=e.x,o=e.y,s=e.r,l=a-n,u=o-i,c=s-r,h=Math.sqrt(l*l+u*u);return{x:(n+a+l/h*c)/2,y:(i+o+u/h*c)/2,r:(h+r+s)/2}}function b(t,e,n){var i=t.x,r=t.y,a=t.r,o=e.x,s=e.y,l=e.r,u=n.x,c=n.y,h=n.r,f=i-o,d=i-u,p=r-s,_=r-c,m=l-a,y=h-a,g=i*i+r*r-a*a,x=g-o*o-s*s+l*l,v=g-u*u-c*c+h*h,b=d*p-f*_,w=(p*v-_*x)/(2*b)-i,z=(_*m-p*y)/b,k=(d*x-f*v)/(2*b)-r,M=(f*y-d*m)/b,T=z*z+M*M-1,E=2*(a+w*z+k*M),A=w*w+k*k-a*a,S=-(T?(E+Math.sqrt(E*E-4*T*A))/(2*T):A/E);return{x:i+w+z*S,y:r+k+M*S,r:S}}function w(t,e,n){var i,r,a,o,s=t.x-e.x,l=t.y-e.y,u=s*s+l*l;u?(r=e.r+n.r,r*=r,o=t.r+n.r,r>(o*=o)?(i=(u+o-r)/(2*u),a=Math.sqrt(Math.max(0,o/u-i*i)),n.x=t.x-i*s-a*l,n.y=t.y-i*l+a*s):(i=(u+r-o)/(2*u),a=Math.sqrt(Math.max(0,r/u-i*i)),n.x=e.x+i*s-a*l,n.y=e.y+i*l+a*s)):(n.x=e.x+n.r,n.y=e.y)}function z(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function k(t){var e=t._,n=t.next._,i=e.r+n.r,r=(e.x*n.r+n.x*e.r)/i,a=(e.y*n.r+n.y*e.r)/i;return r*r+a*a}function M(t){this._=t,this.next=null,this.previous=null}function T(t){if(!(r=t.length))return 0;var e,n,i,r,a,o,s,l,u,c,h;if((e=t[0]).x=0,e.y=0,!(r>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(r>2))return e.r+n.r;w(n,e,i=t[2]),e=new M(e),n=new M(n),i=new M(i),e.next=i.previous=n,n.next=e.previous=i,i.next=n.previous=e;t:for(s=3;s<r;++s){w(e._,n._,i=t[s]),i=new M(i),l=n.next,u=e.previous,c=n._.r,h=e._.r;do{if(c<=h){if(z(l._,i._)){n=l,e.next=n,n.previous=e,--s;continue t}c+=l._.r,l=l.next}else{if(z(u._,i._)){(e=u).next=n,n.previous=e,--s;continue t}h+=u._.r,u=u.previous}}while(l!==u.next);for(i.previous=e,i.next=n,e.next=n.previous=n=i,a=k(e);(i=i.next)!==n;)(o=k(i))<a&&(e=i,a=o);n=e.next}for(e=[n._],i=n;(i=i.next)!==n;)e.push(i._);for(i=p(e),s=0;s<r;++s)(e=t[s]).x-=i.x,e.y-=i.y;return i.r}function E(t){return T(t),t}function A(t){return null==t?null:S(t)}function S(t){if("function"!=typeof t)throw new Error;return t}function N(){return 0}function Z(t){return function(){return t}}function O(t){return Math.sqrt(t.value)}function B(){var t=null,e=1,n=1,i=N;function r(r){return r.x=e/2,r.y=n/2,t?r.eachBefore(I(t)).eachAfter(F(i,.5)).eachBefore(D(1)):r.eachBefore(I(O)).eachAfter(F(N,1)).eachAfter(F(i,r.r/Math.min(e,n))).eachBefore(D(Math.min(e,n)/(2*r.r))),r}return r.radius=function(e){return arguments.length?(t=A(e),r):t},r.size=function(t){return arguments.length?(e=+t[0],n=+t[1],r):[e,n]},r.padding=function(t){return arguments.length?(i="function"==typeof t?t:Z(+t),r):i},r}function I(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function F(t,e){return function(n){if(i=n.children){var i,r,a,o=i.length,s=t(n)*e||0;if(s)for(r=0;r<o;++r)i[r].r+=s;if(a=T(i),s)for(r=0;r<o;++r)i[r].r-=s;n.r=a+s}}}function D(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function L(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function C(t,e,n,i,r){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(i-e)/t.value;++s<l;)(a=o[s]).y0=n,a.y1=r,a.x0=e,a.x1=e+=a.value*u}function q(){var t=1,e=1,n=0,i=!1;function r(r){var a=r.height+1;return r.x0=r.y0=n,r.x1=t,r.y1=e/a,r.eachBefore(function(t,e){return function(i){i.children&&C(i,i.x0,t*(i.depth+1)/e,i.x1,t*(i.depth+2)/e);var r=i.x0,a=i.y0,o=i.x1-n,s=i.y1-n;o<r&&(r=o=(r+o)/2),s<a&&(a=s=(a+s)/2),i.x0=r,i.y0=a,i.x1=o,i.y1=s}}(e,a)),i&&r.eachBefore(L),r}return r.round=function(t){return arguments.length?(i=!!t,r):i},r.size=function(n){return arguments.length?(t=+n[0],e=+n[1],r):[t,e]},r.padding=function(t){return arguments.length?(n=+t,r):n},r}var P={depth:-1},U={};function Y(t){return t.id}function R(t){return t.parentId}function j(){var t=Y,e=R;function n(n){var i,r,a,o,s,l,u,c=n.length,d=new Array(c),p={};for(r=0;r<c;++r)i=n[r],s=d[r]=new f(i),null!=(l=t(i,r,n))&&(l+="")&&(p[u="$"+(s.id=l)]=u in p?U:s);for(r=0;r<c;++r)if(s=d[r],null!=(l=e(n[r],r,n))&&(l+="")){if(!(o=p["$"+l]))throw new Error("missing: "+l);if(o===U)throw new Error("ambiguous: "+l);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=P,a.eachBefore((function(t){t.depth=t.parent.depth+1,--c})).eachBefore(h),a.parent=null,c>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=S(e),n):t},n.parentId=function(t){return arguments.length?(e=S(t),n):e},n}function H(t,e){return t.parent===e.parent?1:2}function G(t){var e=t.children;return e?e[0]:t.t}function V(t){var e=t.children;return e?e[e.length-1]:t.t}function X(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function K(t,e,n){return t.a.parent===e.parent?t.a:n}function W(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function J(){var t=H,e=1,n=1,i=null;function r(r){var l=function(t){for(var e,n,i,r,a,o=new W(t,0),s=[o];e=s.pop();)if(i=e._.children)for(e.children=new Array(a=i.length),r=a-1;r>=0;--r)s.push(n=e.children[r]=new W(i[r],r)),n.parent=e;return(o.parent=new W(null,0)).children=[o],o}(r);if(l.eachAfter(a),l.parent.m=-l.z,l.eachBefore(o),i)r.eachBefore(s);else{var u=r,c=r,h=r;r.eachBefore((function(t){t.x<u.x&&(u=t),t.x>c.x&&(c=t),t.depth>h.depth&&(h=t)}));var f=u===c?1:t(u,c)/2,d=f-u.x,p=e/(c.x+f+d),_=n/(h.depth||1);r.eachBefore((function(t){t.x=(t.x+d)*p,t.y=t.depth*_}))}return r}function a(e){var n=e.children,i=e.parent.children,r=e.i?i[e.i-1]:null;if(n){!function(t){for(var e,n=0,i=0,r=t.children,a=r.length;--a>=0;)(e=r[a]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(e);var a=(n[0].z+n[n.length-1].z)/2;r?(e.z=r.z+t(e._,r._),e.m=e.z-a):e.z=a}else r&&(e.z=r.z+t(e._,r._));e.parent.A=function(e,n,i){if(n){for(var r,a=e,o=e,s=n,l=a.parent.children[0],u=a.m,c=o.m,h=s.m,f=l.m;s=V(s),a=G(a),s&&a;)l=G(l),(o=V(o)).a=e,(r=s.z+h-a.z-u+t(s._,a._))>0&&(X(K(s,e,i),e,r),u+=r,c+=r),h+=s.m,u+=a.m,f+=l.m,c+=o.m;s&&!V(o)&&(o.t=s,o.m+=h-c),a&&!G(l)&&(l.t=a,l.m+=u-f,i=e)}return i}(e,r,e.parent.A||i[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return r.separation=function(e){return arguments.length?(t=e,r):t},r.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],r):i?null:[e,n]},r.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],r):i?[e,n]:null},r}function $(t,e,n,i,r){for(var a,o=t.children,s=-1,l=o.length,u=t.value&&(r-n)/t.value;++s<l;)(a=o[s]).x0=e,a.x1=i,a.y0=n,a.y1=n+=a.value*u}W.prototype=Object.create(f.prototype);var Q=(1+Math.sqrt(5))/2;function tt(t,e,n,i,r,a){for(var o,s,l,u,c,h,f,d,p,_,m,y=[],g=e.children,x=0,v=0,b=g.length,w=e.value;x<b;){l=r-n,u=a-i;do{c=g[v++].value}while(!c&&v<b);for(h=f=c,m=c*c*(_=Math.max(u/l,l/u)/(w*t)),p=Math.max(f/m,m/h);v<b;++v){if(c+=s=g[v].value,s<h&&(h=s),s>f&&(f=s),m=c*c*_,(d=Math.max(f/m,m/h))>p){c-=s;break}p=d}y.push(o={value:c,dice:l<u,children:g.slice(x,v)}),o.dice?C(o,n,i,r,w?i+=u*c/w:a):$(o,n,i,w?n+=l*c/w:r,a),w-=c,x=v}return y}var et=function t(e){function n(t,n,i,r,a){tt(e,t,n,i,r,a)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Q);function nt(){var t=et,e=!1,n=1,i=1,r=[0],a=N,o=N,s=N,l=N,u=N;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=i,t.eachBefore(h),r=[0],e&&t.eachBefore(L),t}function h(e){var n=r[e.depth],i=e.x0+n,c=e.y0+n,h=e.x1-n,f=e.y1-n;h<i&&(i=h=(i+h)/2),f<c&&(c=f=(c+f)/2),e.x0=i,e.y0=c,e.x1=h,e.y1=f,e.children&&(n=r[e.depth+1]=a(e)/2,i+=u(e)-n,c+=o(e)-n,(h-=s(e)-n)<i&&(i=h=(i+h)/2),(f-=l(e)-n)<c&&(c=f=(c+f)/2),t(e,i,c,h,f))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],i=+t[1],c):[n,i]},c.tile=function(e){return arguments.length?(t=S(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(a="function"==typeof t?t:Z(+t),c):a},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(o="function"==typeof t?t:Z(+t),c):o},c.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:Z(+t),c):s},c.paddingBottom=function(t){return arguments.length?(l="function"==typeof t?t:Z(+t),c):l},c.paddingLeft=function(t){return arguments.length?(u="function"==typeof t?t:Z(+t),c):u},c}function it(t,e,n,i,r){var a,o,s=t.children,l=s.length,u=new Array(l+1);for(u[0]=o=a=0;a<l;++a)u[a+1]=o+=s[a].value;!function t(e,n,i,r,a,o,l){if(e>=n-1){var c=s[e];return c.x0=r,c.y0=a,c.x1=o,void(c.y1=l)}var h=u[e],f=i/2+h,d=e+1,p=n-1;for(;d<p;){var _=d+p>>>1;u[_]<f?d=_+1:p=_}f-u[d-1]<u[d]-f&&e+1<d&&--d;var m=u[d]-h,y=i-m;if(o-r>l-a){var g=(r*y+o*m)/i;t(e,d,m,r,a,g,l),t(d,n,y,g,a,o,l)}else{var x=(a*y+l*m)/i;t(e,d,m,r,a,o,x),t(d,n,y,r,x,o,l)}}(0,l,t.value,e,n,i,r)}function rt(t,e,n,i,r){(1&t.depth?$:C)(t,e,n,i,r)}var at=function t(e){function n(t,n,i,r,a){if((o=t._squarify)&&o.ratio===e)for(var o,s,l,u,c,h=-1,f=o.length,d=t.value;++h<f;){for(l=(s=o[h]).children,u=s.value=0,c=l.length;u<c;++u)s.value+=l[u].value;s.dice?C(s,n,i,r,i+=(a-i)*s.value/d):$(s,n,i,n+=(r-n)*s.value/d,a),d-=s.value}else t._squarify=o=tt(e,t,n,i,r,a),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Q)},52508:function(t,e){"use strict";var n=Math.PI,i=2*n,r=1e-6,a=i-r;function o(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function s(){return new o}o.prototype=s.prototype={constructor:o,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},arcTo:function(t,e,i,a,o){t=+t,e=+e,i=+i,a=+a,o=+o;var s=this._x1,l=this._y1,u=i-t,c=a-e,h=s-t,f=l-e,d=h*h+f*f;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(d>r)if(Math.abs(f*u-c*h)>r&&o){var p=i-s,_=a-l,m=u*u+c*c,y=p*p+_*_,g=Math.sqrt(m),x=Math.sqrt(d),v=o*Math.tan((n-Math.acos((m+d-y)/(2*g*x)))/2),b=v/x,w=v/g;Math.abs(b-1)>r&&(this._+="L"+(t+b*h)+","+(e+b*f)),this._+="A"+o+","+o+",0,0,"+ +(f*p>h*_)+","+(this._x1=t+w*u)+","+(this._y1=e+w*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,o,s,l,u){t=+t,e=+e,u=!!u;var c=(o=+o)*Math.cos(s),h=o*Math.sin(s),f=t+c,d=e+h,p=1^u,_=u?s-l:l-s;if(o<0)throw new Error("negative radius: "+o);null===this._x1?this._+="M"+f+","+d:(Math.abs(this._x1-f)>r||Math.abs(this._y1-d)>r)&&(this._+="L"+f+","+d),o&&(_<0&&(_=_%i+i),_>a?this._+="A"+o+","+o+",0,1,"+p+","+(t-c)+","+(e-h)+"A"+o+","+o+",0,1,"+p+","+(this._x1=f)+","+(this._y1=d):_>r&&(this._+="A"+o+","+o+",0,"+ +(_>=n)+","+p+","+(this._x1=t+o*Math.cos(l))+","+(this._y1=e+o*Math.sin(l))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}},e.Z=s},56164:function(t,e,n){"use strict";n.d(e,{Eb:function(){return d.Z},Ue:function(){return a},Du:function(){return i.Z},_H:function(){return z._H},B:function(){return z.B},I_:function(){return s},C2:function(){return u.Z},Jz:function(){return c.Z},uD:function(){return h.Z},aC:function(){return f.Z},Ys:function(){return r.Z},td:function(){return p.Z},f_:function(){return _.ZP},nZ:function(){return m.Z},UK:function(){return y.Z},oB:function(){return g.S},Fq:function(){return x.Z},W4:function(){return b},u9:function(){return w.Z}});var i=n(35e3),r=n(5130);function a(t){return(0,r.Z)((0,i.Z)(t).call(document.documentElement))}var o=0;function s(){return new l}function l(){this._="@"+(++o).toString(36)}l.prototype=s.prototype={constructor:l,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var u=n(40597),c=n(69607),h=n(60447),f=n(19030),d=n(47882),p=n(56070),_=n(73078),m=n(86408),y=n(43912),g=n(40721),x=n(92992),v=n(98861);function b(t,e){null==e&&(e=(0,v.Z)().touches);for(var n=0,i=e?e.length:0,r=new Array(i);n<i;++n)r[n]=(0,d.Z)(t,e[n]);return r}var w=n(58414),z=n(42274)},69607:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var i=n(98861),r=n(47882);function a(t){var e=(0,i.Z)();return e.changedTouches&&(e=e.changedTouches[0]),(0,r.Z)(t,e)}},47882:function(t,e,n){"use strict";function i(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}n.d(e,{Z:function(){return i}})},56070:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(73078);function r(t){return"string"==typeof t?new i.Y1([document.querySelectorAll(t)],[document.documentElement]):new i.Y1([null==t?[]:t],i.Jz)}},98861:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(42274);function r(){for(var t,e=i.B;t=e.sourceEvent;)e=t;return e}},92992:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var i=n(98861),r=n(47882);function a(t,e,n){arguments.length<3&&(n=e,e=(0,i.Z)().changedTouches);for(var a,o=0,s=e?e.length:0;o<s;++o)if((a=e[o]).identifier===n)return(0,r.Z)(t,a);return null}},45902:function(t,e,n){"use strict";n.d(e,{Z:function(){return l}});var i=n(52508),r=n(56297),a=n(41545),o=n(23780),s=n(32337);function l(){var t=s.x,e=null,n=(0,r.Z)(0),l=s.y,u=(0,r.Z)(!0),c=null,h=a.Z,f=null;function d(r){var a,o,s,d,p,_=r.length,m=!1,y=new Array(_),g=new Array(_);for(null==c&&(f=h(p=(0,i.Z)())),a=0;a<=_;++a){if(!(a<_&&u(d=r[a],a,r))===m)if(m=!m)o=a,f.areaStart(),f.lineStart();else{for(f.lineEnd(),f.lineStart(),s=a-1;s>=o;--s)f.point(y[s],g[s]);f.lineEnd(),f.areaEnd()}m&&(y[a]=+t(d,a,r),g[a]=+n(d,a,r),f.point(e?+e(d,a,r):y[a],l?+l(d,a,r):g[a]))}if(p)return f=null,p+""||null}function p(){return(0,o.Z)().defined(u).curve(h).context(c)}return d.x=function(n){return arguments.length?(t="function"==typeof n?n:(0,r.Z)(+n),e=null,d):t},d.x0=function(e){return arguments.length?(t="function"==typeof e?e:(0,r.Z)(+e),d):t},d.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:(0,r.Z)(+t),d):e},d.y=function(t){return arguments.length?(n="function"==typeof t?t:(0,r.Z)(+t),l=null,d):n},d.y0=function(t){return arguments.length?(n="function"==typeof t?t:(0,r.Z)(+t),d):n},d.y1=function(t){return arguments.length?(l=null==t?null:"function"==typeof t?t:(0,r.Z)(+t),d):l},d.lineX0=d.lineY0=function(){return p().x(t).y(n)},d.lineY1=function(){return p().x(t).y(l)},d.lineX1=function(){return p().x(e).y(n)},d.defined=function(t){return arguments.length?(u="function"==typeof t?t:(0,r.Z)(!!t),d):u},d.curve=function(t){return arguments.length?(h=t,null!=c&&(f=h(c)),d):h},d.context=function(t){return arguments.length?(null==t?c=f=null:f=h(c=t),d):c},d}},56297:function(t,e,n){"use strict";function i(t){return function(){return t}}n.d(e,{Z:function(){return i}})},41545:function(t,e,n){"use strict";function i(t){this._context=t}function r(t){return new i(t)}n.d(e,{Z:function(){return r}}),i.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}}},60508:function(t,e,n){"use strict";n.d(e,{Nb:function(){return M},SO:function(){return T.Z},am:function(){return L},$0:function(){return gt},Dt:function(){return vt},WQ:function(){return wt},tF:function(){return kt},YY:function(){return Et},Ov:function(){return St},dC:function(){return Zt},zg:function(){return It},fG:function(){return Dt},$m:function(){return Ct},c_:function(){return Z.Z},fx:function(){return Pt},Fd:function(){return Xt},ak:function(){return Kt},Sx:function(){return $t},eA:function(){return te},js:function(){return ne},iJ:function(){return ee},jv:function(){return E.Z},XB:function(){return D},h5:function(){return V},M4:function(){return K},rR:function(){return X},ve:function(){return N},Hs:function(){return C},N1:function(){return L},aJ:function(){return D},kn:function(){return oe},W$:function(){return le},pB:function(){return se},HL:function(){return ie},Ku:function(){return ue},YG:function(){return ce},mG:function(){return he},$K:function(){return de},IX:function(){return _e},FP:function(){return me},Qx:function(){return re},cY:function(){return ye},NA:function(){return pt},JF:function(){return W},tJ:function(){return J},rZ:function(){return tt},m_:function(){return at},Hm:function(){return rt},P6:function(){return st},n3:function(){return ft},uH:function(){return dt}});var i=n(52508),r=n(56297),a=Math.abs,o=Math.atan2,s=Math.cos,l=Math.max,u=Math.min,c=Math.sin,h=Math.sqrt,f=1e-12,d=Math.PI,p=d/2,_=2*d;function m(t){return t>1?0:t<-1?d:Math.acos(t)}function y(t){return t>=1?p:t<=-1?-p:Math.asin(t)}function g(t){return t.innerRadius}function x(t){return t.outerRadius}function v(t){return t.startAngle}function b(t){return t.endAngle}function w(t){return t&&t.padAngle}function z(t,e,n,i,r,a,o,s){var l=n-t,u=i-e,c=o-r,h=s-a,d=h*l-c*u;if(!(d*d<f))return[t+(d=(c*(e-a)-h*(t-r))/d)*l,e+d*u]}function k(t,e,n,i,r,a,o){var s=t-n,u=e-i,c=(o?a:-a)/h(s*s+u*u),f=c*u,d=-c*s,p=t+f,_=e+d,m=n+f,y=i+d,g=(p+m)/2,x=(_+y)/2,v=m-p,b=y-_,w=v*v+b*b,z=r-a,k=p*y-m*_,M=(b<0?-1:1)*h(l(0,z*z*w-k*k)),T=(k*b-v*M)/w,E=(-k*v-b*M)/w,A=(k*b+v*M)/w,S=(-k*v+b*M)/w,N=T-g,Z=E-x,O=A-g,B=S-x;return N*N+Z*Z>O*O+B*B&&(T=A,E=S),{cx:T,cy:E,x01:-f,y01:-d,x11:T*(r/z-1),y11:E*(r/z-1)}}function M(){var t=g,e=x,n=(0,r.Z)(0),l=null,M=v,T=b,E=w,A=null;function S(){var r,g,x=+t.apply(this,arguments),v=+e.apply(this,arguments),b=M.apply(this,arguments)-p,w=T.apply(this,arguments)-p,S=a(w-b),N=w>b;if(A||(A=r=(0,i.Z)()),v<x&&(g=v,v=x,x=g),v>f)if(S>_-f)A.moveTo(v*s(b),v*c(b)),A.arc(0,0,v,b,w,!N),x>f&&(A.moveTo(x*s(w),x*c(w)),A.arc(0,0,x,w,b,N));else{var Z,O,B=b,I=w,F=b,D=w,L=S,C=S,q=E.apply(this,arguments)/2,P=q>f&&(l?+l.apply(this,arguments):h(x*x+v*v)),U=u(a(v-x)/2,+n.apply(this,arguments)),Y=U,R=U;if(P>f){var j=y(P/x*c(q)),H=y(P/v*c(q));(L-=2*j)>f?(F+=j*=N?1:-1,D-=j):(L=0,F=D=(b+w)/2),(C-=2*H)>f?(B+=H*=N?1:-1,I-=H):(C=0,B=I=(b+w)/2)}var G=v*s(B),V=v*c(B),X=x*s(D),K=x*c(D);if(U>f){var W,J=v*s(I),$=v*c(I),Q=x*s(F),tt=x*c(F);if(S<d&&(W=z(G,V,Q,tt,J,$,X,K))){var et=G-W[0],nt=V-W[1],it=J-W[0],rt=$-W[1],at=1/c(m((et*it+nt*rt)/(h(et*et+nt*nt)*h(it*it+rt*rt)))/2),ot=h(W[0]*W[0]+W[1]*W[1]);Y=u(U,(x-ot)/(at-1)),R=u(U,(v-ot)/(at+1))}}C>f?R>f?(Z=k(Q,tt,G,V,v,R,N),O=k(J,$,X,K,v,R,N),A.moveTo(Z.cx+Z.x01,Z.cy+Z.y01),R<U?A.arc(Z.cx,Z.cy,R,o(Z.y01,Z.x01),o(O.y01,O.x01),!N):(A.arc(Z.cx,Z.cy,R,o(Z.y01,Z.x01),o(Z.y11,Z.x11),!N),A.arc(0,0,v,o(Z.cy+Z.y11,Z.cx+Z.x11),o(O.cy+O.y11,O.cx+O.x11),!N),A.arc(O.cx,O.cy,R,o(O.y11,O.x11),o(O.y01,O.x01),!N))):(A.moveTo(G,V),A.arc(0,0,v,B,I,!N)):A.moveTo(G,V),x>f&&L>f?Y>f?(Z=k(X,K,J,$,x,-Y,N),O=k(G,V,Q,tt,x,-Y,N),A.lineTo(Z.cx+Z.x01,Z.cy+Z.y01),Y<U?A.arc(Z.cx,Z.cy,Y,o(Z.y01,Z.x01),o(O.y01,O.x01),!N):(A.arc(Z.cx,Z.cy,Y,o(Z.y01,Z.x01),o(Z.y11,Z.x11),!N),A.arc(0,0,x,o(Z.cy+Z.y11,Z.cx+Z.x11),o(O.cy+O.y11,O.cx+O.x11),N),A.arc(O.cx,O.cy,Y,o(O.y11,O.x11),o(O.y01,O.x01),!N))):A.arc(0,0,x,D,F,N):A.lineTo(X,K)}else A.moveTo(0,0);if(A.closePath(),r)return A=null,r+""||null}return S.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+M.apply(this,arguments)+ +T.apply(this,arguments))/2-d/2;return[s(i)*n,c(i)*n]},S.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:(0,r.Z)(+e),S):t},S.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.Z)(+t),S):e},S.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:(0,r.Z)(+t),S):n},S.padRadius=function(t){return arguments.length?(l=null==t?null:"function"==typeof t?t:(0,r.Z)(+t),S):l},S.startAngle=function(t){return arguments.length?(M="function"==typeof t?t:(0,r.Z)(+t),S):M},S.endAngle=function(t){return arguments.length?(T="function"==typeof t?t:(0,r.Z)(+t),S):T},S.padAngle=function(t){return arguments.length?(E="function"==typeof t?t:(0,r.Z)(+t),S):E},S.context=function(t){return arguments.length?(A=null==t?null:t,S):A},S}var T=n(45902),E=n(23780);function A(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function S(t){return t}function N(){var t=S,e=A,n=null,i=(0,r.Z)(0),a=(0,r.Z)(_),o=(0,r.Z)(0);function s(r){var s,l,u,c,h,f=r.length,d=0,p=new Array(f),m=new Array(f),y=+i.apply(this,arguments),g=Math.min(_,Math.max(-_,a.apply(this,arguments)-y)),x=Math.min(Math.abs(g)/f,o.apply(this,arguments)),v=x*(g<0?-1:1);for(s=0;s<f;++s)(h=m[p[s]=s]=+t(r[s],s,r))>0&&(d+=h);for(null!=e?p.sort((function(t,n){return e(m[t],m[n])})):null!=n&&p.sort((function(t,e){return n(r[t],r[e])})),s=0,u=d?(g-f*v)/d:0;s<f;++s,y=c)l=p[s],c=y+((h=m[l])>0?h*u:0)+v,m[l]={data:r[l],index:s,value:h,startAngle:y,endAngle:c,padAngle:x};return m}return s.value=function(e){return arguments.length?(t="function"==typeof e?e:(0,r.Z)(+e),s):t},s.sortValues=function(t){return arguments.length?(e=t,n=null,s):e},s.sort=function(t){return arguments.length?(n=t,e=null,s):n},s.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:(0,r.Z)(+t),s):i},s.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:(0,r.Z)(+t),s):a},s.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:(0,r.Z)(+t),s):o},s}var Z=n(41545),O=I(Z.Z);function B(t){this._curve=t}function I(t){function e(e){return new B(t(e))}return e._curve=t,e}function F(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(I(t)):e()._curve},t}function D(){return F((0,E.Z)().curve(O))}function L(){var t=(0,T.Z)().curve(O),e=t.curve,n=t.lineX0,i=t.lineX1,r=t.lineY0,a=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return F(n())},delete t.lineX0,t.lineEndAngle=function(){return F(i())},delete t.lineX1,t.lineInnerRadius=function(){return F(r())},delete t.lineY0,t.lineOuterRadius=function(){return F(a())},delete t.lineY1,t.curve=function(t){return arguments.length?e(I(t)):e()._curve},t}function C(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}B.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var q=Array.prototype.slice,P=n(32337);function U(t){return t.source}function Y(t){return t.target}function R(t){var e=U,n=Y,a=P.x,o=P.y,s=null;function l(){var r,l=q.call(arguments),u=e.apply(this,l),c=n.apply(this,l);if(s||(s=r=(0,i.Z)()),t(s,+a.apply(this,(l[0]=u,l)),+o.apply(this,l),+a.apply(this,(l[0]=c,l)),+o.apply(this,l)),r)return s=null,r+""||null}return l.source=function(t){return arguments.length?(e=t,l):e},l.target=function(t){return arguments.length?(n=t,l):n},l.x=function(t){return arguments.length?(a="function"==typeof t?t:(0,r.Z)(+t),l):a},l.y=function(t){return arguments.length?(o="function"==typeof t?t:(0,r.Z)(+t),l):o},l.context=function(t){return arguments.length?(s=null==t?null:t,l):s},l}function j(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e=(e+i)/2,n,e,r,i,r)}function H(t,e,n,i,r){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+r)/2,i,n,i,r)}function G(t,e,n,i,r){var a=C(e,n),o=C(e,n=(n+r)/2),s=C(i,n),l=C(i,r);t.moveTo(a[0],a[1]),t.bezierCurveTo(o[0],o[1],s[0],s[1],l[0],l[1])}function V(){return R(j)}function X(){return R(H)}function K(){var t=R(G);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}var W={draw:function(t,e){var n=Math.sqrt(e/d);t.moveTo(n,0),t.arc(0,0,n,0,_)}},J={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},$=Math.sqrt(1/3),Q=2*$,tt={draw:function(t,e){var n=Math.sqrt(e/Q),i=n*$;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}},et=Math.sin(d/10)/Math.sin(7*d/10),nt=Math.sin(_/10)*et,it=-Math.cos(_/10)*et,rt={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),i=nt*n,r=it*n;t.moveTo(0,-n),t.lineTo(i,r);for(var a=1;a<5;++a){var o=_*a/5,s=Math.cos(o),l=Math.sin(o);t.lineTo(l*n,-s*n),t.lineTo(s*i-l*r,l*i+s*r)}t.closePath()}},at={draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}},ot=Math.sqrt(3),st={draw:function(t,e){var n=-Math.sqrt(e/(3*ot));t.moveTo(0,2*n),t.lineTo(-ot*n,-n),t.lineTo(ot*n,-n),t.closePath()}},lt=-.5,ut=Math.sqrt(3)/2,ct=1/Math.sqrt(12),ht=3*(ct/2+1),ft={draw:function(t,e){var n=Math.sqrt(e/ht),i=n/2,r=n*ct,a=i,o=n*ct+n,s=-a,l=o;t.moveTo(i,r),t.lineTo(a,o),t.lineTo(s,l),t.lineTo(lt*i-ut*r,ut*i+lt*r),t.lineTo(lt*a-ut*o,ut*a+lt*o),t.lineTo(lt*s-ut*l,ut*s+lt*l),t.lineTo(lt*i+ut*r,lt*r-ut*i),t.lineTo(lt*a+ut*o,lt*o-ut*a),t.lineTo(lt*s+ut*l,lt*l-ut*s),t.closePath()}},dt=[W,J,tt,at,rt,st,ft];function pt(){var t=(0,r.Z)(W),e=(0,r.Z)(64),n=null;function a(){var r;if(n||(n=r=(0,i.Z)()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return a.type=function(e){return arguments.length?(t="function"==typeof e?e:(0,r.Z)(e),a):t},a.size=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.Z)(+t),a):e},a.context=function(t){return arguments.length?(n=null==t?null:t,a):n},a}function _t(){}function mt(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function yt(t){this._context=t}function gt(t){return new yt(t)}function xt(t){this._context=t}function vt(t){return new xt(t)}function bt(t){this._context=t}function wt(t){return new bt(t)}function zt(t,e){this._basis=new yt(t),this._beta=e}yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:mt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:mt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},xt.prototype={areaStart:_t,areaEnd:_t,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:mt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:mt(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},zt.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i,r=t[0],a=e[0],o=t[n]-r,s=e[n]-a,l=-1;++l<=n;)i=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(r+i*o),this._beta*e[l]+(1-this._beta)*(a+i*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var kt=function t(e){function n(t){return 1===e?new yt(t):new zt(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Mt(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Tt(t,e){this._context=t,this._k=(1-e)/6}Tt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Mt(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Mt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Et=function t(e){function n(t){return new Tt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function At(t,e){this._context=t,this._k=(1-e)/6}At.prototype={areaStart:_t,areaEnd:_t,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Mt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var St=function t(e){function n(t){return new At(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Nt(t,e){this._context=t,this._k=(1-e)/6}Nt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Mt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Zt=function t(e){function n(t){return new Nt(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Ot(t,e,n){var i=t._x1,r=t._y1,a=t._x2,o=t._y2;if(t._l01_a>f){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,r=(r*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>f){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*u+t._x1*t._l23_2a-e*t._l12_2a)/c,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(i,r,a,o,t._x2,t._y2)}function Bt(t,e){this._context=t,this._alpha=e}Bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Ot(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var It=function t(e){function n(t){return e?new Bt(t,e):new Tt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Ft(t,e){this._context=t,this._alpha=e}Ft.prototype={areaStart:_t,areaEnd:_t,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Ot(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Dt=function t(e){function n(t){return e?new Ft(t,e):new At(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Lt(t,e){this._context=t,this._alpha=e}Lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ot(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ct=function t(e){function n(t){return e?new Lt(t,e):new Nt(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function qt(t){this._context=t}function Pt(t){return new qt(t)}function Ut(t){return t<0?-1:1}function Yt(t,e,n){var i=t._x1-t._x0,r=e-t._x1,a=(t._y1-t._y0)/(i||r<0&&-0),o=(n-t._y1)/(r||i<0&&-0),s=(a*r+o*i)/(i+r);return(Ut(a)+Ut(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Rt(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function jt(t,e,n){var i=t._x0,r=t._y0,a=t._x1,o=t._y1,s=(a-i)/3;t._context.bezierCurveTo(i+s,r+s*e,a-s,o-s*n,a,o)}function Ht(t){this._context=t}function Gt(t){this._context=new Vt(t)}function Vt(t){this._context=t}function Xt(t){return new Ht(t)}function Kt(t){return new Gt(t)}function Wt(t){this._context=t}function Jt(t){var e,n,i=t.length-1,r=new Array(i),a=new Array(i),o=new Array(i);for(r[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<i-1;++e)r[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(r[i-1]=2,a[i-1]=7,o[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=r[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(r[i-1]=o[i-1]/a[i-1],e=i-2;e>=0;--e)r[e]=(o[e]-r[e+1])/a[e];for(a[i-1]=(t[i]+r[i-1])/2,e=0;e<i-1;++e)a[e]=2*t[e+1]-r[e+1];return[r,a]}function $t(t){return new Wt(t)}function Qt(t,e){this._context=t,this._t=e}function te(t){return new Qt(t,.5)}function ee(t){return new Qt(t,0)}function ne(t){return new Qt(t,1)}function ie(t,e){if((r=t.length)>1)for(var n,i,r,a=1,o=t[e[0]],s=o.length;a<r;++a)for(i=o,o=t[e[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function re(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function ae(t,e){return t[e]}function oe(){var t=(0,r.Z)([]),e=re,n=ie,i=ae;function a(r){var a,o,s=t.apply(this,arguments),l=r.length,u=s.length,c=new Array(u);for(a=0;a<u;++a){for(var h,f=s[a],d=c[a]=new Array(l),p=0;p<l;++p)d[p]=h=[0,+i(r[p],f,p,r)],h.data=r[p];d.key=f}for(a=0,o=e(c);a<u;++a)c[o[a]].index=a;return n(c,o),c}return a.keys=function(e){return arguments.length?(t="function"==typeof e?e:(0,r.Z)(q.call(e)),a):t},a.value=function(t){return arguments.length?(i="function"==typeof t?t:(0,r.Z)(+t),a):i},a.order=function(t){return arguments.length?(e=null==t?re:"function"==typeof t?t:(0,r.Z)(q.call(t)),a):e},a.offset=function(t){return arguments.length?(n=null==t?ie:t,a):n},a}function se(t,e){if((i=t.length)>0){for(var n,i,r,a=0,o=t[0].length;a<o;++a){for(r=n=0;n<i;++n)r+=t[n][a][1]||0;if(r)for(n=0;n<i;++n)t[n][a][1]/=r}ie(t,e)}}function le(t,e){if((s=t.length)>0)for(var n,i,r,a,o,s,l=0,u=t[e[0]].length;l<u;++l)for(a=o=0,n=0;n<s;++n)(r=(i=t[e[n]][l])[1]-i[0])>0?(i[0]=a,i[1]=a+=r):r<0?(i[1]=o,i[0]=o+=r):(i[0]=0,i[1]=r)}function ue(t,e){if((n=t.length)>0){for(var n,i=0,r=t[e[0]],a=r.length;i<a;++i){for(var o=0,s=0;o<n;++o)s+=t[o][i][1]||0;r[i][1]+=r[i][0]=-s/2}ie(t,e)}}function ce(t,e){if((r=t.length)>0&&(i=(n=t[e[0]]).length)>0){for(var n,i,r,a=0,o=1;o<i;++o){for(var s=0,l=0,u=0;s<r;++s){for(var c=t[e[s]],h=c[o][1]||0,f=(h-(c[o-1][1]||0))/2,d=0;d<s;++d){var p=t[e[d]];f+=(p[o][1]||0)-(p[o-1][1]||0)}l+=h,u+=f*h}n[o-1][1]+=n[o-1][0]=a,l&&(a-=u/l)}n[o-1][1]+=n[o-1][0]=a,ie(t,e)}}function he(t){var e=t.map(fe);return re(t).sort((function(t,n){return e[t]-e[n]}))}function fe(t){for(var e,n=-1,i=0,r=t.length,a=-1/0;++n<r;)(e=+t[n][1])>a&&(a=e,i=n);return i}function de(t){var e=t.map(pe);return re(t).sort((function(t,n){return e[t]-e[n]}))}function pe(t){for(var e,n=0,i=-1,r=t.length;++i<r;)(e=+t[i][1])&&(n+=e);return n}function _e(t){return de(t).reverse()}function me(t){var e,n,i=t.length,r=t.map(pe),a=he(t),o=0,s=0,l=[],u=[];for(e=0;e<i;++e)n=a[e],o<s?(o+=r[n],l.push(n)):(s+=r[n],u.push(n));return u.reverse().concat(l)}function ye(t){return re(t).reverse()}qt.prototype={areaStart:_t,areaEnd:_t,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Ht.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:jt(this,this._t0,Rt(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,jt(this,Rt(this,n=Yt(this,t,e)),n);break;default:jt(this,this._t0,n=Yt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Gt.prototype=Object.create(Ht.prototype)).point=function(t,e){Ht.prototype.point.call(this,e,t)},Vt.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,a){this._context.bezierCurveTo(e,t,i,n,a,r)}},Wt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=Jt(t),r=Jt(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(i[0][a],r[0][a],i[1][a],r[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Qt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}}},23780:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var i=n(52508),r=n(56297),a=n(41545),o=n(32337);function s(){var t=o.x,e=o.y,n=(0,r.Z)(!0),s=null,l=a.Z,u=null;function c(r){var a,o,c,h=r.length,f=!1;for(null==s&&(u=l(c=(0,i.Z)())),a=0;a<=h;++a)!(a<h&&n(o=r[a],a,r))===f&&((f=!f)?u.lineStart():u.lineEnd()),f&&u.point(+t(o,a,r),+e(o,a,r));if(c)return u=null,c+""||null}return c.x=function(e){return arguments.length?(t="function"==typeof e?e:(0,r.Z)(+e),c):t},c.y=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.Z)(+t),c):e},c.defined=function(t){return arguments.length?(n="function"==typeof t?t:(0,r.Z)(!!t),c):n},c.curve=function(t){return arguments.length?(l=t,null!=s&&(u=l(s)),c):l},c.context=function(t){return arguments.length?(null==t?s=u=null:u=l(s=t),c):s},c}},32337:function(t,e,n){"use strict";function i(t){return t[0]}function r(t){return t[1]}n.d(e,{x:function(){return i},y:function(){return r}})},66842:function(t,e,n){"use strict";n.d(e,{sP:function(){return T},CR:function(){return m},P2:function(){return y}});var i=n(3839),r=n(14827),a=Math.SQRT2;function o(t){return((t=Math.exp(t))+1/t)/2}function s(t,e){var n,i,r=t[0],s=t[1],l=t[2],u=e[0],c=e[1],h=e[2],f=u-r,d=c-s,p=f*f+d*d;if(p<1e-12)i=Math.log(h/l)/a,n=function(t){return[r+t*f,s+t*d,l*Math.exp(a*t*i)]};else{var _=Math.sqrt(p),m=(h*h-l*l+4*p)/(2*l*2*_),y=(h*h-l*l-4*p)/(2*h*2*_),g=Math.log(Math.sqrt(m*m+1)-m),x=Math.log(Math.sqrt(y*y+1)-y);i=(x-g)/a,n=function(t){var e,n=t*i,u=o(g),c=l/(2*_)*(u*(e=a*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[r+c*f,s+c*d,l*u/o(a*n+g)]}}return n.duration=1e3*i,n}var l=n(42274),u=n(69607),c=n(5130),h=n(92992),f=n(47306);function d(t){return function(){return t}}function p(t,e,n){this.target=t,this.type=e,this.transform=n}function _(t,e,n){this.k=t,this.x=e,this.y=n}_.prototype={constructor:_,scale:function(t){return 1===t?this:new _(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new _(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var m=new _(1,0,0);function y(t){for(;!t.__zoom;)if(!(t=t.parentNode))return m;return t.__zoom}function g(){l.B.stopImmediatePropagation()}function x(){l.B.preventDefault(),l.B.stopImmediatePropagation()}function v(){return!l.B.ctrlKey&&!l.B.button}function b(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function w(){return this.__zoom||m}function z(){return-l.B.deltaY*(1===l.B.deltaMode?.05:l.B.deltaMode?1:.002)}function k(){return navigator.maxTouchPoints||"ontouchstart"in this}function M(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function T(){var t,e,n=v,a=b,o=M,y=z,T=k,E=[0,1/0],A=[[-1/0,-1/0],[1/0,1/0]],S=250,N=s,Z=(0,i.Z)("start","zoom","end"),O=500,B=0;function I(t){t.property("__zoom",w).on("wheel.zoom",U).on("mousedown.zoom",Y).on("dblclick.zoom",R).filter(T).on("touchstart.zoom",j).on("touchmove.zoom",H).on("touchend.zoom touchcancel.zoom",G).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function F(t,e){return(e=Math.max(E[0],Math.min(E[1],e)))===t.k?t:new _(e,t.x,t.y)}function D(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new _(t.k,i,r)}function L(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function C(t,e,n){t.on("start.zoom",(function(){q(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){q(this,arguments).end()})).tween("zoom",(function(){var t=this,i=arguments,r=q(t,i),o=a.apply(t,i),s=null==n?L(o):"function"==typeof n?n.apply(t,i):n,l=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),u=t.__zoom,c="function"==typeof e?e.apply(t,i):e,h=N(u.invert(s).concat(l/u.k),c.invert(s).concat(l/c.k));return function(t){if(1===t)t=c;else{var e=h(t),n=l/e[2];t=new _(n,s[0]-e[0]*n,s[1]-e[1]*n)}r.zoom(null,t)}}))}function q(t,e,n){return!n&&t.__zooming||new P(t,e)}function P(t,e){this.that=t,this.args=e,this.active=0,this.extent=a.apply(t,e),this.taps=0}function U(){if(n.apply(this,arguments)){var t=q(this,arguments),e=this.__zoom,i=Math.max(E[0],Math.min(E[1],e.k*Math.pow(2,y.apply(this,arguments)))),r=(0,u.Z)(this);if(t.wheel)t.mouse[0][0]===r[0]&&t.mouse[0][1]===r[1]||(t.mouse[1]=e.invert(t.mouse[0]=r)),clearTimeout(t.wheel);else{if(e.k===i)return;t.mouse=[r,e.invert(r)],(0,f.e1)(this),t.start()}x(),t.wheel=setTimeout(a,150),t.zoom("mouse",o(D(F(e,i),t.mouse[0],t.mouse[1]),t.extent,A))}function a(){t.wheel=null,t.end()}}function Y(){if(!e&&n.apply(this,arguments)){var t=q(this,arguments,!0),i=(0,c.Z)(l.B.view).on("mousemove.zoom",d,!0).on("mouseup.zoom",p,!0),a=(0,u.Z)(this),s=l.B.clientX,h=l.B.clientY;(0,r.Z)(l.B.view),g(),t.mouse=[a,this.__zoom.invert(a)],(0,f.e1)(this),t.start()}function d(){if(x(),!t.moved){var e=l.B.clientX-s,n=l.B.clientY-h;t.moved=e*e+n*n>B}t.zoom("mouse",o(D(t.that.__zoom,t.mouse[0]=(0,u.Z)(t.that),t.mouse[1]),t.extent,A))}function p(){i.on("mousemove.zoom mouseup.zoom",null),(0,r.D)(l.B.view,t.moved),x(),t.end()}}function R(){if(n.apply(this,arguments)){var t=this.__zoom,e=(0,u.Z)(this),i=t.invert(e),r=t.k*(l.B.shiftKey?.5:2),s=o(D(F(t,r),e,i),a.apply(this,arguments),A);x(),S>0?(0,c.Z)(this).transition().duration(S).call(C,s,e):(0,c.Z)(this).call(I.transform,s)}}function j(){if(n.apply(this,arguments)){var e,i,r,a,o=l.B.touches,s=o.length,u=q(this,arguments,l.B.changedTouches.length===s);for(g(),i=0;i<s;++i)r=o[i],a=[a=(0,h.Z)(this,o,r.identifier),this.__zoom.invert(a),r.identifier],u.touch0?u.touch1||u.touch0[2]===a[2]||(u.touch1=a,u.taps=0):(u.touch0=a,e=!0,u.taps=1+!!t);t&&(t=clearTimeout(t)),e&&(u.taps<2&&(t=setTimeout((function(){t=null}),O)),(0,f.e1)(this),u.start())}}function H(){if(this.__zooming){var e,n,i,r,a=q(this,arguments),s=l.B.changedTouches,u=s.length;for(x(),t&&(t=clearTimeout(t)),a.taps=0,e=0;e<u;++e)n=s[e],i=(0,h.Z)(this,s,n.identifier),a.touch0&&a.touch0[2]===n.identifier?a.touch0[0]=i:a.touch1&&a.touch1[2]===n.identifier&&(a.touch1[0]=i);if(n=a.that.__zoom,a.touch1){var c=a.touch0[0],f=a.touch0[1],d=a.touch1[0],p=a.touch1[1],_=(_=d[0]-c[0])*_+(_=d[1]-c[1])*_,m=(m=p[0]-f[0])*m+(m=p[1]-f[1])*m;n=F(n,Math.sqrt(_/m)),i=[(c[0]+d[0])/2,(c[1]+d[1])/2],r=[(f[0]+p[0])/2,(f[1]+p[1])/2]}else{if(!a.touch0)return;i=a.touch0[0],r=a.touch0[1]}a.zoom("touch",o(D(n,i,r),a.extent,A))}}function G(){if(this.__zooming){var t,n,i=q(this,arguments),r=l.B.changedTouches,a=r.length;for(g(),e&&clearTimeout(e),e=setTimeout((function(){e=null}),O),t=0;t<a;++t)n=r[t],i.touch0&&i.touch0[2]===n.identifier?delete i.touch0:i.touch1&&i.touch1[2]===n.identifier&&delete i.touch1;if(i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0)i.touch0[1]=this.__zoom.invert(i.touch0[0]);else if(i.end(),2===i.taps){var o=(0,c.Z)(this).on("dblclick.zoom");o&&o.apply(this,arguments)}}}return I.transform=function(t,e,n){var i=t.selection?t.selection():t;i.property("__zoom",w),t!==i?C(t,e,n):i.interrupt().each((function(){q(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},I.scaleBy=function(t,e,n){I.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n)},I.scaleTo=function(t,e,n){I.transform(t,(function(){var t=a.apply(this,arguments),i=this.__zoom,r=null==n?L(t):"function"==typeof n?n.apply(this,arguments):n,s=i.invert(r),l="function"==typeof e?e.apply(this,arguments):e;return o(D(F(i,l),r,s),t,A)}),n)},I.translateBy=function(t,e,n){I.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),a.apply(this,arguments),A)}))},I.translateTo=function(t,e,n,i){I.transform(t,(function(){var t=a.apply(this,arguments),r=this.__zoom,s=null==i?L(t):"function"==typeof i?i.apply(this,arguments):i;return o(m.translate(s[0],s[1]).scale(r.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,A)}),i)},P.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){(0,l._H)(new p(I,t,this.that.__zoom),Z.apply,Z,[t,this.that,this.args])}},I.wheelDelta=function(t){return arguments.length?(y="function"==typeof t?t:d(+t),I):y},I.filter=function(t){return arguments.length?(n="function"==typeof t?t:d(!!t),I):n},I.touchable=function(t){return arguments.length?(T="function"==typeof t?t:d(!!t),I):T},I.extent=function(t){return arguments.length?(a="function"==typeof t?t:d([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),I):a},I.scaleExtent=function(t){return arguments.length?(E[0]=+t[0],E[1]=+t[1],I):[E[0],E[1]]},I.translateExtent=function(t){return arguments.length?(A[0][0]=+t[0][0],A[1][0]=+t[1][0],A[0][1]=+t[0][1],A[1][1]=+t[1][1],I):[[A[0][0],A[0][1]],[A[1][0],A[1][1]]]},I.constrain=function(t){return arguments.length?(o=t,I):o},I.duration=function(t){return arguments.length?(S=+t,I):S},I.interpolate=function(t){return arguments.length?(N=t,I):N},I.on=function(){var t=Z.on.apply(Z,arguments);return t===Z?I:t},I.clickDistance=function(t){return arguments.length?(B=(t=+t)*t,I):Math.sqrt(B)},I}y.prototype=_.prototype},10527:function(t,e,n){"use strict";n.d(e,{IH:function(){return f},PI:function(){return p}});var i=n(91843),r=n(56327),a=n(85516),o=n(6939);let s={breast_cancer:"breast_cancer_diagnosis_age",breast_cancer2:"breast_cancer2_diagnosis_age",ovarian_cancer:"ovarian_cancer_diagnosis_age",prostate_cancer:"prostate_cancer_diagnosis_age",pancreatic_cancer:"pancreatic_cancer_diagnosis_age"},l=["brca1","brca2","palb2","atm","chek2","rad51d","rad51c","brip1"],u=["er","pr","her2","ck14","ck56"];new Object;var c=n(6939),h=n(44449);function f(t){c("#load").change((function(e){!function(t,e){let n=t.target.files[0];if(n){let t,h=new FileReader;h.onload=function(n){e.DEBUG&&console.log(n.target.result);try{if(0===n.target.result.indexOf("BOADICEA import pedigree file format 4.0"))e.dataset=y(n.target.result,4),m(e);else if(0===n.target.result.indexOf("BOADICEA import pedigree file format 2.0"))e.dataset=y(n.target.result,2),m(e);else if(0===n.target.result.indexOf("##")&&-1!==n.target.result.indexOf("CanRisk")){let i=function(t){let[e,n]=function(t){let e=t.trim().split("\n"),n=[],i=[];for(let t=0;t<e.length;t++){let r=e[t].trim();if(0===r.indexOf("##")){if(0===r.indexOf("##CanRisk")&&r.indexOf(";")>-1){let t=r.split(";");for(let e=1;e<t.length;e++)2===t[e].split("=").length&&i.push(t[e])}-1===r.indexOf("CanRisk")&&0!==r.indexOf("##FamID")&&i.push(r.replace("##",""));continue}let a=/\t/;r.indexOf("\t")<0&&(a=/\s+/,console.log("NOT TAB DELIM"));let c=o.map(r.split(a),(function(t,e){return t.trim()}));if(c.length>1){let e={famid:c[0],display_name:c[1],name:c[3],sex:c[6],status:c[8]};1==c[2]&&(e.proband=!0),"0"!==c[4]&&(e.father=c[4]),"0"!==c[5]&&(e.mother=c[5]),"0"!==c[7]&&(e.mztwin=c[7]),"0"!==c[9]&&(e.age=c[9]),"0"!==c[10]&&(e.yob=c[10]);let i=11;o.each(s,(function(t,n){"0"!==c[i]&&(e[n]=c[i]),i++})),"0"!==c[i++]&&(e.ashkenazi=1);for(let n=0;n<l.length;n++){let r=c[i].split(":");"0"!==r[0]&&("S"!==r[0]&&"T"!==r[0]||"P"!==r[1]&&"N"!==r[1]?console.warn("UNRECOGNISED GENE TEST ON LINE "+(t+1)+": "+r[0]+" "+r[1]):e[l[n]+"_gene_test"]={type:r[0],result:r[1]}),i++}let r=c[i].split(":");for(let n=0;n<r.length;n++)"0"!==r[n]&&("N"===r[n]||"P"===r[n]?e[u[n]+"_bc_pathology"]=r[n]:console.warn("UNRECOGNISED PATHOLOGY ON LINE "+(t+1)+": "+u[n]+" "+r[n]));n.unshift(e)}}return[i,n]}(t);try{return[e,g(n)]}catch(t){return console.error(t),[e,n]}}(n.target.result);t=i[0],e.dataset=i[1],m(e)}else try{e.dataset=JSON.parse(n.target.result)}catch(t){e.dataset=function(t){let e,n=t.trim().split("\n"),i=[];for(let t=0;t<n.length;t++){let r=c.map(n[t].trim().split(/\s+/),(function(t,e){return t.trim()}));if(r.length<5)throw"unknown format";let a="1"==r[4]?"M":"2"==r[4]?"F":"U",o={famid:r[0],display_name:r[1],name:r[1],sex:a};if("0"!==r[2]&&(o.father=r[2]),"0"!==r[3]&&(o.mother=r[3]),void 0!==e&&e!==o.famid){console.error("multiple family IDs found only using famid = "+e);break}if("2"==r[5]&&(o.affected=2),r.length>6){o.alleles="";for(let t=6;t<r.length;t+=2)o.alleles+=r[t]+"/"+r[t+1]+";"}i.unshift(o),e=r[0]}return g(i)}(n.target.result)}(0,a.ZR)(e)}catch(t){return console.error(t,n.target.result),void i.sY("File Error",t.message?t.message:t)}console.log(e.dataset);try{r.N0(e),(0,a.VU)(e),console.log(t),c(document).trigger("riskfactorChange",[e,t]),c(document).trigger("fhChange",[e]);try{acc_FamHist_ticked(),acc_FamHist_Leave(),RESULT.FLAG_FAMILY_MODAL=!0}catch(t){}}catch(t){i.sY("File Error",t.message?t.message:t)}},h.onerror=function(t){i.sY("File Error","File could not be read! Code "+t.target.error.code)},h.readAsText(n)}else console.error("File could not be read!");c("#load")[0].value=""}(e,t)})),c("#save").click((function(e){!function(t){let e=JSON.stringify(r.Vk(t));!function(t,e,n,i){t.DEBUG&&console.log(e);n||(n="ped.txt");i||(i="text/plain");let r=new Blob([e],{type:i});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r,n);else{let t=document.createElement("a"),e=URL.createObjectURL(r);t.href=e,t.download=n,document.body.appendChild(t),t.click(),setTimeout((function(){document.body.removeChild(t),window.URL.revokeObjectURL(e)}),0)}}(t,e)}(t)})),c("#print").click((function(e){!function(t,e){t.constructor!==Array&&(t=[t]);let n=.9*c(window).width(),i=c(window).height()-10,r=["/static/css/canrisk.css","https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"],a=window.open("","PrintMap","width="+n+",height="+i),o="";for(let t=0;t<r.length;t++)o+='<link href="'+r[t]+'" rel="stylesheet" type="text/css" media="all">';o+="<style>body {font-size: "+c("body").css("font-size")+";}</style>";let s="";for(let n=0;n<t.length;n++)0===n&&e&&(s+=e),s+=c(t[n]).html(),n<t.length-1&&(s+='<div class="page-break"> </div>');a.document.write(o),a.document.write(s),a.document.close(),a.focus(),setTimeout((function(){a.print(),a.close()}),300)}(_(t))})),c("#svg_download").click((function(e){!function(t){let e=document.createElement("a");e.href="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.html()))),e.download="plot.svg",e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)}(_(t))})),c("#png_download").click((function(t){let e=p(c("svg"),"pedigree");c.when.apply(c,[e]).done((function(){let t=d(arguments,"pedigree");if(i.un()||i.w1()){let e="<img src='"+t.img+"' alt='canvas image'/>";window.open().document.write(e)}else{let e=document.createElement("a");e.href=t.img,e.download="plot.png",e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)}}))}))}function d(t,e){return c.grep(t,(function(t){return t&&t.name==e}))[0]}function p(t,e,n){let r={iscanvg:!1,resolution:1,img_type:"image/png"};if(n||(n=r),c.each(r,(function(t,e){t in n||(n[t]=e)})),0===t.find(".pdf-white-bg").length){let e=h.select(t.get(0));e.append("rect").attr("width","100%").attr("height","100%").attr("class","pdf-white-bg").attr("fill","white"),e.select(".pdf-white-bg").lower()}let a,o=c.Deferred();void 0!==window.XMLSerializer?a=(new XMLSerializer).serializeToString(t.get(0)):void 0!==t.xml&&(a=t.get(0).xml);let s="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(a))),l=document.createElement("canvas");l.width=t.width()*n.resolution,l.height=t.height()*n.resolution;let u=l.getContext("2d"),f=document.createElement("img");return f.onload=function(){if(i.w1()){a=a.replace(/ font-size="\d?.\d*em"/g,""),a=a.replace(/<text /g,'<text font-size="12px" '),canvg.Canvg.fromString(u,a,{scaleWidth:l.width,scaleHeight:l.height,ignoreDimensions:!0}).start(),console.log(e,n.img_type,"use canvg to create image")}else u.drawImage(f,0,0,l.width,l.height),console.log(e,n.img_type);o.resolve({name:e,resolution:n.resolution,img:l.toDataURL(n.img_type,1),w:l.width,h:l.height})},f.src=s,o.promise()}function _(t){let e=r.Vk(t);null!=e&&(t.dataset=e);let n=(0,a.t_)(t),i=c("<div></div>"),o=c("#"+t.targetDiv).find("svg").clone().appendTo(i),s=515,l=757;if(t.width<n.width||t.height<n.height||n.width>s||n.height>l){let e=n.width,i=n.height+100,r=1;if(n.width>s||n.height>l){n.width>s&&(e=s),n.height>l&&(i=l);let t=e/n.width,a=i/n.height;r=t<a?t:a}o.attr("width",e),o.attr("height",i);let a=1.5*-t.symbol_size*r;o.find(".diagram").attr("transform","translate(0, "+a+") scale("+r+")")}return i}function m(t){c.each(t.dataset,(function(t,e){if(!e.hidden&&"M"===e.sex&&!i.IL(e)&&e[s.breast_cancer2]){let t="Male family member ("+e.display_name+") with contralateral breast cancer found. Please note that as the risk models do not take this into account the second breast cancer is ignored.";console.error(t),delete e[s.breast_cancer2],i.sY("Warning",t)}}))}function y(t,e){let n=t.trim().split("\n"),i=[];for(let t=2;t<n.length;t++){let r=c.map(n[t].trim().split(/\s+/),(function(t,e){return t.trim()}));if(r.length>1){let n={famid:r[0],display_name:r[1],name:r[3],sex:r[6],status:r[8]};1==r[2]&&(n.proband=!0),"0"!==r[4]&&(n.father=r[4]),"0"!==r[5]&&(n.mother=r[5]),"0"!==r[7]&&(n.mztwin=r[7]),"0"!==r[9]&&(n.age=r[9]),"0"!==r[10]&&(n.yob=r[10]);let a=11;if(c.each(s,(function(t,e){"0"!==r[a]&&(n[e]=r[a]),a++})),4===e){"0"!==r[a++]&&(n.ashkenazi=1);for(let e=0;e<5;e++)a+=2,"0"!==r[a-2]&&("S"!==r[a-2]&&"T"!==r[a-2]||"P"!==r[a-1]&&"N"!==r[a-1]?console.warn("UNRECOGNISED GENE TEST ON LINE "+(t+1)+": "+r[a-2]+" "+r[a-1]):n[l[e]+"_gene_test"]={type:r[a-2],result:r[a-1]})}else 2===e&&(a+=2,"0"!==r[a-2]&&("S"===r[a-2]||"T"===r[a-2]?"N"===r[a-1]?(n.brca1_gene_test={type:r[a-2],result:"N"},n.brca2_gene_test={type:r[a-2],result:"N"}):"1"===r[a-1]?(n.brca1_gene_test={type:r[a-2],result:"P"},n.brca2_gene_test={type:r[a-2],result:"N"}):"2"===r[a-1]?(n.brca1_gene_test={type:r[a-2],result:"N"},n.brca2_gene_test={type:r[a-2],result:"P"}):"3"===r[a-1]&&(n.brca1_gene_test={type:r[a-2],result:"P"},n.brca2_gene_test={type:r[a-2],result:"P"}):console.warn("UNRECOGNISED GENE TEST ON LINE "+(t+1)+": "+r[a-2]+" "+r[a-1])),"0"!==r[a++]&&(n.ashkenazi=1));for(let e=0;e<u.length;e++)"0"!==r[a]&&("N"===r[a]||"P"===r[a]?n[u[e]+"_bc_pathology"]=r[a]:console.warn("UNRECOGNISED PATHOLOGY ON LINE "+(t+1)+": "+u[e]+" "+r[a])),a++;i.unshift(n)}}try{return g(i)}catch(t){return console.error(t),i}}function g(t){for(let e=0;e<2;e++)for(let e=0;e<t.length;e++)v(t,t[e].name);let e=0;for(let n=0;n<t.length;n++)t[n].level&&t[n].level>e&&(e=t[n].level);for(let n=0;n<t.length;n++)if(1==i.hh(t,t[n].name))if(t[n].level&&t[n].level==e)t[n].top_level=!0;else{t[n].noparents=!0;let e=x(t,t[n]);if(e>-1&&t[e].mother&&(t[n].mother=t[e].mother,t[n].father=t[e].father),!t[n].mother)for(let i=0;i<t.length;i++)t[n].level==t[i].level-1&&(e=x(t,t[i]),e>-1&&(t[n].mother="F"===t[i].sex?t[i].name:t[e].name,t[n].father="M"===t[i].sex?t[i].name:t[e].name))}else delete t[n].top_level;return t}function x(t,e){for(let n=0;n<t.length;n++){let r=t[n];if(e.name===r.mother)return i.qj(t,r.father);if(e.name===r.father)return i.qj(t,r.mother)}return-1}function v(t,e){let n=i.qj(t,e);b(n,t[n].level?t[n].level:0,t)}function b(t,e,n){let r=["mother","father"];e++;for(let a=0;a<r.length;a++){let o=i.qj(n,n[t][r[a]]);if(o>=0){let r=n[i.qj(n,n[t].mother)],a=n[i.qj(n,n[t].father)];(!n[o].level||n[o].level<e)&&(r.level=e,a.level=e),r.level<a.level?r.level=a.level:a.level<r.level&&(a.level=r.level),b(o,e,n)}}}},56327:function(t,e,n){"use strict";n.d(e,{Fx:function(){return c},bn:function(){return h},k8:function(){return d},m6:function(){return p},Vk:function(){return _},Xp:function(){return m},lp:function(){return y},ZH:function(){return g},N0:function(){return x},cF:function(){return v}});let i=25,r={};function a(t){try{if("array"===t.store_type)return!1;if("local"!==t.store_type&&"session"!==t.store_type&&void 0!==t.store_type)return!1;let e="test";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}function o(t){return"PEDIGREE_"+t.btn_target+"_"}function s(t){return r[o(t)]}function l(t,e){return"local"===t.store_type?localStorage.getItem(e):sessionStorage.getItem(e)}function u(t,e,n){return"local"===t.store_type?localStorage.setItem(e,n):sessionStorage.setItem(e,n)}function c(t){let e=o(t),n="local"===t.store_type?localStorage:sessionStorage,i=[];for(let t=0;t<n.length;t++)0==n.key(t).indexOf(e)&&i.push(n.key(t));for(let t=0;t<i.length;t++)n.removeItem(i[t])}function h(t){let e;return e=a(t)?l(t,o(t)+"COUNT"):r[o(t)+"COUNT"],null!=e?e:0}function f(t,e){a(t)?u(t,o(t)+"COUNT",e):r[o(t)+"COUNT"]=e}function d(t){if(!t.dataset)return;let e=h(t);a(t)?u(t,o(t)+e,JSON.stringify(t.dataset)):(console.warn("Local storage not found/supported for this browser!",t.store_type),i=500,void 0===s(t)&&(r[o(t)]=[]),s(t).push(JSON.stringify(t.dataset))),e<i?e++:e=0,f(t,e)}function p(t){if(!a(t))return s(t)&&s(t).length>0?s(t).length:-1;for(let e=i;e>0;e--)if(null!==l(t,o(t)+(e-1)))return e;return-1}function _(t){let e=h(t)-1;return-1==e&&(e=i),a(t)?JSON.parse(l(t,o(t)+e)):s(t)?JSON.parse(s(t)[e]):void 0}function m(t,e){if(void 0===e&&(e=h(t)-2),e<0){let n=n(t);e=n<i?n-1:i-1}return f(t,e+1),a(t)?JSON.parse(l(t,o(t)+e)):JSON.parse(s(t)[e])}function y(t,e){return void 0===e&&(e=h(t)),e>=i&&(e=0),f(t,parseInt(e)+1),a(t)?JSON.parse(l(t,o(t)+e)):JSON.parse(s(t)[e])}function g(t){a(t)&&function(t){"local"===t.store_type?localStorage.clear():sessionStorage.clear()}(t),r={}}function x(t,e,n,i){if(a(t)){let r="local"===t.store_type?localStorage:sessionStorage;e?(u(t,o(t)+"_X",e),u(t,o(t)+"_Y",n)):(r.removeItem(o(t)+"_X"),r.removeItem(o(t)+"_Y"));let a=o(t)+"_ZOOM";i?u(t,a,i):r.removeItem(a)}}function v(t){if(!a(t)||null===localStorage.getItem(o(t)+"_X")&&null===sessionStorage.getItem(o(t)+"_X"))return[null,null];let e=[parseInt(l(t,o(t)+"_X")),parseInt(l(t,o(t)+"_Y"))];return null!==l(t,o(t)+"_ZOOM")&&e.push(parseFloat(l(t,o(t)+"_ZOOM"))),e}},85516:function(t,e,n){"use strict";n.d(e,{Bm:function(){return j},c:function(){return X},nZ:function(){return K},cd:function(){return H},J_:function(){return D},j:function(){return J},t_:function(){return Y},VU:function(){return R},hN:function(){return V},ZR:function(){return C}});var i=n(91843),r=n(56327),a=n(44449);let o;function s(t,e){let n=t.symbol_size/2,i=2.5*-t.symbol_size;o=a.zoom().scaleExtent([t.zoomIn,t.zoomOut]).filter((function(){return!((!t.zoomSrc||-1===t.zoomSrc.indexOf("wheel"))&&a.event.type&&"wheel"===a.event.type)&&("dblclick"!==a.event.type&&!a.event.button)})).on("zoom",(function(){!function(t){t.DEBUG&&console.log("zoom",a.event,a.event.transform);let e=a.event.transform,n=e.k&&1!==e.k?e.k:void 0;(0,r.N0)(t,e.x,e.y,n),a.select("#"+t.targetDiv).select(".diagram").attr("transform","translate("+e.x+","+e.y+")"+(n?" scale("+n+")":""))}(t)})),e.call(o);let s=(0,r.cF)(t),l=3==s.length?s[2]:1,u=null!==s[0]?s[0]/l:n*l,c=null!==s[1]?s[1]/l:i*l;var h=a.zoomIdentity.scale(l).translate(u,c);e.call(o.transform,h)}function l(t,e){a.select("#"+t.targetDiv).select("svg").transition().duration(50).call(o.scaleBy,e)}function u(t){let e=function(t){let e=c(t);return{wid:Math.abs(e.xmax-e.xmin),hgt:Math.abs(e.ymax-e.ymin)}}(t),n=a.select("#"+t.targetDiv).select("svg"),i=function(t){return{w:t.node().clientWidth,h:t.node().clientHeight}}(n),r=(i.w-2*t.symbol_size)/i.w/Math.max(e.wid/i.w,e.hgt/i.h);r<t.zoomIn&&o.scaleExtent([r,t.zoomOut]);let s=function(t){let e=c(t);return{x:e.xmin+(e.xmax-e.xmin)/2,y:e.ymin+(e.ymax-e.ymin)/2}}(t);n.call(o.translateTo,s.x,s.y),setTimeout((function(){n.transition().duration(700).call(o.scaleTo,r)}),400)}function c(t){let e=a.select("#"+t.targetDiv).select(".diagram"),n=Number.MAX_VALUE,i=-1e6,r=Number.MAX_VALUE,o=-1e6,s=t.symbol_size/2;return e.selectAll("g").each((function(t,e){t.x&&"hidden_root"!==t.data.name&&(t.x-s<n&&(n=t.x-s),t.x+s>i&&(i=t.x+s),t.y-s<r&&(r=t.y-s),t.y+s>o&&(o=t.y+s))})),{xmin:n,xmax:i,ymin:r,ymax:o}}var h=n(6939);function f(t){let e=h.extend({btn_target:"pedigree_history"},t),n=[{fa:"fa-undo pull-left",title:"undo"},{fa:"fa-repeat pull-left",title:"redo"},{fa:"fa-refresh pull-left",title:"reset"}];n.push({fa:"fa-crosshairs pull-right",title:"scale-to-fit"}),e.zoomSrc&&e.zoomSrc.indexOf("button")>-1&&(1!=e.zoomOut&&n.push({fa:"fa-minus-circle pull-right",title:"zoom-out"}),1!=e.zoomIn&&n.push({fa:"fa-plus-circle pull-right",title:"zoom-in"})),n.push({fa:"fa-arrows-alt pull-right",title:"fullscreen"});let a="";for(let t=0;t<n.length;t++)a+="<span>",a+='&nbsp;<i class="fa fa-lg '+n[t].fa+'" '+("fa-arrows-alt pull-right"==n[t].fa?'id="fullscreen" ':"")+' aria-hidden="true" title="'+n[t].title+'"></i>',a+="</span>";h("#"+e.btn_target).append(a),function(t){h(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",(function(e){let n=r.Vk(t);null!=n&&(t.dataset=n),R(t),setTimeout((function(){u(t)}),500)})),h("#fullscreen").on("click",(function(e){if(d())document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{let e=h("#"+t.targetDiv)[0];e.requestFullscreen?e.requestFullscreen():document.documentElement.mozRequestFullScreen?e.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):document.documentElement.msRequestFullscreen&&e.msRequestFullscreen()}}));let e=0;function n(){l(t,1.05)}function a(){l(t,.95)}h(".fa-plus-circle, .fa-minus-circle").on("mousedown",(function(){e=setInterval(h(this).hasClass("fa-plus-circle")?n:a,50)})).on("mouseup mouseleave",(function(){clearInterval(e)})),h("#"+t.btn_target).on("click",(function(e){if(e.stopPropagation(),h(e.target).hasClass("disabled"))return!1;h(e.target).hasClass("fa-undo")?(t.dataset=r.Xp(t),h("#"+t.targetDiv).empty(),D(t)):h(e.target).hasClass("fa-repeat")?(t.dataset=r.lp(t),h("#"+t.targetDiv).empty(),D(t)):h(e.target).hasClass("fa-refresh")?h('<div id="msgDialog">Resetting the pedigree may result in loss of some data.</div>').dialog({title:"Confirm Reset",resizable:!1,height:"auto",width:400,modal:!0,buttons:{Continue:function(){!function(t,e){let n;if(e){let e=r.Vk(t),a=(0,i.KY)(e);n=a[(0,i.Kz)(a)],n.name="ch1",n.mother="f21",n.father="m21",r.Fx(t)}else n={name:"ch1",sex:"F",mother:"f21",father:"m21",proband:!0,status:"0",display_name:"me"},r.ZH(t);delete t.dataset;let a=h("input[name='default_fam']:checked");a.length>0&&"extended2"==a.val()?t.dataset=[{name:"wZA",sex:"M",top_level:!0,status:"0",display_name:"paternal grandfather"},{name:"MAk",sex:"F",top_level:!0,status:"0",display_name:"paternal grandmother"},{name:"zwB",sex:"M",top_level:!0,status:"0",display_name:"maternal grandfather"},{name:"dOH",sex:"F",top_level:!0,status:"0",display_name:"maternal grandmother"},{name:"MKg",sex:"F",mother:"MAk",father:"wZA",status:"0",display_name:"paternal aunt"},{name:"xsm",sex:"M",mother:"MAk",father:"wZA",status:"0",display_name:"paternal uncle"},{name:"m21",sex:"M",mother:"MAk",father:"wZA",status:"0",display_name:"father"},{name:"f21",sex:"F",mother:"dOH",father:"zwB",status:"0",display_name:"mother"},{name:"aOH",sex:"F",mother:"f21",father:"m21",status:"0",display_name:"sister"},{name:"Vha",sex:"M",mother:"f21",father:"m21",status:"0",display_name:"brother"},{name:"Spj",sex:"M",mother:"f21",father:"m21",noparents:!0,status:"0",display_name:"partner"},n,{name:"zhk",sex:"F",mother:"ch1",father:"Spj",status:"0",display_name:"daughter"},{name:"Knx",display_name:"son",sex:"M",mother:"ch1",father:"Spj",status:"0"},{name:"uuc",display_name:"maternal aunt",sex:"F",mother:"dOH",father:"zwB",status:"0"},{name:"xIw",display_name:"maternal uncle",sex:"M",mother:"dOH",father:"zwB",status:"0"}]:a.length>0&&"extended1"==a.val()?t.dataset=[{name:"m21",sex:"M",mother:null,father:null,status:"0",display_name:"father",noparents:!0},{name:"f21",sex:"F",mother:null,father:null,status:"0",display_name:"mother",noparents:!0},{name:"aOH",sex:"F",mother:"f21",father:"m21",status:"0",display_name:"sister"},{name:"Vha",sex:"M",mother:"f21",father:"m21",status:"0",display_name:"brother"},{name:"Spj",sex:"M",mother:"f21",father:"m21",noparents:!0,status:"0",display_name:"partner"},n,{name:"zhk",sex:"F",mother:"ch1",father:"Spj",status:"0",display_name:"daughter"},{name:"Knx",display_name:"son",sex:"M",mother:"ch1",father:"Spj",status:"0"}]:t.dataset=[{name:"m21",display_name:"father",sex:"M",top_level:!0},{name:"f21",display_name:"mother",sex:"F",top_level:!0},n];R(t)}(t,t.keep_proband_on_reset),h(this).dialog("close")},Cancel:function(){h(this).dialog("close")}}}):h(e.target).hasClass("fa-crosshairs")&&u(t),h(document).trigger("fhChange",[t])}))}(e)}function d(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}var p=n(10527),_=n(6939);function m(t){_("#orig_ashk").is(":checked")?_.each(t,(function(t,e){e.proband&&(e.ashkenazi=1)})):_.each(t,(function(t,e){delete e.ashkenazi}))}function y(t){_("#cancer .row").show(),"M"===t.sex?(delete t.ovarian_cancer_diagnosis_age,_("[id^='id_ovarian_cancer_diagnosis_age']").closest(".row").hide(),_("[id^='id_breast_cancer2_diagnosis_age']").prop("disabled",!0)):"F"===t.sex&&(delete t.prostate_cancer_diagnosis_age,_("[id^='id_prostate_cancer_diagnosis_age']").closest(".row").hide(),_("[id^='id_breast_cancer2_diagnosis_age']").prop("disabled",!1))}function g(t){let e=10*Math.round((t-1)/10);return t<e?e-5:e+5}_(document).on("fhChange",(function(t,e){try{let t=_("#id_name").val();void 0===(0,i.Lw)((0,r.Vk)(e),t)?_("form > fieldset").prop("disabled",!0):_("form > fieldset").prop("disabled",!1)}catch(t){console.warn(t)}}));var x=n(6939),v=n(44449);let b,w;function z(t,e){let n=parseInt(x("body").css("font-size")),a=v.select(".diagram");a.append("rect").attr("class","popup_selection").attr("rx",6).attr("ry",6).attr("transform","translate(-1000,-100)").style("opacity",0).attr("width",7.9*n).attr("height",2*n).style("stroke","darkgrey").attr("fill","white");let o=a.append("text").attr("font-family","FontAwesome").style("opacity",0).attr("font-size","1.em").attr("class","popup_selection fa-lg fa-square persontype").attr("transform","translate(-1000,-100)").attr("x",n/3).attr("y",1.5*n).text(" ").append("svg:title").text("add male"),s=a.append("text").attr("font-family","FontAwesome").style("opacity",0).attr("font-size","1.em").attr("class","popup_selection fa-lg fa-circle persontype").attr("transform","translate(-1000,-100)").attr("x",1.7*n).attr("y",1.5*n).text(" ").append("svg:title").text("add female");a.append("text").attr("font-family","FontAwesome").style("opacity",0).attr("font-size","1.em").attr("transform","translate(-1000,-100)").attr("class","popup_selection fa-lg fa-unspecified popup_selection_rotate45 persontype").text(" ").append("svg:title").text("add unspecified"),a.append("text").attr("font-family","FontAwesome").style("opacity",0).attr("transform","translate(-1000,-100)").attr("class","popup_selection fa-2x fa-angle-up persontype dztwin").attr("x",4.6*n).attr("y",1.5*n).text(" ").append("svg:title").text("add dizygotic/fraternal twins"),a.append("text").attr("font-family","FontAwesome").style("opacity",0).attr("transform","translate(-1000,-100)").attr("class","popup_selection fa-2x fa-caret-up persontype mztwin").attr("x",6.2*n).attr("y",1.5*n).text("").append("svg:title").text("add monozygotic/identical twins");let l={};v.selectAll(".persontype").on("click",(function(){let e,n,a=(0,i.KY)((0,r.Vk)(t)),o=v.select(this).classed("mztwin"),s=v.select(this).classed("dztwin");if(o||s?(n=l.node.datum().data.sex,e=o?"mztwin":"dztwin"):n=v.select(this).classed("fa-square")?"M":v.select(this).classed("fa-circle")?"F":"U","addsibling"===l.type)H(a,l.node.datum().data,n,!1,e);else{if("addchild"!==l.type)return;j(a,l.node.datum().data,e?"U":n,e?2:1,e)}t.dataset=a,R(t),v.selectAll(".popup_selection").style("opacity",0),l={}})).on("mouseover",(function(){l.node&&l.node.select("rect").style("opacity",.2),v.selectAll(".popup_selection").style("opacity",1),"addsibling"===l.type?v.select(this).classed("fa-square")?o.text("add brother"):s.text("add sister"):"addchild"===l.type&&(v.select(this).classed("fa-square")?o.text("add son"):s.text("add daughter"))})),v.selectAll(".popup_selection").on("mouseout",(function(){void 0!==l.node&&-1==d.indexOf(l.node.datum())&&l.node.select("rect").style("opacity",0),v.selectAll(".popup_selection").style("opacity",0)})),function(t){function e(){b=w,v.selectAll(".line_drag_selection").attr("stroke","darkred")}function n(e){if(w&&b.data.name!==w.data.name&&b.data.sex!==w.data.sex){let e={name:(0,i.YO)(4),sex:"U",mother:"F"===b.data.sex?b.data.name:w.data.name,father:"F"===b.data.sex?w.data.name:b.data.name},n=(0,i.KY)(t.dataset);t.dataset=n;let r=(0,i.qj)(t.dataset,b.data.name)+1;t.dataset.splice(r,0,e),R(t)}M(0,0,0,0),v.selectAll(".line_drag_selection").attr("stroke","black"),b=void 0}function r(e){v.event.sourceEvent.stopPropagation();let n=v.event.dx,i=v.event.dy,r=parseFloat(v.select(this).attr("x2"))+n,a=parseFloat(v.select(this).attr("y2"))+i;M(t.symbol_size-10,0,r,a)}v.select(".diagram").append("line").attr("class","line_drag_selection").attr("stroke-width",6).style("stroke-dasharray","2, 1").attr("stroke","black").call(v.drag().on("start",e).on("drag",r).on("end",n)).append("svg:title").text("drag to create consanguineous partners"),M(0,0,0,0)}(t),e.filter((function(e){return!(e.data.hidden&&!t.DEBUG)})).append("rect").attr("class","indi_rect").attr("rx",6).attr("ry",6).attr("x",(function(e){return-.75*t.symbol_size})).attr("y",(function(e){return-t.symbol_size})).attr("width",1.5*t.symbol_size+"px").attr("height",2*t.symbol_size+"px").style("stroke","black").style("stroke-width",.7).style("opacity",0).attr("fill","lightgrey");let u=function(e){return h-.75*t.symbol_size},c=t.symbol_size-2,h=0,f={addchild:{text:"",title:"add child",fx:u,fy:c},addsibling:{text:"",title:"add sibling",fx:u,fy:c},addpartner:{text:"",title:"add partner",fx:u,fy:c},addparents:{text:"",title:"add parents",fx:-.75*t.symbol_size,fy:11-t.symbol_size},delete:{text:"X",title:"delete",fx:t.symbol_size/2-1,fy:12-t.symbol_size,styles:{"font-weight":"bold",fill:"darkred","font-family":"monospace"}}};t.edit&&(f.settings={text:"",title:"settings",fx:-n/2+2,fy:11-t.symbol_size});for(let n in f){let i=e.filter((function(e){return!(e.data.hidden&&!t.DEBUG||(void 0===e.data.mother||e.data.noparents)&&"addsibling"===n||void 0!==e.data.parent_node&&e.data.parent_node.length>1&&"addpartner"===n||void 0===e.data.parent_node&&"addchild"===n||void 0===e.data.noparents&&void 0===e.data.top_level&&"addparents"===n)})).append("text").attr("class",n).style("opacity",0).attr("font-family","FontAwesome").attr("xx",(function(t){return t.x})).attr("yy",(function(t){return t.y})).attr("x",f[n].fx).attr("y",f[n].fy).attr("font-size","0.9em").text(f[n].text);if("styles"in f[n])for(let t in f[n].styles)i.attr(t,f[n].styles[t]);i.append("svg:title").text(f[n].title),h+=17}v.selectAll(".addsibling, .addchild").on("mouseover",(function(){let t=v.select(this).attr("class");v.selectAll(".popup_selection").style("opacity",1),l={node:v.select(this.parentNode),type:t};let e=parseInt(v.select(this).attr("xx"))+parseInt(v.select(this).attr("x")),i=parseInt(v.select(this).attr("yy"))+parseInt(v.select(this).attr("y"));v.selectAll(".popup_selection").attr("transform","translate("+e+","+(i+2)+")"),v.selectAll(".popup_selection_rotate45").attr("transform","translate("+(e+3*n)+","+(i+1.2*n)+") rotate(45)")})),v.selectAll(".addchild, .addpartner, .addparents, .delete, .settings").on("click",(function(){v.event.stopPropagation();let e,n=v.select(this).attr("class"),a=v.select(this.parentNode).datum();t.DEBUG&&console.log(n),"settings"===n?"function"==typeof t.edit?t.edit(t,a):function(t,e){x("#node_properties").dialog({autoOpen:!1,title:e.data.display_name,width:x(window).width()>400?450:x(window).width()-30});let n="<table id='person_details' class='table'>";n+="<tr><td style='text-align:right'>Unique ID</td><td><input class='form-control' type='text' id='id_name' name='name' value="+(e.data.name?e.data.name:"")+"></td></tr>",n+="<tr><td style='text-align:right'>Name</td><td><input class='form-control' type='text' id='id_display_name' name='display_name' value="+(e.data.display_name?e.data.display_name:"")+"></td></tr>",n+="<tr><td style='text-align:right'>Age</td><td><input class='form-control' type='number' id='id_age' min='0' max='120' name='age' style='width:7em' value="+(e.data.age?e.data.age:"")+"></td></tr>",n+="<tr><td style='text-align:right'>Year Of Birth</td><td><input class='form-control' type='number' id='id_yob' min='1900' max='2050' name='yob' style='width:7em' value="+(e.data.yob?e.data.yob:"")+"></td></tr>",n+='<tr><td colspan="2" id="id_sex"><label class="radio-inline"><input type="radio" name="sex" value="M" '+("M"===e.data.sex?"checked":"")+'>Male</label><label class="radio-inline"><input type="radio" name="sex" value="F" '+("F"===e.data.sex?"checked":"")+'>Female</label><label class="radio-inline"><input type="radio" name="sex" value="U">Unknown</label></td></tr>',n+='<tr><td colspan="2" id="id_status"><label class="checkbox-inline"><input type="radio" name="status" value="0" '+(0===parseInt(e.data.status)?"checked":"")+'>&thinsp;Alive</label><label class="checkbox-inline"><input type="radio" name="status" value="1" '+(1===parseInt(e.data.status)?"checked":"")+">&thinsp;Deceased</label></td></tr>",x("#id_status input[value='"+e.data.status+"']").prop("checked",!0);let a=["adopted_in","adopted_out","miscarriage","stillbirth","termination"];n+='<tr><td colspan="2"><strong>Reproduction:</strong></td></tr>',n+='<tr><td colspan="2">';for(let t=0;t<a.length;t++){let i=a[t];2===t&&(n+='</td></tr><tr><td colspan="2">'),n+='<label class="checkbox-inline"><input type="checkbox" id="id_'+i+'" name="'+i+'" value="0" '+(e.data[i]?"checked":"")+">&thinsp;"+T(i.replace("_"," "))+"</label>"}n+="</td></tr>";let o=["children","name","parent_node","top_level","id","noparents","level","age","sex","status","display_name","mother","father","yob","mztwin","dztwin"];x.merge(o,a),n+='<tr><td colspan="2"><strong>Age of Diagnosis:</strong></td></tr>',x.each(t.diseases,(function(i,r){o.push(r.type+"_diagnosis_age");let a='&thinsp;<span style="padding-left:5px;background:'+t.diseases[i].colour+'"></span>',s=e.data[r.type+"_diagnosis_age"];n+="<tr><td style='text-align:right'>"+T(r.type.replace("_"," "))+a+"&nbsp;</td><td><input class='form-control' id='id_"+r.type+"_diagnosis_age_0' max='110' min='0' name='"+r.type+"_diagnosis_age_0' style='width:5em' type='number' value='"+(void 0!==s?s:"")+"'></td></tr>"})),n+='<tr><td colspan="2" style="line-height:1px;"></td></tr>',x.each(e.data,(function(t,e){if(-1==x.inArray(t,o)){let i=T(t);!0===e||!1===e?n+="<tr><td style='text-align:right'>"+i+"&nbsp;</td><td><input type='checkbox' id='id_"+t+"' name='"+t+"' value="+e+" "+(e?"checked":"")+"></td></tr>":t.length>0&&(n+="<tr><td style='text-align:right'>"+i+"&nbsp;</td><td><input type='text' id='id_"+t+"' name='"+t+"' value="+e+"></td></tr>")}})),n+="</table>",x("#node_properties").html(n),x("#node_properties").dialog("open"),x("#node_properties input[type=radio], #node_properties input[type=checkbox], #node_properties input[type=text], #node_properties input[type=number]").change((function(){!function(t){let e=(0,r.Vk)(t),n=_("#id_name").val(),a=(0,i.KY)(e),o=(0,i.Lw)(a,n);if(!o)return void console.warn("person not found when saving details");_("#"+t.targetDiv).empty();let s=_("#id_yob_0").val();s&&""!==s?o.yob=s:delete o.yob;let l=_("#id_status").find("input[type='radio']:checked");l.length>0&&(o.status=l.val());let u=["miscarriage","adopted_in","adopted_out","termination","stillbirth"];for(let t=0;t<u.length;t++){let e=u[t],n=_("#id_"+e);n.length>0&&(console.log(n.is(":checked")),n.is(":checked")?o[e]=!0:delete o[e])}let c=_("#id_sex").find("input[type='radio']:checked");c.length>0&&(o.sex=c.val(),y(o)),m(a),_("#id_approx").is(":checked")?o.approx_diagnosis_age=!0:delete o.approx_diagnosis_age,_("#person_details select[name*='_diagnosis_age']:visible, #person_details input[type=text]:visible, #person_details input[type=number]:visible").each((function(){let t=this.name.indexOf("_diagnosis_age")>-1?this.name.substring(0,this.name.length-2):this.name;if(_(this).val()){let e=_(this).val();t.indexOf("_diagnosis_age")>-1&&_("#id_approx").is(":checked")&&(e=g(e)),o[t]=e}else delete o[t]})),_('#person_details input[type="checkbox"][name$="cancer"],input[type="checkbox"][name$="cancer2"]').each((function(){this.checked?o[_(this).attr("name")]=!0:delete o[_(this).attr("name")]})),_('#person_details select[name$="_bc_pathology"]').each((function(){"-"!==_(this).val()?o[_(this).attr("name")]=_(this).val():delete o[_(this).attr("name")]})),_('#person_details select[name$="_gene_test"]').each((function(){if("-"!==_(this).val()){let t=_('select[name="'+_(this).attr("name")+'_result"]');o[_(this).attr("name")]={type:_(this).val(),result:_(t).val()}}else delete o[_(this).attr("name")]}));try{_("#person_details").find("form").valid()}catch(t){console.warn("valid() not found")}V(a,o),t.dataset=a,R(t)}(t)}))}(t,a):"delete"===n?(e=(0,i.KY)((0,r.Vk)(t)),J(e,a.data,t,k)):"addparents"===n?(e=(0,i.KY)((0,r.Vk)(t)),t.dataset=e,X(t,e,a.data.name),R(t)):"addpartner"===n&&(e=(0,i.KY)((0,r.Vk)(t)),K(t,e,a.data.name),t.dataset=e,R(t)),x(document).trigger("fhChange",[t])}));let d=[];e.filter((function(t){return!t.data.hidden})).on("click",(function(e){v.event.ctrlKey?-1==d.indexOf(e)?d.push(e):d.splice(d.indexOf(e),1):d=[e],"nodeclick"in t&&(t.nodeclick(e.data),v.selectAll(".indi_rect").style("opacity",0),v.selectAll(".indi_rect").filter((function(t){return-1!=d.indexOf(t)})).style("opacity",.5))})).on("mouseover",(function(e){v.event.stopPropagation(),w=e,b?b.data.name!==w.data.name&&b.data.sex!==w.data.sex&&v.select(this).select("rect").style("opacity",.2):(v.select(this).select("rect").style("opacity",.2),v.select(this).selectAll(".addchild, .addsibling, .addpartner, .addparents, .delete, .settings").style("opacity",1),v.select(this).selectAll(".indi_details").style("opacity",0),M(t.symbol_size-10,0,t.symbol_size-2,0,e.x+","+(e.y+2)))})).on("mouseout",(function(e){if(b)return;v.select(this).selectAll(".addchild, .addsibling, .addpartner, .addparents, .delete, .settings").style("opacity",0),-1==d.indexOf(e)&&v.select(this).select("rect").style("opacity",0),v.select(this).selectAll(".indi_details").style("opacity",1);let n=v.mouse(this)[0],i=v.mouse(this)[1];i<.8*t.symbol_size&&v.selectAll(".popup_selection").style("opacity",0),b||(Math.abs(i)>.25*t.symbol_size||Math.abs(i)<-.25*t.symbol_size||n<.2*t.symbol_size)&&M(0,0,0,0)}))}function k(t,e){t.dataset=e,R(t)}function M(t,e,n,i,r){r&&v.selectAll(".line_drag_selection").attr("transform","translate("+r+")"),v.selectAll(".line_drag_selection").attr("x1",t).attr("y1",e).attr("x2",n).attr("y2",i)}function T(t){return t.charAt(0).toUpperCase()+t.slice(1)}var E=n(6939);function A(t,e){O(t,e,-.4*t.symbol_size,-.1*t.symbol_size,(function(e){return t.DEBUG?("display_name"in e.data?e.data.display_name:e.data.name)+"  "+e.data.id:"display_name"in e.data?e.data.display_name:""}),void 0,["display_name"]);let n=parseInt(function(t){let e=t.font_size;if(e===parseInt(e,10))return e;if(e.indexOf("px")>-1)return e.replace("px","");if(-1===e.indexOf("em"))return e;return e=parseFloat(e.replace("em","")),parseFloat(getComputedStyle(E("#"+t.targetDiv).get(0)).fontSize)*e-1}(t))+4;for(let i=0;i<t.labels.length;i++){let r=t.labels[i],a=Array.isArray(r)?r:[r];(a.indexOf("age")>-1||a.indexOf("yob")>-1)&&O(t,e,-t.symbol_size,(function(t){return N(t,a,n)}),(function(t){return S(t,a)}),"indi_details",a)}for(let i=0;i<t.diseases.length;i++){let r=t.diseases[i].type;O(t,e,-t.symbol_size,(function(t){return N(t,[r],n)}),(function(t){let e=r.replace("_"," ").replace("cancer","ca.");return r+"_diagnosis_age"in t.data?e+": "+t.data[r+"_diagnosis_age"]:""}),"indi_details",[r])}for(let i=0;i<t.labels.length;i++){let r=t.labels[i],a=Array.isArray(r)?r:[r];-1===a.indexOf("age")&&-1===a.indexOf("yob")&&O(t,e,-t.symbol_size,(function(t){return N(t,a,n)}),(function(t){return S(t,a)}),"indi_details",a)}}function S(t,e){let n="";for(let i=0;i<e.length;i++){let r=e[i];if(t.data[r])if("alleles"===r){let e=t.data.alleles.split(";");for(let t=0;t<e.length;t++)""!==e[t]&&(n+=e[t]+";")}else if("age"===r)n+=t.data[r]+"y ";else if("stillbirth"===r)n+="SB";else if(r.match("_gene_test$")&&"result"in t.data[r]){let e=t.data[r].result.toUpperCase();"-"!==e&&(n+=r.replace("_gene_test","").toUpperCase(),n+="P"===e?"+ ":"N"===e?"- ":" ")}else if(r.match("_bc_pathology$")){let e=t.data[r].toUpperCase();n+=r.replace("_bc_pathology","").toUpperCase(),n+="P"===e?"+ ":"N"===e?"- ":" "}else n+=t.data[r]}if(""!==n)return n}function N(t,e,n){if(Z(t,e))return t.y_offset=t.y_offset?t.y_offset+n:2.35*n,t.y_offset}function Z(t,e){for(let n=0;n<e.length;n++)if((0,i.UY)(e[n],t.data))return!0;return!1}function O(t,e,n,i,r,a,o){e.filter((function(t){return!t.data.hidden&&(!o||Z(t,o))})).append("text").attr("class",a?a+" ped_label":"ped_label").attr("x",n).attr("y",i).attr("font-family",t.font_family).attr("font-size",t.font_size).attr("font-weight",t.font_weight).text(r)}var B=n(6939),I=n(44449);let F={};function D(t){let e=B.extend({targetDiv:"pedigree_edit",dataset:[{name:"m21",display_name:"father",sex:"M",top_level:!0},{name:"f21",display_name:"mother",sex:"F",top_level:!0},{name:"ch1",display_name:"me",sex:"F",mother:"f21",father:"m21",proband:!0}],width:600,height:400,symbol_size:35,zoomSrc:["wheel","button"],zoomIn:1,zoomOut:1,diseases:[{type:"breast_cancer",colour:"#F68F35"},{type:"breast_cancer2",colour:"pink"},{type:"ovarian_cancer",colour:"#4DAA4D"},{type:"pancreatic_cancer",colour:"#4289BA"},{type:"prostate_cancer",colour:"#D5494A"}],labels:["stillbirth",["age","yob"],"alleles",["brca1_gene_test","brca2_gene_test","palb2_gene_test","chek2_gene_test","atm_gene_test"],["rad51d_gene_test","rad51c_gene_test","brip1_gene_test"],["er_bc_pathology","pr_bc_pathology","her2_bc_pathology","ck14_bc_pathology","ck56_bc_pathology"]],keep_proband_on_reset:!1,font_size:".75em",font_family:"Helvetica",font_weight:700,background:"#EEE",node_background:"#fdfdfd",validate:!0,DEBUG:!1},t);0===B("#fullscreen").length&&(f(e),p.IH(e)),-1==r.m6(e)&&r.k8(e),function(t){let e=r.bn(t),n=r.m6(t),i="#"+t.btn_target;n<=e?h(i+" .fa-repeat").addClass("disabled"):h(i+" .fa-repeat").removeClass("disabled"),e>1?h(i+" .fa-undo").removeClass("disabled"):h(i+" .fa-undo").addClass("disabled")}(e),C(e),e.dataset=function(t){for(let e=0;e<t.length;e++)2==i.hh(t,t[e].name)&&(t[e].top_level=!0);let e=[],n=[];for(let r=0;r<t.length;r++){let a=t[r];if("top_level"in a&&-1==B.inArray(a.name,n)){n.push(a.name),e.push(a);let r=i.UQ(t,a);for(let a=0;a<r.length;a++)-1==B.inArray(r[a],n)&&(n.push(r[a]),e.push(i.Lw(t,r[a])))}}let r=B.map(t,(function(t,e){return"top_level"in t&&t.top_level?null:t}));for(let t=e.length;t>0;--t)r.unshift(e[t-1]);return r}(e.dataset),e.DEBUG&&i.Tx(e);let n=U(e),a=I.select("#"+e.targetDiv).append("svg:svg").attr("width",n.width).attr("height",n.height);a.append("rect").attr("width","100%").attr("height","100%").attr("rx",6).attr("ry",6).style("stroke","darkgrey").style("fill",e.background).style("stroke-width",1);let o=a.append("g").attr("class","diagram"),l={name:"hidden_root",id:0,hidden:!0,children:B.map(e.dataset,(function(t,e){return"top_level"in t&&t.top_level?t:null}))},u=i.fX(e,l,l)[0],c=I.hierarchy(l);F[e.targetDiv]=c;let d=Y(e);e.DEBUG&&console.log("opts.width="+n.width+" width="+d.width+" opts.height="+n.height+" height="+d.height);let _=I.tree().separation((function(t,e){return t.parent===e.parent||t.data.hidden||e.data.hidden?1.2:2.2})).size([d.width,d.height])(c.sort((function(t,e){return t.data.id-e.data.id}))),m=_.descendants();if(B.map(e.dataset,(function(t,e){return t.hidden?null:t})).length!=e.dataset.length)throw L("NUMBER OF VISIBLE NODES DIFFERENT TO NUMBER IN THE DATASET");i.e3(e,_,m);let y=i.Yc(m,u);!function(t,e){for(let n=0;n<e.length;n++){let i=P(t,e[n]);i&&console.log("CLASH :: "+e[n].mother.data.name+" "+e[n].father.data.name,i)}}(e,y);let g=o.selectAll(".node").data(_.descendants()).enter().append("g").attr("transform",(function(t,e){return"translate("+t.x+","+t.y+")"}));g.filter((function(t){return!t.data.hidden})).append("path").attr("shape-rendering","geometricPrecision").attr("transform",(function(t){return"U"!=t.data.sex||t.data.miscarriage||t.data.termination?"":"rotate(45)"})).attr("d",I.symbol().size((function(t){return e.symbol_size*e.symbol_size+2})).type((function(t){return t.data.miscarriage||t.data.termination?I.symbolTriangle:"F"==t.data.sex?I.symbolCircle:I.symbolSquare}))).style("stroke",(function(t){return t.data.age&&t.data.yob&&!t.data.exclude?"#303030":"grey"})).style("stroke-width",(function(t){return t.data.age&&t.data.yob&&!t.data.exclude?".3em":".1em"})).style("stroke-dasharray",(function(t){return t.data.exclude?"3, 3":null})).style("fill","none"),g.filter((function(t){return!(t.data.hidden&&!e.DEBUG)})).append("clipPath").attr("id",(function(t){return t.data.name})).append("path").attr("class","node").attr("transform",(function(t){return"U"!=t.data.sex||t.data.miscarriage||t.data.termination?"":"rotate(45)"})).attr("d",I.symbol().size((function(t){return t.data.hidden?e.symbol_size*e.symbol_size/5:e.symbol_size*e.symbol_size})).type((function(t){return t.data.miscarriage||t.data.termination?I.symbolTriangle:"F"==t.data.sex?I.symbolCircle:I.symbolSquare}))),g.filter((function(t){return!(t.data.hidden&&!e.DEBUG)})).selectAll("pienode").data((function(t){let n=0,r=B.map(e.diseases,(function(r,a){return i.UY(e.diseases[a].type,t.data)?(n++,1):0}));return 0===n&&(r=[1]),[B.map(r,(function(e,i){return{cancer:e,ncancers:n,id:t.data.name,sex:t.data.sex,proband:t.data.proband,hidden:t.data.hidden,affected:t.data.affected,exclude:t.data.exclude}}))]})).enter().append("g").selectAll("path").data(I.pie().value((function(t){return t.cancer}))).enter().append("path").attr("clip-path",(function(t){return"url(#"+t.data.id+")"})).attr("class","pienode").attr("d",I.arc().innerRadius(0).outerRadius(e.symbol_size)).style("fill",(function(t,n){return t.data.exclude?"lightgrey":0===t.data.ncancers?t.data.affected?"darkgrey":e.node_background:e.diseases[n].colour})),g.filter((function(t){return!t.data.hidden&&(t.data.adopted_in||t.data.adopted_out)})).append("path").attr("d",(function(t){{let t=-.66*e.symbol_size,n=-.64*e.symbol_size,i=e.symbol_size/4;return q(t,n,i,e)+q(-t,n,-i,e)}})).style("stroke",(function(t){return t.data.age&&t.data.yob&&!t.data.exclude?"#303030":"grey"})).style("stroke-width",(function(t){return".1em"})).style("stroke-dasharray",(function(t){return t.data.exclude?"3, 3":null})).style("fill","none"),g.filter((function(t){return 1==t.data.status})).append("line").style("stroke","black").attr("x1",(function(t,n){return-.6*e.symbol_size})).attr("y1",(function(t,n){return.6*e.symbol_size})).attr("x2",(function(t,n){return.6*e.symbol_size})).attr("y2",(function(t,n){return-.6*e.symbol_size})),A(e,g),z(e,g);let x={},v=function(t,e,n,i,r,a){let o=function(t,e){return t+1<e?o(++t):t},s="";for(let l=0;l<t.length;l++){let u=o(l,t.length),c=t[l]-e-a,h=t[u]+e+a;r.x>c&&r.x<h&&(r.y=i),s+="L"+c+","+(n-a)+"L"+c+","+(i-a)+"L"+h+","+(i-a)+"L"+h+","+(n-a),l=u}return s};u=o.selectAll(".partner").data(y).enter().insert("path","g").attr("fill","none").attr("stroke","#000").attr("shape-rendering","auto").attr("d",(function(t,n){let r,a,o,s=i.Lw(m,t.mother.data.name),l=i.Lw(m,t.father.data.name),u=i._L(s,l,e),c=t.mother.data.divorced&&t.mother.data.divorced===t.father.data.name,h=t.mother.x<t.father.x?t.mother.x:t.father.x,f=t.mother.x<t.father.x?t.father.x:t.mother.x,d=t.mother.y,p=P(e,t),_="";if(p){t.mother.depth in x?x[t.mother.depth]+=4:x[t.mother.depth]=4,d-=x[t.mother.depth],a=x[t.mother.depth]+e.symbol_size/2+2;let n=t.mother.data.parent_node,s=n[0];for(let e=0;e<n.length;e++)n[e].father.name===t.father.data.name&&n[e].mother.name===t.mother.data.name&&(s=n[e].name);o=i.Lw(m,s),o.y=d,p.sort((function(t,e){return t-e})),r=d-e.symbol_size/2-3,_=v(p,a,d,r,o,0)}let y="";if(c&&!p&&(y="M"+(h+.66*(f-h)+6)+","+(d-6)+"L"+(h+.66*(f-h)-6)+","+(d+6)+"M"+(h+.66*(f-h)+10)+","+(d-6)+"L"+(h+.66*(f-h)-2)+","+(d+6)),u){d=t.mother.x<t.father.x?t.mother.y:t.father.y,r=t.mother.x<t.father.x?t.father.y:t.mother.y;let e=3;if(Math.abs(d-r)>.1)return"M"+h+","+d+"L"+f+","+r+"M"+h+","+(d-e)+"L"+f+","+(r-e);return"M"+h+","+d+_+"L"+f+","+d+"M"+h+","+(d-e)+(p?v(p,a,d,r,o,e):"")+"L"+f+","+(d-e)+y}return"M"+h+","+d+_+"L"+f+","+d+y})),o.selectAll(".link").data(c.links(_.descendants())).enter().filter((function(t){return e.DEBUG||void 0===t.target.data.noparents&&null!==t.source.parent&&!t.target.data.hidden})).insert("path","g").attr("fill","none").attr("stroke-width",(function(t,n){return void 0!==t.target.data.noparents||null===t.source.parent||t.target.data.hidden?1:e.DEBUG?2:1})).attr("stroke",(function(t,e){return void 0!==t.target.data.noparents||null===t.source.parent||t.target.data.hidden?"pink":"#000"})).attr("stroke-dasharray",(function(t,n){if(!t.target.data.adopted_in)return null;let r=Math.abs(t.source.y-(t.source.y+t.target.y)/2),a=[r,0,Math.abs(t.source.x-t.target.x),0];i.Cz(e.dataset,t.target.data).length>=1&&(r*=3);for(let t=0;t<r;t+=10)B.merge(a,[5,5]);return a})).attr("shape-rendering",(function(t,e){return t.target.data.mztwin||t.target.data.dztwin?"geometricPrecision":"auto"})).attr("d",(function(t,n){if(t.target.data.mztwin||t.target.data.dztwin){let n=i.Cz(e.dataset,t.target.data);if(n.length>=1){let r=0,a=t.target.x,o=t.target.x;for(let t=0;t<n.length;t++){let e=i.Lw(m,n[t].name).x;a>e&&(a=e),o<e&&(o=e),r+=e}let s=(t.target.x+r)/(n.length+1),l=(t.source.y+t.target.y)/2,u="";if(a===t.target.x&&t.target.data.mztwin){let n=(s+t.target.x)/2,i=(l+(t.target.y-e.symbol_size/2))/2;u="M"+n+","+i+"L"+(s+(s-n))+" "+i}return"M"+t.source.x+","+t.source.y+"V"+l+"H"+s+"L"+t.target.x+" "+(t.target.y-e.symbol_size/2)+u}}if(t.source.data.mother){let e=i.Lw(m,t.source.data.mother.name),n=i.Lw(m,t.source.data.father.name);if(e.depth!==n.depth)return"M"+t.source.x+","+(e.y+n.y)/2+"H"+t.target.x+"V"+t.target.y}return"M"+t.source.x+","+t.source.y+"V"+(t.source.y+t.target.y)/2+"H"+t.target.x+"V"+t.target.y}));let b=i.Kz(e.dataset);if(void 0!==b){let t=i.Lw(m,e.dataset[b].name),n="triangle"+i.YO(3);o.append("svg:defs").append("svg:marker").attr("id",n).attr("refX",6).attr("refY",6).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d","M 0 0 12 6 0 12 3 6").style("fill","black"),o.append("line").attr("x1",t.x-e.symbol_size/.7).attr("y1",t.y+e.symbol_size/1.4).attr("x2",t.x-e.symbol_size/1.4).attr("y2",t.y+e.symbol_size/4).attr("stroke-width",1).attr("stroke","black").attr("marker-end","url(#"+n+")")}return s(e,a),e}function L(t){return console.error(t),new Error(t)}function C(t){if(t.validate){if("function"==typeof t.validate)return t.DEBUG&&console.log("CALLING CONFIGURED VALIDATION FUNCTION"),t.validate.call(this,t);let e,n=[],r=[];for(let a=0;a<t.dataset.length;a++){if(!a.hidden&&(t.dataset[a].mother||t.dataset[a].father)){e=t.dataset[a].display_name,e||(e="unnamed"),e+=" (IndivID: "+t.dataset[a].name+")";let n=t.dataset[a].mother,r=t.dataset[a].father;if(!n||!r)throw L("Missing parent for "+e);let o=i.qj(t.dataset,n),s=i.qj(t.dataset,r);if(-1===o)throw L("The mother (IndivID: "+n+") of family member "+e+" is missing from the pedigree.");if(-1===s)throw L("The father (IndivID: "+r+") of family member "+e+" is missing from the pedigree.");if("F"!==t.dataset[o].sex)throw L("The mother of family member "+e+" is not specified as female. All mothers in the pedigree must have sex specified as 'F'.");if("M"!==t.dataset[s].sex)throw L("The father of family member "+e+" is not specified as male. All fathers in the pedigree must have sex specified as 'M'.")}if(!t.dataset[a].name)throw L(e+" has no IndivID.");if(B.inArray(t.dataset[a].name,n)>-1)throw L("IndivID for family member "+e+" is not unique.");n.push(t.dataset[a].name),-1===B.inArray(t.dataset[a].famid,r)&&t.dataset[a].famid&&r.push(t.dataset[a].famid)}if(r.length>1)throw L("More than one family found: "+r.join(", ")+".");let a=i.py(t.dataset);a.length>0&&console.warn("individuals unconnected to pedigree ",a)}}function q(t,e,n,i){return"M"+(t+n)+","+e+"L"+t+" "+e+"L"+t+" "+(e+1.28*i.symbol_size)+"L"+t+" "+(e+1.28*i.symbol_size)+"L"+(t+n)+","+(e+1.28*i.symbol_size)}function P(t,e){let n,r,a=F[t.targetDiv],o=i.xH(a);if("name"in e){if(!("mother"in(e=i.Lw(o,e.name)).data))return null;n=i.Lw(o,e.data.mother),r=i.Lw(o,e.data.father)}else n=e.mother,r=e.father;let s=n.x<r.x?n.x:r.x,l=n.x<r.x?r.x:n.x,u=n.y,c=B.map(o,(function(t,e){return!t.data.hidden&&t.data.name!==n.data.name&&t.data.name!==r.data.name&&t.y==u&&t.x>s&&t.x<l?t.x:null}));return c.length>0?c:null}function U(t){return{width:d()?window.innerWidth:t.width,height:d()?window.innerHeight:t.height}}function Y(t){let e=U(t),n=0,r={};for(let e=0;e<t.dataset.length;e++){let a=i.hh(t.dataset,t.dataset[e].name),o=i.nI(t.dataset,t.dataset[e]),s=1+(o.length>0?.55+.25*o.length:0)+(t.dataset[e].father?.25:0);a in r?r[a]+=s:r[a]=s,r[a]>n&&(n=r[a])}let a=Object.keys(r).length*t.symbol_size*3.5;return{width:e.width-t.symbol_size>n*t.symbol_size*1.65?e.width-t.symbol_size:n*t.symbol_size*1.65,height:e.height-t.symbol_size>a?e.height-t.symbol_size:a}}function R(t){B("#"+t.targetDiv).empty(),r.k8(t);try{D(t)}catch(t){throw console.error(t),t}try{templates.update(t)}catch(t){}}function j(t,e,n,r,a){if(a&&-1===B.inArray(a,["mztwin","dztwin"]))return new Error("INVALID TWIN TYPE SET: "+a);void 0===r&&(r=1);let o,s,l,u=i.nI(t,e);if(0===u.length){let n=H(t,e,"F"===e.sex?"M":"F","F"===e.sex);n.noparents=!0,o=n.name,s=i.qj(t,e.name)+1}else{let n=u[0];o=n.father===e.name?n.mother:n.father,s=i.qj(t,n.name)}a&&(l=G(t,a));let c=[];for(let u=0;u<r;u++){let r={name:i.YO(4),sex:n,mother:"F"===e.sex?e.name:o,father:"F"===e.sex?o:e.name};t.splice(s,0,r),a&&(r[a]=l),c.push(r)}return c}function H(t,e,n,r,a){if(a&&-1===B.inArray(a,["mztwin","dztwin"]))return new Error("INVALID TWIN TYPE SET: "+a);let o={name:i.YO(4),sex:n};e.top_level?o.top_level=!0:(o.mother=e.mother,o.father=e.father);let s=i.qj(t,e.name);return a&&function(t,e,n,i){if(!e[i]&&(e[i]=G(t,i),!e[i]))return!1;n[i]=e[i],e.yob&&(n.yob=e.yob);!e.age||0!=e.status&&e.status||(n.age=e.age)}(t,t[s],o,a),r?s>0&&s--:s++,t.splice(s,0,o),o}function G(t,e){let n=[1,2,3,4,5,6,7,8,9,"A"];for(let i=0;i<t.length;i++)if(t[i][e]){let r=n.indexOf(t[i][e]);r>-1&&n.splice(r,1)}if(n.length>0)return n[0]}function V(t,e){if(!e.mztwin&&!e.dztwin)return;let n=e.mztwin?"mztwin":"dztwin";for(let i=0;i<t.length;i++){let r=t[i];r[n]&&e[n]==r[n]&&r.name!==e.name&&("mztwin"===n&&(r.sex=e.sex),e.yob&&(r.yob=e.yob),!e.age||0!=e.status&&e.status||(r.age=e.age))}}function X(t,e,n){let r,a,o,s,l=F[t.targetDiv],u=i.xH(l),c=i.Lw(u,n),h=c.data,f=c.depth,d=-101,p=i.nI(e,h);if(p.length>0&&(o=p[0].mother==h.name?p[0].father:p[0].mother,d=i.Lw(u,o).data.id),1==f)for(r={name:i.YO(4),sex:"F",top_level:!0},a={name:i.YO(4),sex:"M",top_level:!0},e.splice(0,0,r),e.splice(0,0,a),s=0;s<e.length;s++)e[s].top_level&&e[s].name!==r.name&&e[s].name!==a.name&&(delete e[s].top_level,e[s].noparents=!0,e[s].mother=r.name,e[s].father=a.name);else{let n=i.Lw(u,c.data.mother),o=i.Lw(u,c.data.father),l=i.Dc(e,h),f=1e4,p=c.data.id;for(s=0;s<l.length;s++){let t=i.Lw(u,l[s].name).data.id;t<f&&t>c.data.id&&(f=t),t<p&&(p=t)}let _,m=p>=c.data.id||d==p&&f<1e4;t.DEBUG&&console.log("lid="+p+" rid="+f+" nid="+c.data.id+" ADD_LHS="+m),_=!m&&o.data.id>n.data.id||m&&o.data.id<n.data.id?i.qj(e,h.father):i.qj(e,h.mother);let y=e[_];a=H(e,y,"M",m),r=H(e,y,"F",m);let g=i.qj(e,a.name),x=i.qj(e,r.name);if(g>x){let t=e[g];e[g]=e[x],e[x]=t}let v=i.d$(e,h),b=c.data.id;for(s=0;s<v.length;s++){let n=i.Lw(u,v[s].name).data.id;if(t.DEBUG&&console.log("ORPHAN="+s+" "+v[s].name+" "+(b<n&&n<f)+" nid="+b+" oid="+n+" rid="+f),(m||b<n)&&n<f){let t=i.qj(e,v[s].name);e[t].mother=r.name,e[t].father=a.name}}}2==f?(r.top_level=!0,a.top_level=!0):f>2&&(r.noparents=!0,a.noparents=!0);let _=i.qj(e,h.name);if(e[_].mother=r.name,e[_].father=a.name,delete e[_].noparents,"parent_node"in h){let t=e[i.qj(e,o)];"noparents"in t&&(t.mother=r.name,t.father=a.name)}}function K(t,e,n){let r=F[t.targetDiv],a=i.xH(r),o=i.Lw(a,n),s=H(e,o.data,"F"===o.data.sex?"M":"F","F"===o.data.sex);s.noparents=!0;let l={name:i.YO(4),sex:"M"};l.mother="F"===o.data.sex?o.data.name:s.name,l.father="F"===o.data.sex?s.name:o.data.name;let u=i.qj(e,o.data.name)+2;e.splice(u,0,l)}function W(t,e,n){let r,a,o=i.Ec(i.xH(t),e.depth,n);for(let t=0;t<o.length;t++)o[t].x<e.x&&(r=o[t]),!a&&o[t].x>e.x&&(a=o[t]);return[r,a]}function J(t,e,n,r){let a,o,s,l=F[n.targetDiv],u=i.xH(l),c=[];if(void 0===e.id){let t=i.Lw(u,e.name);void 0!==t&&(e=t.data)}if(e.parent_node)for(a=0;a<e.parent_node.length;a++){let n=e.parent_node[a],r=[i.Lw(t,n.mother.name),i.Lw(t,n.father.name)];for(o=0;o<r.length;o++)(r[o].name===e.name||void 0!==r[o].noparents||r[o].top_level)&&(t.splice(i.qj(t,r[o].name),1),c.push(r[o]));let s=n.children,h=B.map(s,(function(t,e){return t.name}));for(o=0;o<s.length;o++){let e=i.Lw(t,s[o].name);if(e){e.noparents=!0;let n,r=i.UQ(t,e);if(r.length>0&&(n=i.Lw(t,r[0])),n&&n.mother!==e.mother)e.mother=n.mother,e.father=n.father;else if(n){let t=W(l,i.Lw(u,e.name),h);e.mother=t[0]?t[0].data.mother:t[1]?t[1].data.mother:null,e.father=t[0]?t[0].data.father:t[1]?t[1].data.father:null}else t.splice(i.qj(t,e.name),1)}}}else t.splice(i.qj(t,e.name),1);for(console.log(c),a=0;a<c.length;a++){let e=c[a],n=i.Dc(t,e);if(console.log("DEL",e.name,n),n.length<1){console.log("del sibs",e.name,n);let r=i.Lw(u,e.name).ancestors();for(o=0;o<r.length;o++)console.log(r[a]),r[o].data.mother&&(console.log("DELETE ",r[o].data.mother,r[o].data.father),t.splice(i.qj(t,r[o].data.mother.name),1),t.splice(i.qj(t,r[o].data.father.name),1))}}!function(t){let e=["mztwin","dztwin"];for(let n=0;n<t.length;n++)for(let i=0;i<e.length;i++){let r=e[i];if(t[n][r]){let e=0;for(let i=0;i<t.length;i++)t[i][r]==t[n][r]&&e++;e<2&&delete t[n][[r]]}}}(t);try{let e=B.extend({},n);e.dataset=i.KY(t),C(e),s=i.py(t)}catch(t){throw i.sY("Warning","Deletion of this pedigree member is disallowed."),t}return s.length>0&&0===i.py(n.dataset).length?(console.error("individuals unconnected to pedigree ",s),void i.sY("Warning","Deleting this will split the pedigree. Continue?",r,n,t)):(r&&r(n,t),t)}},91843:function(t,e,n){"use strict";n.d(e,{w1:function(){return r},un:function(){return a},KY:function(){return o},UY:function(){return s},sY:function(){return l},YO:function(){return u},fX:function(){return c},IL:function(){return d},UQ:function(){return m},py:function(){return y},Kz:function(){return g},Dc:function(){return v},Cz:function(){return b},d$:function(){return w},nI:function(){return z},hh:function(){return k},qj:function(){return M},Ec:function(){return T},Yc:function(){return E},_L:function(){return S},xH:function(){return N},e3:function(){return Z},Lw:function(){return B},Tx:function(){return I}});n(85516),n(56327);var i=n(6939);function r(){let t=navigator.userAgent;return t.indexOf("MSIE ")>-1||t.indexOf("Trident/")>-1}function a(){return navigator.userAgent.match(/Edge/g)}function o(t){t[0].id&&t.sort((function(t,e){return t.id&&e.id?t.id>e.id?1:e.id>t.id?-1:0:0}));let e=["id","parent_node"],n=[];for(let i=0;i<t.length;i++){let r={};for(let n in t[i])-1==e.indexOf(n)&&(r[n]=t[i][n]);n.push(r)}return n}function s(t,e){let n=!1;return e&&i.each(e,(function(e,i){if(0===e.indexOf(t+"_")||e===t)return n=!0,n})),n}function l(t,e,n,i,r){n?!0===confirm(e)&&n(i,r):alert(e)}function u(t){let e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(let i=0;i<t;i++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}function c(t,e,n,r,a){void 0===e.children&&(e.children=x(t.dataset,e)),void 0===r&&(r=[],a=1);let o=N(n),s=[];return i.each(e.children,(function(e,n){i.each(t.dataset,(function(e,i){if((n.name===i.mother||n.name===i.father)&&void 0===n.id){let e=B(o,i.mother),n=B(o,i.father);e=void 0!==e?e:B(t.dataset,i.mother),n=void 0!==n?n:B(t.dataset,i.father),function(t,e,n){for(let i=0;i<t.length;i++)if(t[i].mother===e&&t[i].father===n)return!0;return!1}(s,e,n)||s.push({mother:e,father:n})}}))})),i.merge(r,s),i.each(s,(function(n,i){let r=i.mother,s=i.father;r.children=[];let l={name:u(4),hidden:!0,parent:null,father:s,mother:r,children:x(t.dataset,r,s)},c=M(t.dataset,r.name),d=M(t.dataset,s.name);"id"in s||"id"in r||(a=f(e.children,a));let p=function(t,e,n){let i=e,r=n;for(;"mother"in t[i]&&"mother"in t[r]&&!("noparents"in t[i])&&!("noparents"in t[r]);)i=M(t,t[i].mother),r=M(t,t[r].mother);return{midx:i,fidx:r}}(t.dataset,c,d);p.fidx<p.midx?(s.id=a++,l.id=a++,r.id=a++):(r.id=a++,l.id=a++,s.id=a++),a=h(r,l,a,o,t),a=h(s,l,a,o,t),e.children.push(l)})),a=f(e.children,a),i.each(e.children,(function(e,i){a=c(t,i,n,r,a)[1]})),[r,a]}function h(t,e,n,i,r){if("parent_node"in t?t.parent_node.push(e):t.parent_node=[e],t.mztwin||t.dztwins){let e=b(r.dataset,t);for(let t=0;t<e.length;t++){let r=B(i,e[t].name);r&&(r.id=n++)}}return n}function f(t,e){return t.sort((function(t,e){return t.mztwin&&e.mztwin&&t.mztwin==e.mztwin||t.dztwin&&e.dztwin&&t.dztwin==e.dztwin?0:t.mztwin||e.mztwin||t.dztwin||e.dztwin?1:0})),i.each(t,(function(t,n){void 0===n.id&&(n.id=e++)})),e}function d(t){return void 0!==i(t).attr("proband")&&!1!==i(t).attr("proband")}function p(t,e){for(let n=0;n<e.length;n++)-1==i.inArray(e[n],t)&&t.push(e[n])}function _(t,e,n){if(-1==i.inArray(e.name,t))return;p(t,m(n,e));let r=z(n,e);i.each(r,(function(e,r){-1==i.inArray(r.name,t)&&(t.push(r.name),p(t,m(n,r)))}))}function m(t,e){let n=[];for(let r=0;r<t.length;r++){let a=t[r];e.name===a.mother&&-1==i.inArray(a.father,n)?n.push(a.father):e.name===a.father&&-1==i.inArray(a.mother,n)&&n.push(a.mother)}return n}function y(t){let e=t[g(t)];if(!e){if(console.warn("No target defined"),0==t.length)throw"empty pedigree data set";e=t[0]}let n=[e.name],r=!0,a=0;for(;r&&a<200;){a++;let o=n.length;i.each(t,(function(r,a){if(-1!=i.inArray(a.name,n)){let r=m(t,a),o=a.name===e.name||!a.noparents;for(let e=0;e<r.length;e++)B(t,r[e]).noparents||(o=!0);o&&(a.mother&&-1==i.inArray(a.mother,n)&&n.push(a.mother),a.father&&-1==i.inArray(a.father,n)&&n.push(a.father))}else!a.noparents&&(a.mother&&-1!=i.inArray(a.mother,n)||a.father&&-1!=i.inArray(a.father,n))&&n.push(a.name);_(n,a,t)})),r=o!=n.length}let o=i.map(t,(function(t,e){return t.name}));return i.map(o,(function(t,e){return-1==i.inArray(t,n)?t:null}))}function g(t){let e;return i.each(t,(function(t,n){if(d(n))return e=t,e})),e}function x(t,e,n){let r=[],a=[];return"F"===e.sex&&i.each(t,(function(t,o){e.name===o.mother&&(n&&n.name!=o.father||-1===i.inArray(o.name,a)&&(r.push(o),a.push(o.name)))})),r}function v(t,e,n){return i.map(t,(function(t,i){return t.name===e.name||"noparents"in t||!t.mother||t.mother!==e.mother||t.father!==e.father||n&&t.sex!=n?null:t}))}function b(t,e){let n=function(t,e,n){return void 0===e||!e.mother||e.noparents?[]:i.map(t,(function(t,i){return t.name===e.name||"noparents"in t||!t.mother||t.mother!==e.mother||t.father!==e.father||n&&t.sex!=n?null:t}))}(t,e),r=e.mztwin?"mztwin":"dztwin";return i.map(n,(function(t,n){return t.name!==e.name&&t[r]==e[r]?t:null}))}function w(t,e){return i.map(t,(function(t,n){return t.name!==e.name&&"noparents"in t&&t.mother===e.mother&&t.father===e.father?t:null}))}function z(t,e,n){return i.map(t,(function(t,i){return"noparents"in t||t.mother!==e.name&&t.father!==e.name||n&&t.sex!==n?null:t}))}function k(t,e){let n=M(t,e),i=1;for(;n>=0&&("mother"in t[n]||t[n].top_level);)n=M(t,t[n].mother),i++;return i}function M(t,e){let n=-1;return i.each(t,(function(t,i){if(e===i.name)return n=t,n})),n}function T(t,e,n){return i.map(t,(function(t,r){return t.depth!=e||t.data.hidden||-1!=i.inArray(t.data.name,n)?null:t})).sort((function(t,e){return t.x-e.x}))}function E(t,e){let n=[];for(let i=0;i<e.length;i++)n.push({mother:B(t,e[i].mother.name),father:B(t,e[i].father.name)});return n}function A(t,e){let n=[];return function e(i){i.data&&(i=i.data),"mother"in i&&"father"in i&&!("noparents"in i)&&(e(B(t,i.mother)),e(B(t,i.father))),n.push(i)}(e),n}function S(t,e,n){if(t.depth!==e.depth)return!0;let r=A(n.dataset,t),a=A(n.dataset,e),o=i.map(r,(function(t,e){return t.name})),s=i.map(a,(function(t,e){return t.name})),l=!1;return i.each(o,(function(t,e){if(-1!==i.inArray(e,s))return l=!0,!1})),l}function N(t){let e=[];return function t(n){n.children&&n.children.forEach(t),e.push(n)}(t),e}function Z(t,e,n){function r(a){if(a.children&&(a.children.forEach(r),void 0!==a.data.father)){let r=B(n,a.data.father.name),o=B(n,a.data.mother.name),s=(r.x+o.x)/2;if(O(t,e.descendants(),s,a.depth,[a.data.name]))(a.x<r.x&&a.x<o.x||a.x>r.x&&a.x>o.x)&&(a.x=s);else{a.x=s;let n=a.x-s;if(2==a.children.length&&(a.children[0].data.hidden||a.children[1].data.hidden)){if(!a.children[0].data.hidden||!a.children[1].data.hidden){let n=a.children[0].data.hidden?a.children[1]:a.children[0],i=a.children[0].data.hidden?a.children[0]:a.children[1];(n.x<i.x&&s<i.x||n.x>i.x&&s>i.x)&&!O(t,e.descendants(),s,n.depth,[n.data.name])&&(n.x=s)}}else if(1!=a.children.length||a.children[0].data.hidden){if(0!==n&&!function(t,e,n,r){let a=e.descendants(),o=i.map(a,(function(t,e){return t.data.name})),s=r.descendants();for(let i=0;i<a.length;i++){let r=a[i];if(e.data.name!==r.data.name){if(O(t,s,r.x-n,r.depth,o))return!0}}return!1}(t,a,n,e))if(1==a.children.length)a.children[0].x=s;else{let e=a.descendants();t.DEBUG&&console.log("ADJUSTING "+a.data.name+" NO. DESCENDANTS "+e.length+" diff="+n);for(let t=0;t<e.length;t++)a.data.name!==e[t].data.name&&(e[t].x-=n)}}else O(t,e.descendants(),s,a.children[0].depth,[a.children[0].data.name])||(a.children[0].x=s)}}}r(e),r(e)}function O(t,e,n,r,a){for(let o=0;o<e.length;o++)if(r==e[o].depth&&-1==i.inArray(e[o].data.name,a)&&Math.abs(n-e[o].x)<1.15*t.symbol_size)return!0;return!1}function B(t,e){for(let n=0;n<t.length;n++){if(t[n].data&&e===t[n].data.name)return t[n];if(e===t[n].name)return t[n]}}function I(t){let e;i("#pedigree_data").remove(),i("body").append("<div id='pedigree_data'></div>");for(let n=0;n<t.dataset.length;n++){let r="<div class='row'><strong class='col-md-1 text-right'>"+t.dataset[n].name+"</strong><div class='col-md-11'>";for(e in t.dataset[n])"name"!==e&&("parent"===e?r+="<span>"+e+":"+t.dataset[n][e].name+"; </span>":"children"===e?void 0!==t.dataset[n][e][0]&&(r+="<span>"+e+":"+t.dataset[n][e][0].name+"; </span>"):r+="<span>"+e+":"+t.dataset[n][e]+"; </span>");i("#pedigree_data").append(r+"</div></div>")}for(e in i("#pedigree_data").append("<br /><br />"),t)"dataset"!==e&&i("#pedigree_data").append("<span>"+e+":"+t[e]+"; </span>")}},18063:function(t,e,n){!function(t,e){"use strict";function n(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var i=n(e);function r(t,e){return r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(t,e)}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r(t,e)}var o=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=[]),t.length!==e.length||t.some((function(t,n){return!Object.is(t,e[n])}))},s={error:null},l=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))||this).state=s,e.updatedWithError=!1,e.resetErrorBoundary=function(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];null==e.props.onReset||(t=e.props).onReset.apply(t,i),e.reset()},e}a(e,t),e.getDerivedStateFromError=function(t){return{error:t}};var n=e.prototype;return n.reset=function(){this.updatedWithError=!1,this.setState(s)},n.componentDidCatch=function(t,e){var n,i;null==(n=(i=this.props).onError)||n.call(i,t,e)},n.componentDidMount=function(){null!==this.state.error&&(this.updatedWithError=!0)},n.componentDidUpdate=function(t){var e,n,i=this.state.error,r=this.props.resetKeys;null===i||this.updatedWithError?null!==i&&o(t.resetKeys,r)&&(null==(e=(n=this.props).onResetKeysChange)||e.call(n,t.resetKeys,r),this.reset()):this.updatedWithError=!0},n.render=function(){var t=this.state.error,e=this.props,n=e.fallbackRender,r=e.FallbackComponent,a=e.fallback;if(null!==t){var o={error:t,resetErrorBoundary:this.resetErrorBoundary};if(i.isValidElement(a))return a;if("function"==typeof n)return n(o);if(r)return i.createElement(r,o);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},e}(i.Component);function u(t,e){var n=function(n){return i.createElement(l,e,i.createElement(t,n))},r=t.displayName||t.name||"Unknown";return n.displayName="withErrorBoundary("+r+")",n}function c(t){var e=i.useState(null),n=e[0],r=e[1];if(null!=t)throw t;if(null!=n)throw n;return r}t.ErrorBoundary=l,t.useErrorHandler=c,t.withErrorBoundary=u,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(92437))}}]);