"use strict";(self.webpackChunkseqr=self.webpackChunkseqr||[]).push([[79],{84079:(t,e,n)=>{function r(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function a(t,e){return fetch(t,e).then(r)}function o(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}n.d(e,{u:()=>De});var i,s,l=(1===(i=o).length&&(s=i,i=function(t,e){return o(s(t),e)}),{left:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var a=n+r>>>1;i(t[a],e)<0?n=a+1:r=a}return n},right:function(t,e,n,r){for(null==n&&(n=0),null==r&&(r=t.length);n<r;){var a=n+r>>>1;i(t[a],e)>0?r=a:n=a+1}return n}});const u=l.right;function c(t){return null===t?NaN:+t}function h(t,e){var n=function(t,e){var n,r,a=t.length,o=0,i=-1,s=0,l=0;if(null==e)for(;++i<a;)isNaN(n=c(t[i]))||(l+=(r=n-s)*(n-(s+=r/++o)));else for(;++i<a;)isNaN(n=c(e(t[i],i,t)))||(l+=(r=n-s)*(n-(s+=r/++o)));if(o>1)return l/(o-1)}(t,e);return n?Math.sqrt(n):n}function p(t,e){var n,r,a,o=t.length,i=-1;if(null==e){for(;++i<o;)if(null!=(n=t[i])&&n>=n)for(r=a=n;++i<o;)null!=(n=t[i])&&(r>n&&(r=n),a<n&&(a=n))}else for(;++i<o;)if(null!=(n=e(t[i],i,t))&&n>=n)for(r=a=n;++i<o;)null!=(n=e(t[i],i,t))&&(r>n&&(r=n),a<n&&(a=n));return[r,a]}var d=Array.prototype,f=(d.slice,d.map,Math.sqrt(50)),g=Math.sqrt(10),v=Math.sqrt(2);function m(t,e,n){var r=(e-t)/Math.max(0,n),a=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,a);return a>=0?(o>=f?10:o>=g?5:o>=v?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(o>=f?10:o>=g?5:o>=v?2:1)}function b(t,e){var n,r,a=t.length,o=-1;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<a;)null!=(n=t[o])&&n>r&&(r=n)}else for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<a;)null!=(n=e(t[o],o,t))&&n>r&&(r=n);return r}function x(t,e){var n,r=t.length,a=r,o=-1,i=0;if(null==e)for(;++o<r;)isNaN(n=c(t[o]))?--a:i+=n;else for(;++o<r;)isNaN(n=c(e(t[o],o,t)))?--a:i+=n;if(a)return i/a}function y(t,e,n){if(null==n&&(n=c),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,a=(r-1)*e,o=Math.floor(a),i=+n(t[o],o,t);return i+(+n(t[o+1],o+1,t)-i)*(a-o)}}function w(t,e){var n,r=t.length,a=-1,i=[];if(null==e)for(;++a<r;)isNaN(n=c(t[a]))||i.push(n);else for(;++a<r;)isNaN(n=c(e(t[a],a,t)))||i.push(n);return y(i.sort(o),.5)}function M(t,e){var n,r,a=t.length,o=-1;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n>=n)for(r=n;++o<a;)null!=(n=t[o])&&r>n&&(r=n)}else for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=n;++o<a;)null!=(n=e(t[o],o,t))&&r>n&&(r=n);return r}function $(t,e,n){t=+t,e=+e,n=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(a);++r<a;)o[r]=t+r*n;return o}var k=n(56070),S=n(5130);var T=n(6939);var _="$";function A(){}function I(t,e){var n=new A;if(t instanceof A)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,a=-1,o=t.length;if(null==e)for(;++a<o;)n.set(a,t[a]);else for(;++a<o;)n.set(e(r=t[a],a,t),r)}else if(t)for(var i in t)n.set(i,t[i]);return n}A.prototype=I.prototype={constructor:A,has:function(t){return _+t in this},get:function(t){return this[_+t]},set:function(t,e){return this[_+t]=e,this},remove:function(t){var e=_+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===_&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===_&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===_&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===_&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===_&&++t;return t},empty:function(){for(var t in this)if(t[0]===_)return!1;return!0},each:function(t){for(var e in this)e[0]===_&&t(this[e],e.slice(1),this)}};const O=I;function E(){var t,e,n,r=[],a=[];function o(n,a,i,s){if(a>=r.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var l,u,c,h=-1,p=n.length,d=r[a++],f=O(),g=i();++h<p;)(c=f.get(l=d(u=n[h])+""))?c.push(u):f.set(l,[u]);return f.each((function(t,e){s(g,e,o(t,a,i,s))})),g}function i(t,n){if(++n>r.length)return t;var o,s=a[n-1];return null!=e&&n>=r.length?o=t.entries():(o=[],t.each((function(t,e){o.push({key:e,values:i(t,n)})}))),null!=s?o.sort((function(t,e){return s(t.key,e.key)})):o}return n={object:function(t){return o(t,0,G,z)},map:function(t){return o(t,0,D,B)},entries:function(t){return i(o(t,0,D,B),0)},key:function(t){return r.push(t),n},sortKeys:function(t){return a[r.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}}function G(){return{}}function z(t,e,n){t[e]=n}function D(){return O()}function B(t,e,n){t.set(e,n)}function C(){}var N=O.prototype;function Z(t,e){var n=new C;if(t instanceof C)t.each((function(t){n.add(t)}));else if(t){var r=-1,a=t.length;if(null==e)for(;++r<a;)n.add(t[r]);else for(;++r<a;)n.add(e(t[r],r,t))}return n}C.prototype=Z.prototype={constructor:C,has:N.has,add:function(t){return this[_+(t+="")]=t,this},remove:N.remove,clear:N.clear,values:N.keys,size:N.size,empty:N.empty,each:N.each};function P(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var j=Array.prototype,V=j.map,F=j.slice,q={name:"implicit"};function R(){var t=O(),e=[],n=[],r=q;function a(a){var o=a+"",i=t.get(o);if(!i){if(r!==q)return r;t.set(o,i=e.push(a))}return n[(i-1)%n.length]}return a.domain=function(n){if(!arguments.length)return e.slice();e=[],t=O();for(var r,o,i=-1,s=n.length;++i<s;)t.has(o=(r=n[i])+"")||t.set(o,e.push(r));return a},a.range=function(t){return arguments.length?(n=F.call(t),a):n.slice()},a.unknown=function(t){return arguments.length?(r=t,a):r},a.copy=function(){return R(e,n).unknown(r)},P.apply(a,arguments),a}function H(){var t,e,n=R().unknown(void 0),r=n.domain,a=n.range,o=[0,1],i=!1,s=0,l=0,u=.5;function c(){var n=r().length,c=o[1]<o[0],h=o[c-0],p=o[1-c];t=(p-h)/Math.max(1,n-s+2*l),i&&(t=Math.floor(t)),h+=(p-h-t*(n-s))*u,e=t*(1-s),i&&(h=Math.round(h),e=Math.round(e));var d=$(n).map((function(e){return h+t*e}));return a(c?d.reverse():d)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),c()):r()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],c()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],i=!0,c()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(i=!!t,c()):i},n.padding=function(t){return arguments.length?(s=Math.min(1,l=+t),c()):s},n.paddingInner=function(t){return arguments.length?(s=Math.min(1,t),c()):s},n.paddingOuter=function(t){return arguments.length?(l=+t,c()):l},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},n.copy=function(){return H(r(),o).round(i).paddingInner(s).paddingOuter(l).align(u)},P.apply(c(),arguments)}var L=n(85959),X=n(54684);function Y(t,e){var n,r=e?e.length:0,a=t?Math.min(r,t.length):0,o=new Array(a),i=new Array(r);for(n=0;n<a;++n)o[n]=et(t[n],e[n]);for(;n<r;++n)i[n]=e[n];return function(t){for(n=0;n<a;++n)i[n]=o[n](t);return i}}function K(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}var W=n(30017);function U(t,e){var n,r={},a={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=et(t[n],e[n]):a[n]=e[n];return function(t){for(n in r)a[n]=r[n](t);return a}}var J=n(70906),Q=n(93934);function tt(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,a=e.slice();return function(o){for(n=0;n<r;++n)a[n]=t[n]*(1-o)+e[n]*o;return a}}function et(t,e){var n,r,a=typeof e;return null==e||"boolean"===a?(0,Q.Z)(e):("number"===a?W.Z:"string"===a?(n=(0,L.ZP)(e))?(e=n,X.ZP):J.Z:e instanceof L.ZP?X.ZP:e instanceof Date?K:(r=e,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(e)?Y:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?U:W.Z:tt))(t,e)}function nt(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function rt(t){return+t}var at=[0,1];function ot(t){return t}function it(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function st(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function lt(t,e,n){var r=t[0],a=t[1],o=e[0],i=e[1];return a<r?(r=it(a,r),o=n(i,o)):(r=it(r,a),o=n(o,i)),function(t){return o(r(t))}}function ut(t,e,n){var r=Math.min(t.length,e.length)-1,a=new Array(r),o=new Array(r),i=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++i<r;)a[i]=it(t[i],t[i+1]),o[i]=n(e[i],e[i+1]);return function(e){var n=u(t,e,1,r)-1;return o[n](a[n](e))}}function ct(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ht(t,e){return function(){var t,e,n,r,a,o,i=at,s=at,l=et,u=ot;function c(){return r=Math.min(i.length,s.length)>2?ut:lt,a=o=null,h}function h(e){return isNaN(e=+e)?n:(a||(a=r(i.map(t),s,l)))(t(u(e)))}return h.invert=function(n){return u(e((o||(o=r(s,i.map(t),W.Z)))(n)))},h.domain=function(t){return arguments.length?(i=V.call(t,rt),u===ot||(u=st(i)),c()):i.slice()},h.range=function(t){return arguments.length?(s=F.call(t),c()):s.slice()},h.rangeRound=function(t){return s=F.call(t),l=nt,c()},h.clamp=function(t){return arguments.length?(u=t?st(i):ot,h):u!==ot},h.interpolate=function(t){return arguments.length?(l=t,c()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,c()}}()(t,e)}var pt,dt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ft(t){if(!(e=dt.exec(t)))throw new Error("invalid format: "+t);var e;return new gt({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function gt(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function vt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function mt(t){return(t=vt(Math.abs(t)))?t[1]:NaN}function bt(t,e){var n=vt(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}ft.prototype=gt.prototype,gt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const xt={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return bt(100*t,e)},r:bt,s:function(t,e){var n=vt(t,e);if(!n)return t+"";var r=n[0],a=n[1],o=a-(pt=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+vt(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function yt(t){return t}var wt,Mt,$t,kt=Array.prototype.map,St=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function Tt(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?yt:(e=kt.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var a=t.length,o=[],i=0,s=e[0],l=0;a>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(t.substring(a-=s,a+s)),!((l+=s+1)>r));)s=e[i=(i+1)%e.length];return o.reverse().join(n)}),a=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",i=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?yt:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(kt.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=ft(t)).fill,n=t.align,h=t.sign,p=t.symbol,d=t.zero,f=t.width,g=t.comma,v=t.precision,m=t.trim,b=t.type;"n"===b?(g=!0,b="g"):xt[b]||(void 0===v&&(v=12),m=!0,b="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var x="$"===p?a:"#"===p&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",y="$"===p?o:/[%p]/.test(b)?l:"",w=xt[b],M=/[defgprs%]/.test(b);function $(t){var a,o,l,p=x,$=y;if("c"===b)$=w(t)+$,t="";else{var k=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:w(Math.abs(t),v),m&&(t=function(t){t:for(var e,n=t.length,r=1,a=-1;r<n;++r)switch(t[r]){case".":a=e=r;break;case"0":0===a&&(a=r),e=r;break;default:if(!+t[r])break t;a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(e+1):t}(t)),k&&0==+t&&"+"!==h&&(k=!1),p=(k?"("===h?h:u:"-"===h||"("===h?"":h)+p,$=("s"===b?St[8+pt/3]:"")+$+(k&&"("===h?")":""),M)for(a=-1,o=t.length;++a<o;)if(48>(l=t.charCodeAt(a))||l>57){$=(46===l?i+t.slice(a+1):t.slice(a))+$,t=t.slice(0,a);break}}g&&!d&&(t=r(t,1/0));var S=p.length+t.length+$.length,T=S<f?new Array(f-S+1).join(e):"";switch(g&&d&&(t=r(T+t,T.length?f-$.length:1/0),T=""),n){case"<":t=p+t+$+T;break;case"=":t=p+T+t+$;break;case"^":t=T.slice(0,S=T.length>>1)+p+t+$+T.slice(S);break;default:t=T+p+t+$}return s(t)}return v=void 0===v?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),$.toString=function(){return t+""},$}return{format:h,formatPrefix:function(t,e){var n=h(((t=ft(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(mt(e)/3))),a=Math.pow(10,-r),o=St[8+r/3];return function(t){return n(a*t)+o}}}}function _t(t,e,n,r){var a,o=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/a;return o>=f?a*=10:o>=g?a*=5:o>=v&&(a*=2),e<t?-a:a}(t,e,n);switch((r=ft(null==r?",f":r)).type){case"s":var i=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(a=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(mt(e)/3)))-mt(Math.abs(t)))}(o,i))||(r.precision=a),$t(r,i);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,mt(e)-mt(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=function(t){return Math.max(0,-mt(Math.abs(t)))}(o))||(r.precision=a-2*("%"===r.type))}return Mt(r)}function At(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,a,o,i,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(a=t,t=e,e=a),0===(i=m(t,e,n))||!isFinite(i))return[];if(i>0)for(t=Math.ceil(t/i),e=Math.floor(e/i),o=new Array(a=Math.ceil(e-t+1));++s<a;)o[s]=(t+s)*i;else for(t=Math.floor(t*i),e=Math.ceil(e*i),o=new Array(a=Math.ceil(t-e+1));++s<a;)o[s]=(t-s)/i;return r&&o.reverse(),o}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return _t(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,a=e(),o=0,i=a.length-1,s=a[o],l=a[i];return l<s&&(r=s,s=l,l=r,r=o,o=i,i=r),(r=m(s,l,n))>0?r=m(s=Math.floor(s/r)*r,l=Math.ceil(l/r)*r,n):r<0&&(r=m(s=Math.ceil(s*r)/r,l=Math.floor(l*r)/r,n)),r>0?(a[o]=Math.floor(s/r)*r,a[i]=Math.ceil(l/r)*r,e(a)):r<0&&(a[o]=Math.ceil(s*r)/r,a[i]=Math.floor(l*r)/r,e(a)),t},t}function It(){var t=ht(ot,ot);return t.copy=function(){return ct(t,It())},P.apply(t,arguments),At(t)}wt=Tt({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Mt=wt.format,$t=wt.formatPrefix;var Ot=n(45902),Et=Array.prototype.slice;function Gt(t){return t}var zt=1e-6;function Dt(t){return"translate("+(t+.5)+",0)"}function Bt(t){return"translate(0,"+(t+.5)+")"}function Ct(t){return function(e){return+t(e)}}function Nt(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function Zt(){return!this.__axis}function Pt(t,e){var n=[],r=null,a=null,o=6,i=6,s=3,l=1===t||4===t?-1:1,u=4===t||2===t?"x":"y",c=1===t||3===t?Dt:Bt;function h(h){var p=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,d=null==a?e.tickFormat?e.tickFormat.apply(e,n):Gt:a,f=Math.max(o,0)+s,g=e.range(),v=+g[0]+.5,m=+g[g.length-1]+.5,b=(e.bandwidth?Nt:Ct)(e.copy()),x=h.selection?h.selection():h,y=x.selectAll(".domain").data([null]),w=x.selectAll(".tick").data(p,e).order(),M=w.exit(),$=w.enter().append("g").attr("class","tick"),k=w.select("line"),S=w.select("text");y=y.merge(y.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),w=w.merge($),k=k.merge($.append("line").attr("stroke","currentColor").attr(u+"2",l*o)),S=S.merge($.append("text").attr("fill","currentColor").attr(u,l*f).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),h!==x&&(y=y.transition(h),w=w.transition(h),k=k.transition(h),S=S.transition(h),M=M.transition(h).attr("opacity",zt).attr("transform",(function(t){return isFinite(t=b(t))?c(t):this.getAttribute("transform")})),$.attr("opacity",zt).attr("transform",(function(t){var e=this.parentNode.__axis;return c(e&&isFinite(e=e(t))?e:b(t))}))),M.remove(),y.attr("d",4===t||2==t?i?"M"+l*i+","+v+"H0.5V"+m+"H"+l*i:"M0.5,"+v+"V"+m:i?"M"+v+","+l*i+"V0.5H"+m+"V"+l*i:"M"+v+",0.5H"+m),w.attr("opacity",1).attr("transform",(function(t){return c(b(t))})),k.attr(u+"2",l*o),S.attr(u,l*f).text(d),x.filter(Zt).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),x.each((function(){this.__axis=b}))}return h.scale=function(t){return arguments.length?(e=t,h):e},h.ticks=function(){return n=Et.call(arguments),h},h.tickArguments=function(t){return arguments.length?(n=null==t?[]:Et.call(t),h):n.slice()},h.tickValues=function(t){return arguments.length?(r=null==t?null:Et.call(t),h):r&&r.slice()},h.tickFormat=function(t){return arguments.length?(a=t,h):a},h.tickSize=function(t){return arguments.length?(o=i=+t,h):o},h.tickSizeInner=function(t){return arguments.length?(o=+t,h):o},h.tickSizeOuter=function(t){return arguments.length?(i=+t,h):i},h.tickPadding=function(t){return arguments.length?(s=+t,h):s},h}function jt(t){return Pt(3,t)}var Vt=n(42274),Ft=n(3839);function qt(){Vt.B.preventDefault(),Vt.B.stopImmediatePropagation()}function Rt(t){var e=t.document.documentElement,n=(0,S.Z)(t).on("dragstart.drag",qt,!0);"onselectstart"in e?n.on("selectstart.drag",qt,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ht(t,e){var n=t.document.documentElement,r=(0,S.Z)(t).on("dragstart.drag",null);e&&(r.on("click.drag",qt,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Lt=n(92992),Xt=n(69607),Yt=n(47306);function Kt(t){return function(){return t}}function Wt(t,e,n){this.target=t,this.type=e,this.selection=n}function Ut(){Vt.B.stopImmediatePropagation()}function Jt(){Vt.B.preventDefault(),Vt.B.stopImmediatePropagation()}var Qt={name:"drag"},te={name:"space"},ee={name:"handle"},ne={name:"center"};function re(t){return[+t[0],+t[1]]}function ae(t){return[re(t[0]),re(t[1])]}function oe(t){return function(e){return(0,Lt.Z)(e,Vt.B.touches,t)}}var ie={name:"x",handles:["w","e"].map(fe),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},se={name:"y",handles:["n","s"].map(fe),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},le={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(fe),input:function(t){return null==t?null:ae(t)},output:function(t){return t}},ue={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},ce={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},he={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},pe={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},de={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function fe(t){return{type:t}}function ge(){return!Vt.B.ctrlKey&&!Vt.B.button}function ve(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function me(){return navigator.maxTouchPoints||"ontouchstart"in this}function be(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function xe(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function ye(t){var e,n=ve,r=ge,a=me,o=!0,i=(0,Ft.Z)("start","brush","end"),s=6;function l(e){var n=e.property("__brush",g).selectAll(".overlay").data([fe("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",ue.overlay).merge(n).each((function(){var t=be(this).extent;(0,S.Z)(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([fe("selection")]).enter().append("rect").attr("class","selection").attr("cursor",ue.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return ue[t.type]})),e.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",p).filter(a).on("touchstart.brush",p).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",f).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function u(){var t=(0,S.Z)(this),e=be(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-s/2:e[0][0]-s/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-s/2:e[0][1]-s/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+s:s})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+s:s}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function c(t,e,n){var r=t.__brush.emitter;return!r||n&&r.clean?new h(t,e,n):r}function h(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function p(){if((!e||Vt.B.touches)&&r.apply(this,arguments)){var n,a,i,s,l,h,p,d,f,g,v,m=this,b=Vt.B.target.__data__.type,x="selection"===(o&&Vt.B.metaKey?b="overlay":b)?Qt:o&&Vt.B.altKey?ne:ee,y=t===se?null:pe[b],w=t===ie?null:de[b],M=be(m),$=M.extent,k=M.selection,T=$[0][0],_=$[0][1],A=$[1][0],I=$[1][1],O=0,E=0,G=y&&w&&o&&Vt.B.shiftKey,z=Vt.B.touches?oe(Vt.B.changedTouches[0].identifier):Xt.Z,D=z(m),B=D,C=c(m,arguments,!0).beforestart();"overlay"===b?(k&&(f=!0),M.selection=k=[[n=t===se?T:D[0],i=t===ie?_:D[1]],[l=t===se?A:n,p=t===ie?I:i]]):(n=k[0][0],i=k[0][1],l=k[1][0],p=k[1][1]),a=n,s=i,h=l,d=p;var N=(0,S.Z)(m).attr("pointer-events","none"),Z=N.selectAll(".overlay").attr("cursor",ue[b]);if(Vt.B.touches)C.moved=j,C.ended=F;else{var P=(0,S.Z)(Vt.B.view).on("mousemove.brush",j,!0).on("mouseup.brush",F,!0);o&&P.on("keydown.brush",q,!0).on("keyup.brush",R,!0),Rt(Vt.B.view)}Ut(),(0,Yt.e1)(m),u.call(m),C.start()}function j(){var t=z(m);!G||g||v||(Math.abs(t[0]-B[0])>Math.abs(t[1]-B[1])?v=!0:g=!0),B=t,f=!0,Jt(),V()}function V(){var t;switch(O=B[0]-D[0],E=B[1]-D[1],x){case te:case Qt:y&&(O=Math.max(T-n,Math.min(A-l,O)),a=n+O,h=l+O),w&&(E=Math.max(_-i,Math.min(I-p,E)),s=i+E,d=p+E);break;case ee:y<0?(O=Math.max(T-n,Math.min(A-n,O)),a=n+O,h=l):y>0&&(O=Math.max(T-l,Math.min(A-l,O)),a=n,h=l+O),w<0?(E=Math.max(_-i,Math.min(I-i,E)),s=i+E,d=p):w>0&&(E=Math.max(_-p,Math.min(I-p,E)),s=i,d=p+E);break;case ne:y&&(a=Math.max(T,Math.min(A,n-O*y)),h=Math.max(T,Math.min(A,l+O*y))),w&&(s=Math.max(_,Math.min(I,i-E*w)),d=Math.max(_,Math.min(I,p+E*w)))}h<a&&(y*=-1,t=n,n=l,l=t,t=a,a=h,h=t,b in ce&&Z.attr("cursor",ue[b=ce[b]])),d<s&&(w*=-1,t=i,i=p,p=t,t=s,s=d,d=t,b in he&&Z.attr("cursor",ue[b=he[b]])),M.selection&&(k=M.selection),g&&(a=k[0][0],h=k[1][0]),v&&(s=k[0][1],d=k[1][1]),k[0][0]===a&&k[0][1]===s&&k[1][0]===h&&k[1][1]===d||(M.selection=[[a,s],[h,d]],u.call(m),C.brush())}function F(){if(Ut(),Vt.B.touches){if(Vt.B.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else Ht(Vt.B.view,f),P.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);N.attr("pointer-events","all"),Z.attr("cursor",ue.overlay),M.selection&&(k=M.selection),xe(k)&&(M.selection=null,u.call(m)),C.end()}function q(){switch(Vt.B.keyCode){case 16:G=y&&w;break;case 18:x===ee&&(y&&(l=h-O*y,n=a+O*y),w&&(p=d-E*w,i=s+E*w),x=ne,V());break;case 32:x!==ee&&x!==ne||(y<0?l=h-O:y>0&&(n=a-O),w<0?p=d-E:w>0&&(i=s-E),x=te,Z.attr("cursor",ue.selection),V());break;default:return}Jt()}function R(){switch(Vt.B.keyCode){case 16:G&&(g=v=G=!1,V());break;case 18:x===ne&&(y<0?l=h:y>0&&(n=a),w<0?p=d:w>0&&(i=s),x=ee,V());break;case 32:x===te&&(Vt.B.altKey?(y&&(l=h-O*y,n=a+O*y),w&&(p=d-E*w,i=s+E*w),x=ne):(y<0?l=h:y>0&&(n=a),w<0?p=d:w>0&&(i=s),x=ee),Z.attr("cursor",ue[b]),V());break;default:return}Jt()}}function d(){c(this,arguments).moved()}function f(){c(this,arguments).ended()}function g(){var e=this.__brush||{selection:null};return e.extent=ae(n.apply(this,arguments)),e.dim=t,e}return l.move=function(e,n){e.selection?e.on("start.brush",(function(){c(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){c(this,arguments).end()})).tween("brush",(function(){var e=this,r=e.__brush,a=c(e,arguments),o=r.selection,i=t.input("function"==typeof n?n.apply(this,arguments):n,r.extent),s=et(o,i);function l(t){r.selection=1===t&&null===i?null:s(t),u.call(e),a.brush()}return null!==o&&null!==i?l:l(1)})):e.each((function(){var e=this,r=arguments,a=e.__brush,o=t.input("function"==typeof n?n.apply(e,r):n,a.extent),i=c(e,r).beforestart();(0,Yt.e1)(e),a.selection=null===o?null:o,u.call(e),i.start().brush().end()}))},l.clear=function(t){l.move(t,null)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){(0,Vt._H)(new Wt(l,e,t.output(this.state.selection)),i.apply,i,[e,this.that,this.args])}},l.extent=function(t){return arguments.length?(n="function"==typeof t?t:Kt(ae(t)),l):n},l.filter=function(t){return arguments.length?(r="function"==typeof t?t:Kt(!!t),l):r},l.touchable=function(t){return arguments.length?(a="function"==typeof t?t:Kt(!!t),l):a},l.handleSize=function(t){return arguments.length?(s=+t,l):s},l.keyModifiers=function(t){return arguments.length?(o=!!t,l):o},l.on=function(){var t=i.on.apply(i,arguments);return t===i?l:t},l}function we(){return Math.random()}(function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n})(we);const Me=function t(e){function n(t,n){var r,a;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*e()-1,o=2*e()-1,a=r*r+o*o}while(!a||a>1);return t+n*o*Math.sqrt(-2*Math.log(a)/a)}}return n.source=t,n}(we),$e=(function t(e){function n(){var t=Me.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(we),function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(we)),ke=(function t(e){function n(t){var n=$e.source(e)(t);return function(){return n()/t}}return n.source=t,n}(we),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(we),function(t){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*t*t)}),Se=function(t){let e=(y(t,.75)-y(t,.25))/1.34;return 1.06*Math.min(h(t),e)*Math.pow(t.length,-.2)};class Te{constructor(t,e=!1,n=30,r=-40,a=100){this.id=t,this.verbose=e,this.offsetX=n,this.offsetY=r,this.duration=a}show(t){this.verbose&&console.log(t),this.edit(t),this.move(),(0,S.Z)("#"+this.id).style("display","inline").transition().duration(this.duration).style("opacity",1)}hide(){(0,S.Z)("#"+this.id).transition().duration(this.duration).style("opacity",0),this.edit("")}move(t=Vt.B.pageX,e=Vt.B.pageY){this.verbose&&(console.log(t),console.log(e)),t+=this.offsetX,e=e+this.offsetY<0?10:e+this.offsetY;(0,S.Z)("#"+this.id).style("left",`${t}px`).style("top",`${e}px`)}edit(t){(0,S.Z)("#"+this.id).html(t)}}var _e=n(6939);function Ae(t){for(var e="",n=document.styleSheets,r=0;r<n.length;r++)try{if(null==n[r].cssRules)continue;for(var a=n[r].cssRules,o=0;o<a.length;o++){var i=a[o];if(void 0!==i.style){var s,l=void 0===i.selectorText?i.selectorText:i.selectorText.replace(`#${t[0].id} `,"");try{s=_e(t).find(l)}catch(t){s=[]}s.length>0&&(e+=i.selectorText+" { "+i.style.cssText+" }\n")}}}catch(t){if("SecurityError"!==t.name)throw t;continue}var u=document.createElement("style");return u.setAttribute("type","text/css"),u.innerHTML="<![CDATA[\n"+e+"\n]]>",u}var Ie=n(6939);class Oe{constructor(t,e,n=!1){Ie(`#${t}`).show();const r=n?"btn-group-vertical btn-group-sm":"btn-group btn-group-sm";this.bar=Ie("<div/>").addClass(r).appendTo(`#${t}`),this.buttons={},this.tooltip=e}createDownloadSvgButton(t,e,n,r,a="fa-download"){this.createButton(t,a);(0,S.Z)(`#${t}`).on("click",(()=>{this.downloadSvg(e,n,r)})).on("mouseover",(()=>{this.tooltip.show("Download")})).on("mouseout",(()=>{this.tooltip.hide()}))}createResetButton(t,e,n="fa-expand-arrows-alt"){this.createButton(t,n);(0,S.Z)(`#${t}`).on("click",e).on("mouseover",(()=>{this.tooltip.show("Reset the scales")})).on("mouseout",(()=>{this.tooltip.hide()}))}createButton(t,e="fa-download"){const n=Ie("<a/>").attr("id",t).addClass("btn btn-default").appendTo(this.bar);return Ie("<i/>").addClass(`fa ${e}`).appendTo(n),this.buttons[t]=n,n}attachTooltip(t){this.tooltip=t}downloadSvg(t,e,n){let r=Ie(Ie(Ie(""+("#"+t)))[0]),a=r.clone().attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg"),o=Ae(r.get());a.prepend(o),Ie("#"+n).html("").hide();let i=Ie(`#${n}`).append(a).html(),s=new Blob([i],{type:"image/svg+xml"});saveAs(s,e),Ie(`#${n}`).html("").hide()}}var Ee=n(6939);class Ge{constructor(t,e={}){this._sanityCheck(t),this.data=t,this.groupInfo=e,this.toolbar=void 0,this.tooltip=void 0}render(t,e=500,n=357,r=.05,a,i=[-3,3],s="Y axis",l=!0,u=30,c=!0,h=0,d=!1,f=!1,g=!1,v=!1,m=!1,b=!1,x=0){if(this.reset=()=>{t.selectAll("*").remove(),this.render(t,e,n,r,a,i,s,l,u,c,h,d,f,g,v,m,b)},this.updateYScale=function(o,i){t.selectAll("*").remove(),void 0===i&&(i=[]),this.render(t,e,n,r,a,[],o,l,u,c,h,d,f,g,v,m,b)},this.updateXScale=function(a){void 0===a&&console.error("updateXScale called without new X domain"),t.selectAll("*").remove(),this.render(t,e,n,r,a,[],s,l,u,c,h,d,f,g,v,m,b)},void 0===i||0==i.length){let t=[];this.data.forEach((e=>t=t.concat(e.values))),i=p(t)}this.groups=E().key((t=>t.group)).entries(this.data),this.scale={x:H().rangeRound([0,e]).domain(a||this.groups.map((t=>t.key))).paddingInner(r),subx:H(),y:It().rangeRound([n,0]).domain(i),z:It()},this.groups.forEach((e=>{let r=e.key,a=e.values,s=this.groupInfo[r];if(e.index=this.scale.x.domain().indexOf(r),void 0!==s){t.append("g").selectAll(".violin-group-label").data(["pvalue"]).enter().append("text").attr("x",0).attr("y",0).attr("class","violin-group-label").attr("text-anchor","center").attr("fill",(t=>"pvalue"==t&&parseFloat(s[t])<=parseFloat(s.pvalueThreshold)?"orangered":"SlateGray")).attr("transform",((t,e)=>`translate(${this.scale.x(r)+this.scale.x.bandwidth()/2}, ${this.scale.y(i[0])+50})`)).text((t=>`${t}: ${parseFloat(parseFloat(s[t]).toPrecision(3)).toExponential()}`))}m&&a.sort(((t,e)=>t.label<e.label?-1:t.label>e.label?1:0)),this.scale.subx.domain(a.map((t=>t.label))).rangeRound([this.scale.x(r),this.scale.x(r)+this.scale.x.bandwidth()]),a.forEach((n=>{0!=n.values.length&&(n.values=n.values.sort(o),this._drawViolin(t,n,d,e.index,b,x))}));var l=18;if(v){const e=H().domain(a.map((t=>null==t.size?"(0)":`(${t.size||0})`))).rangeRound([this.scale.x(r),this.scale.x(r)+this.scale.x.bandwidth()]);t.append("g").attr("class","violin-size-axis").attr("transform",`translate(0, ${n+l})`).call(jt(e))}if(c){l=5;const e=t.append("g").attr("class","violin-sub-axis").attr("transform",`translate(0, ${n+l})`).call(jt(this.scale.subx));h>0&&e.selectAll("text").attr("text-anchor","start").attr("transform",`rotate(${h}, 2, 10)`)}}));let y=c?55:0;var w;if(this.xAxis=l?jt(this.scale.x):jt(this.scale.x).tickFormat(""),t.append("g").attr("class","violin-x-axis axis--x").attr("transform",`translate(0, ${n+y})`).call(this.xAxis).selectAll("text").attr("text-anchor","start").attr("transform",`rotate(${u}, -10, 10)`),y=5,this.yAxis=(w=this.scale.y,Pt(4,w)).tickValues(this.scale.y.ticks(5)),t.append("g").attr("class","violin-y-axis axis--y").attr("transform",`translate(-${y}, 0)`).call(this.yAxis),t.append("text").attr("class","violin-axis-label").attr("text-anchor","middle").attr("transform",`translate(-${2*y+(0,S.Z)(".violin-y-axis").node().getBBox().width}, ${this.scale.y.range()[0]+(this.scale.y.range()[1]-this.scale.y.range()[0])/2}) rotate(-90)`).text(s),t.on("mouseout",(()=>{void 0!==this.tooltip&&this.tooltip.hide()})),f&&this._addGroupDivider(t),g){const e=t.append("g").attr("id","violinLegend").attr("transform","translate(0, 0)");e.append("rect").attr("x",this.scale.x.range()[0]).attr("y",-35).attr("width",60*this.groups[0].values.length+10).attr("height",24).style("fill","none").style("stroke","silver");const n=e.selectAll(".violin-legend").data(this.groups[0].values).enter().append("g").classed("violin-legend",!0),r=10;n.append("rect").attr("x",((t,e)=>5+60*e+this.scale.x.range()[0])).attr("y",-28).attr("width",r).attr("height",r).style("fill",(t=>t.color)),n.append("text").attr("class","violin-legend-text").text((t=>t.label)).attr("x",((t,e)=>17+60*e+this.scale.x.range()[0])).attr("y",-20)}}addPlotTitle(t,e){let n=(this.scale.x.range()[1]-this.scale.x.range()[0]+1)/2,r=this.scale.y.range()[1]-10;t.append("text").attr("class","violin-title").attr("text-anchor","middle").attr("transform",`translate(${n}, ${r})`).text(e)}createTooltip(t){return 0==Ee(`#${t}`).length&&Ee("<div/>").attr("id",t).appendTo(Ee("body")),this.tooltip=new Te(t),(0,S.Z)(`#${t}`).classed("violin-tooltip",!0),this.tooltip}createToolbar(t,e){return this.toolbar=new Oe(t,e),this.toolbar}addBrush(t){const e=ye(le);e.on("end",(()=>{this.zoom(t,e)})),t.append("g").attr("class","brush").call(e)}zoom(t,e){let n,r=Vt.B.selection;if(void 0===e)this.reset();else if(r){this.scale.x.domain(this.scale.x.domain().filter(((t,e)=>{const n=Math.floor(r[0][0]/this.scale.x.bandwidth()),a=Math.floor(r[1][0]/this.scale.x.bandwidth());return e>=n&&e<=a})));const n=Math.floor(this.scale.y.invert(r[1][1])),a=Math.floor(this.scale.y.invert(r[0][1]));this.scale.y.domain([n,a]),t.select(".brush").call(e.move,null)}else{if(!n)return n=setTimeout((function(){n=null}),350);this.reset()}let a=t.transition().duration(750);t.select(".axis--x").transition(a).call(this.xAxis),t.select(".axis--y").transition(a).call(this.yAxis),this.groups.forEach(((e,n)=>{let r=e.key,o=e.values;this.scale.subx.rangeRound([this.scale.x(r),this.scale.x(r)+this.scale.x.bandwidth()]),o.forEach((n=>{if(0==n.values.length)return;this.scale.x.domain().indexOf(r);this.scale.z.range([this.scale.subx(n.label),this.scale.subx(n.label)+this.scale.subx.bandwidth()]);const o=t.select(`#violin${e.index}-${n.label}`);o.select(".violin").transition(a).attr("d",(0,Ot.Z)().x0((t=>this.scale.z(t[1]))).x1((t=>this.scale.z(-t[1]))).y((t=>this.scale.y(t[0]))));const i=y(n.values,.25),s=y(n.values,.75),l=.1;o.select(".violin-ir").transition(a).attr("x",this.scale.z(-l)).attr("y",this.scale.y(s)).attr("width",Math.abs(this.scale.z(-l)-this.scale.z(l))).attr("height",Math.abs(this.scale.y(s)-this.scale.y(i)));const u=w(n.values);o.select(".violin-median").transition(a).attr("x1",this.scale.z(-l)).attr("x2",this.scale.z(l)).attr("y1",this.scale.y(u)).attr("y2",this.scale.y(u))}))}))}_drawViolin(t,e,n,r,a,o){let i=function(t,e,n){return function(r){return e.map((e=>[e,x(r,(r=>t((e-r)/n)))/n]))}}(ke,this.scale.y.ticks(100),Se(e.values));const s=p(e.values),l=i(e.values).filter((t=>t[0]>=s[0]&&t[0]<=s[1])),u=t.append("g").attr("id",`violin${r}-${e.label}`).attr("class","violin-g").datum(e);if(e.values.length>=o&&l.length&&this._validVertices(l)){let o=b(l,(t=>Math.abs(t[1])));this.scale.z.domain([-o,o]).range([this.scale.subx(e.label),this.scale.subx(e.label)+this.scale.subx.bandwidth()]);let i=(0,Ot.Z)().x0((t=>this.scale.z(t[1]))).x1((t=>this.scale.z(-t[1]))).y((t=>this.scale.y(t[0])));const s=u.append("path").datum(l).attr("d",i).classed("violin",!0).style("fill",(()=>void 0!==e.color?e.color:r%2==0?"#90c1c1":"#94a8b8")),c=y(e.values,.25),h=y(e.values,.75),p=this.scale.z.domain()[1]/3;if(n){const n=Math.abs(h-c),r=b(e.values.filter((t=>t<=h+1.5*n))),a=M(e.values.filter((t=>t>=c-1.5*n)));t.append("line").classed("whisker",!0).attr("x1",this.scale.z(0)).attr("x2",this.scale.z(0)).attr("y1",this.scale.y(r)).attr("y2",this.scale.y(a)).style("stroke","#fff")}u.append("rect").attr("x",this.scale.z(-p)).attr("y",this.scale.y(h)).attr("width",Math.abs(this.scale.z(-p)-this.scale.z(p))).attr("height",Math.abs(this.scale.y(h)-this.scale.y(c))).attr("class","violin-ir");const d=w(e.values);if(u.append("line").attr("x1",this.scale.z(-p)).attr("x2",this.scale.z(p)).attr("y1",this.scale.y(d)).attr("y2",this.scale.y(d)).attr("class","violin-median"),a){let t=Me(0,p/2);const n=Math.abs(h-c),r=b(e.values.filter((t=>t<=h+1.5*n))),a=M(e.values.filter((t=>t>=c-1.5*n))),o=e.values.filter((t=>t<a||t>r));u.append("g").attr("class","violin-outliers").selectAll("circle").data(o).enter().append("circle").attr("cx",(()=>this.scale.z(t()))).attr("cy",(t=>this.scale.y(t))).attr("r",2)}u.on("mouseover",(()=>{s.classed("highlighted",!0),void 0===this.tooltip?console.warn("GroupViolin Warning: tooltip not defined"):this.tooltip.show(e.group+"<br/>"+e.label+"<br/>Median: "+d.toPrecision(4)+"<br/>")})),u.on("mouseout",(()=>{s.classed("highlighted",!1)}))}else if(o){let t=b(e.values,(t=>Math.abs(t)));this.scale.z.domain([-t,t]).range([this.scale.subx(e.label),this.scale.subx(e.label)+this.scale.subx.bandwidth()]);const n=this.scale.z.domain()[1]/3;let r=Me(0,n/2);u.append("g").attr("class","violin-points").selectAll("circle").data(e.values).enter().append("circle").attr("cx",(()=>this.scale.z(r()))).attr("cy",(t=>this.scale.y(t))).attr("r",2)}}_sanityCheck(t){const e=["group","label","values"];t.forEach((t=>{e.forEach((e=>{if(void 0===t[e])throw"GroupedViolin: input data error."}))}))}_addGroupDivider(t){const e=this.scale.x.domain(),n=Math.abs(this.scale.x(this.scale.x.domain()[1])-this.scale.x(this.scale.x.domain()[0])-this.scale.x.bandwidth()),r=(t,r)=>r!==e.length-1?this.scale.x(t)+ +this.scale.x.bandwidth()+n/2:0;t.selectAll(".vline").data(e).enter().append("line").classed("vline",!0).attr("x1",r).attr("x2",r).attr("y1",this.scale.y.range()[0]).attr("y2",this.scale.y.range()[1]).style("stroke-width",((t,n)=>n!=e.length-1?1:0)).style("stroke","rgb(86,98,107)").style("opacity",.5)}_validVertices(t){return!t.reduce(((t,e)=>t.concat(e)),[]).filter((t=>isNaN(t))).length}}var ze=n(6939);function De(t,e,n,r="Gene Expression Violin Plot",o=function(){const t="https://gtexportal.org/rest/v1/";return{singleTissueEqtl:t+"association/singleTissueEqtl?format=json&datasetId=gtex_v7&gencodeId=",ld:t+"dataset/ld?format=json&datasetId=gtex_v7&gencodeId=",dyneqtl:t+"association/dyneqtl",snp:t+"reference/variant?format=json&snpId=",variantId:t+"dataset/variant?format=json&variantId=",exonExp:t+"expression/medianExonExpression?datasetId=gtex_v7&hcluster=true&gencodeId=",transcriptExp:t+"expression/medianTranscriptExpression?datasetId=gtex_v7&hcluster=true&gencodeId=",junctionExp:t+"expression/medianJunctionExpression?datasetId=gtex_v7&hcluster=true&gencodeId=",transcript:t+"reference/transcript?datasetId=gtex_v7&gencodeId=",exon:t+"reference/exon?datasetId=gtex_v7&gencodeId=",geneModel:t+"dataset/collapsedGeneModelExon?datasetId=gtex_v7&gencodeId=",geneModelUnfiltered:t+"dataset/fullCollapsedGeneModelExon?datasetId=gtex_v7&gencodeId=",geneExp:t+"expression/geneExpression?datasetId=gtex_v7&gencodeId=",medGeneExp:t+"expression/medianGeneExpression?datasetId=gtex_v7&hcluster=true&pageSize=10000",geneExpBoxplot:t+"expression/geneExpression?datasetId=gtex_v7&boxplotDetail=full&gencodeId=",topInTissueFiltered:t+"expression/topExpressedGene?datasetId=gtex_v7&filterMtGene=true&sortBy=median&sortDirection=desc&pageSize=50&tissueSiteDetailId=",topInTissue:t+"expression/topExpressedGene?datasetId=gtex_v7&sortBy=median&sortDirection=desc&pageSize=50&tissueSiteDetailId=",geneId:t+"reference/gene?format=json&gencodeVersion=v19&genomeBuild=GRCh37%2Fhg19&geneId=",tissue:t+"dataset/tissueInfo?format=json&datasetId=gtex_v7",sample:"tmpSummaryData/gtex.Sample.csv",rnaseqCram:"tmpSummaryData/rnaseq_cram_files_v7_dbGaP_011516.txt",wgsCram:"tmpSummaryData/wgs_cram_files_v7_hg38_dbGaP_011516.txt",fcBilling:"https://api.firecloud.org/api/profile/billing",fcWorkSpace:"https://api.firecloud.org/api/workspaces",fcPortalWorkSpace:"https://portal.firecloud.org/#workspaces"}}(),i=Be(50,75,250,60),s={w:.8*window.innerWidth,h:250}){const l=[a(o.tissue,{credentials:"include"}),a(o.geneExp+n,{credentials:"include"}),a(o.geneExp+n+"&attributeSubset=sex",{credentials:"include"})],u={root:t,spinner:"spinner",svg:`${t}-svg`,tooltip:e,toolbar:`${t}-toolbar`,clone:`${t}-svg-clone`,buttons:{download:`${t}-download`,plotOptions:`${t}-option-modal`,filter:`${t}-filter`,ascAlphaSort:`${t}-asc-alphasort`,descAlphaSort:`${t}-desc-alphasort`,ascSort:`${t}-asc-sort`,descSort:`${t}-desc-sort`,logScale:`${t}-log-scale`,linearScale:`${t}-linear-scale`,noDiff:`${t}-no-diff`,sexDiff:`${t}-sex-diff`,outliersOn:`${t}-outliers-on`,outliersOff:`${t}-outliers-off`},plotOptionGroups:{scale:`${t}-option-scale`,sort:`${t}-option-sort`,differentiation:`${t}-option-differentiation`,outliers:`${t}-option-outlier`},plotSorts:{ascAlphaSort:"asc-alphasort",descAlphaSort:"desc-alphasort",ascSort:"asc-sort",descSort:"desc-sort"},tissueFilter:`${t}-filter-modal`};if(0==ze(`#${u.root}`).length)throw"Violin Plot Error: rootId does not exist.";0==ze(`#${u.tooltip}`).length&&ze("<div/>").attr("id",u.tooltip).appendTo(ze("body")),0==ze(`#${u.toolbar}`).length&&ze("<div/>").attr("id",u.toolbar).appendTo(ze(`#${u.root}`)),0==ze(`#${u.root} #${u.spinner}`).length?ze('<span><i id="spinner" class="fas fa-sync fa-spin"></i></span>').appendTo(ze(`#${u.root}`)):ze(`#${u.root} #${u.spinner}`).show(),0==ze(`#${u.clone}`).length&&ze("<div/>").attr("id",u.clone).appendTo(ze(`#${u.root}`)),Promise.all(l).then((function(t){const e=function(t){const e="tissueInfo";if(!t.hasOwnProperty(e))throw"Parsing Error: required json attr is missing: "+e;const n=t[e];return["tissueSiteDetailId","tissueSiteDetail","colorHex"].forEach((t=>{if(!n[0].hasOwnProperty(t))throw"Parsing Error: required json attr is missing: "+t})),n}(t[0]),a={},o={},l={female:"#e67f7b",male:"#70bcd2"};e.forEach((t=>{o[t.tissueSiteDetailId]=t.tissueSiteDetail,a[t.tissueSiteDetail]=t,l[t.tissueSiteDetailId]=t.colorHex}));const c=Ne(t[1],o,l,!1);if(!c.length)return ze(`#${u.toolbar}`).remove(),ze(`<div id="gene-exp-vplot">No gene expression data found for ${n}</div>`).appendTo(`#${u.root}`),void ze(`#${u.root} #${u.spinner}`).hide();let h=new Ge(c),p=h.createTooltip(u.tooltip);h.sortData=h.data.map((t=>t)),h.allData=h.data.map((t=>t)),h.gencodeId=n,h.tIdNameMap=o,h.groupColorDict=l,h.tissueDict=a,h.geneJson={allData:t[1],subsetData:t[2]},h.unit=c.length>0?` ${c[0].unit}`:"",h.gpConfig={subset:!1,scale:"linear",sort:u.plotSorts.ascAlphaSort,showOutliers:!0,title:r},function(t,e,n,r){const a=e,o=function(t=1200,e=250,n=Be()){return{width:t,height:e,outerWidth:t+(n.left+n.right),outerHeight:e+(n.top+n.bottom)}}(n.w,n.h,a),i=(0,S.Z)(`#${r.root}`).append("svg").attr("id",r.svg).attr("width",o.outerWidth).attr("height",o.outerHeight).append("g").attr("transform",`translate(${a.left}, ${a.top})`),s=o.width,l=o.height,u=.2,c=Ve(t.gpConfig.sort,t.sortData,r),h=[],p="TPM",d=!0,f=35,g=!1,v=0,m=!1,b=!1,x=!0,y=!1,w=!0,M=!0;t.render(i,s,l,u,c,h,p,d,f,g,v,m,b,x,y,w,M),Pe(t,r)}(h,i,s,u),function(t,e,n,r){const a=function(t,e=!1){const n=["Bladder","Cervix_Ectocervix","Cervix_Endocervix","Fallopian_Tube","Kidney_Cortex"],r="tissueInfo";if(!t.hasOwnProperty(r))throw"Parsing Error: required json attribute is missing: "+r;let a=t[r];["tissueSite","tissueSiteDetailId","tissueSiteDetail"].forEach((t=>{if(!a[0].hasOwnProperty(t))throw`parseTissueSites attr error. ${t} is not found`})),a=0==e?a:a.filter((t=>!n.includes(t.tissueSiteDetailId)));let o=a.reduce(((t,e)=>{let n=e.tissueSite,r={id:e.tissueSiteDetailId,name:e.tissueSiteDetail};return t.hasOwnProperty(n)||(t[n]=[]),t[n].push(r),t}),{});return Object.keys(o).forEach((t=>{if(1==o[t].length){let e=o[t][0];delete o[t],o[e.name]=[e]}})),o}(r);(function(t,e,n=!1,r=!1,a=4){const o="tissue-group-main-level";(0,S.Z)(`#${e}`).selectAll("*").remove();const i=T("<div/>").attr("class","col-xs-12 col-md-12").appendTo(T(`#${e}`));n?T(`<label class=${o}><input type="radio" name="allTissues" value="reset"> Reset </label><br/>`).appendTo(i):T(`<label class=${o}><input type="radio" name="allTissues" value="all"> All </label> <label class=${o}><input type="radio" name="allTissues" value="reset"> Reset </label><br/>`).appendTo(i),T('input[name="allTissues"]').change((function(){switch(T(this).val()){case"all":T(".tissueGroup").prop("checked",!0),T(".tissueSubGroup").prop("checked",!0);break;case"reset":T(".tissueGroup").prop("checked",!1),T(".tissueSubGroup").prop("checked",!1)}}));let s=Object.keys(t).sort(((t,e)=>"Brain"==t?-1:"Brain"==e?1:t<e?-1:t>e?1:void 0)),l=Object.keys(t).reduce(((e,n)=>t[n].length>1?e+1+t[n].length:e+t[n].length),0),u=Math.ceil(l/a),c=l%a,h=Math.floor(12/a);const p=$(0,a).map((t=>T(`<div id="section${t}" class="col-xs-12 col-md-${h}">`).appendTo(T(`#${e}`))));let d=0,f=0;s.forEach((e=>{let n=t[e];const r=e.replace(/ /g,"_");let a=n.length;a=1==a?a:a+1,0!=d&&a+d>u+c&&(d=0,f+=1),d+=a;let i=p[f];T(`<label class=${o}><input type="checkbox" id="${r}" class="tissueGroup"> <span>${e}</span></label><br/>`).appendTo(i),n.length>1&&n.sort(((t,e)=>t.id>e.id?1:t.id<e.id?-1:0)).forEach((function(t,e){let r=T(`<label class=tissue-group-sub-level><input type="checkbox" id="${t.id}" class="tissueSubGroup"> <span>${t.name}</span></label><br/>`).appendTo(i);e==n.length-1&&r.addClass("last-site"),r.click((function(){T('input[name="allTissues"]').prop("checked",!1)}))})),T("#"+r).click((function(){T('input[name="allTissues"]').prop("checked",!1),T("#"+r).is(":checked")?n.forEach((function(t){"id"!=t.id&&T("#"+t.id).prop("checked",!0)})):n.forEach((function(t){"id"!=t.id&&T("#"+t.id).prop("checked",!1)}))}))})),r&&(T('input[name="allTissues"][value="all"]').prop("checked",!0),T(".tissueGroup").prop("checked",!0),T(".tissueSubGroup").prop("checked",!0))})(a,`${e}-body`,!1,!0,3),function(t,e,n,r){ze(`#${e}`).on("hidden.bs.modal",(a=>{let o=function(t,e,n=!1){let r=[];return T(`#${e}`).find(":input").each((function(){if(T(this).is(":checked")){const e=T(this).attr("id");if(T(this).hasClass("tissueGroup")){let a=e.replace(/_/g," ");1==t[a].length&&(n?r.push(t[a][0].name):r.push(t[a][0].id))}else n?r.push(T(T(this).siblings()[0]).text()):r.push(e)}})),r.filter((t=>void 0!==t))}(r,`${e}-body`,!0);!function(t,e,n){let r=t.allData.filter((t=>n.includes(t.group)));t.data=r,Fe(t,e)}(t,n,o)}))}(t,e,n,a)}(h,u.tissueFilter,u,t[0]),function(t,e,n,r){let a=t.createToolbar(n.toolbar,e);a.createDownloadSvgButton(n.buttons.download,n.svg,"gene-exp-plot.svg",n.clone),ze(`#${n.toolbar}`).addClass("row"),ze(`#${n.toolbar} .btn-group`).addClass("col-xs-12 col-lg-1 text-nowrap").css("display","flex"),ze("<div></div>").appendTo(`#${n.toolbar}`).attr("id",`${n.toolbar}-plot-options`).attr("class","col-lg-11 text-nowrap");let o=ze(`#${n.toolbar}-plot-options`);ze("<div/>").appendTo(o).attr("id",n.plotOptionGroups.differentiation).attr("class","col-lg-2 col-xl-2"),ze("<span/>").appendTo(`#${n.plotOptionGroups.differentiation}`).attr("class",`${n.root}-option-label`).html("Subset"),ze("<div/>").appendTo(`#${n.plotOptionGroups.differentiation}`).attr("class","btn-group btn-group-sm");let i=ze(`#${n.plotOptionGroups.differentiation} .btn-group`);ze(`<button class="btn btn-default" id="${n.buttons.noDiff}">None</button>`).appendTo(i),ze(`<button class="btn btn-default" id="${n.buttons.sexDiff}">Sex</button>`).appendTo(i),ze("<div/>").appendTo(o).attr("id",n.plotOptionGroups.scale).attr("class","col-lg-2 col-xl-2"),ze("<span/>").appendTo(`#${n.plotOptionGroups.scale}`).attr("class",`${n.root}-option-label`).html("Scale"),ze("<div/>").appendTo(`#${n.plotOptionGroups.scale}`).attr("class","btn-group btn-group-sm");let s=ze(`#${n.plotOptionGroups.scale} .btn-group`);ze(`<button class="btn btn-default" id="${n.buttons.logScale}">Log</button>`).appendTo(s),ze(`<button class="btn btn-default" id="${n.buttons.linearScale}">Linear</button>`).appendTo(s),ze("<div/>").appendTo(o).attr("class",`${n.plotOptionGroups.sort} col-lg-2 col-xl-2`).attr("id","vplot-alpha-sorts"),ze("<span/>").appendTo(`.${n.plotOptionGroups.sort}#vplot-alpha-sorts`).attr("class",`${n.root}-option-label`).html("Tissue Sort"),ze("<div/>").appendTo(`.${n.plotOptionGroups.sort}#vplot-alpha-sorts`).attr("class","btn-group btn-group-sm").attr("id",`${n.plotOptionGroups.sort}-alpha`);let l=ze(`#${n.plotOptionGroups.sort}-alpha.btn-group`);ze(`<button class="btn btn-default fa fa-caret-up" id="${n.buttons.ascAlphaSort}"></button>`).appendTo(l),ze(`<button class="btn btn-default fa fa-caret-down" id="${n.buttons.descAlphaSort}"></button>`).appendTo(l),ze("<div/>").appendTo(o).attr("class",`${n.plotOptionGroups.sort} col-lg-2 col-xl-2`).attr("id","vplot-num-sorts"),ze("<span/>").appendTo(`.${n.plotOptionGroups.sort}#vplot-num-sorts`).attr("class",`${n.root}-option-label`).html("Median Sort"),ze("<div/>").appendTo(`.${n.plotOptionGroups.sort}#vplot-num-sorts`).attr("class","btn-group btn-group-sm").attr("id",`${n.plotOptionGroups.sort}-num`);let u=ze(`#${n.plotOptionGroups.sort}-num.btn-group`);ze(`<button class="btn btn-default fa fa-caret-up" id="${n.buttons.ascSort}"></button>`).appendTo(u),ze(`<button class="btn btn-default fa fa-caret-down" id="${n.buttons.descSort}"></button>`).appendTo(u),ze("<div/>").appendTo(o).attr("id",n.plotOptionGroups.outliers).attr("class","col-lg-2 col-xl-2"),ze("<span/>").appendTo(`#${n.plotOptionGroups.outliers}`).attr("class",`${n.root}-option-label`).html("Outliers"),ze("<div/>").appendTo(`#${n.plotOptionGroups.outliers}`).attr("class","btn-group btn-group-sm");let c=ze(`#${n.plotOptionGroups.outliers} .btn-group`);ze(`<button class="btn btn-default" id="${n.buttons.outliersOn}">On</button>`).appendTo(c),ze(`<button class="btn btn-default" id="${n.buttons.outliersOff}">Off</button>`).appendTo(c),(0,k.Z)(`#${n.plotOptionsModal} .modal-body button`).classed("active",!1),(0,k.Z)(`#${n.buttons.ascAlphaSort},\n               #${n.buttons.linearScale},\n               #${n.buttons.noDiff},\n               #${n.buttons.outliersOn}`).classed("active",!0),a.createButton(n.buttons.filter,"fa-filter"),(0,S.Z)(`#${n.buttons.filter}`).on("mouseover",(()=>{a.tooltip.show("Filter Tissues")})).on("mouseout",(()=>{a.tooltip.hide()})).on("click",((t,e,n)=>{ze("#gene-expr-vplot-filter-modal").modal("show")})),ze(`.${n.plotOptionGroups.sort} button`).on("click",(function(e){let r=(0,S.Z)(this);r.classed("active")||((0,k.Z)(`.${n.plotOptionGroups.sort} button`).classed("active",!1),r.classed("active",!0),t.gpConfig.sort=e.target.id.replace(`${n.root}-`,""),Fe(t,n))})),ze(`#${n.plotOptionGroups.scale} button`).on("click",(function(e){let r=(0,S.Z)(this);r.classed("active")||((0,k.Z)(`#${n.plotOptionGroups.scale} button`).classed("active",!1),r.classed("active",!0),t.gpConfig.scale=e.target.id==n.buttons.logScale?"log":"linear",Fe(t,n))})),ze(`#${n.plotOptionGroups.outliers} button`).on("click",(function(e){let r=(0,S.Z)(this);r.classed("active")||((0,k.Z)(`#${n.plotOptionGroups.outliers} button`).classed("active",!1),r.classed("active",!0),t.gpConfig.showOutliers=e.target.id==n.buttons.outliersOn,je(t,n))})),ze(`#${n.plotOptionGroups.differentiation} button`).on("click",(function(e){let r=(0,S.Z)(this);r.classed("active")||((0,k.Z)(`#${n.plotOptionGroups.differentiation} button`).classed("active",!1),r.classed("active",!0),t.gpConfig.subset=e.target.id==n.buttons.sexDiff,Fe(t,n))}))}(h,p,u),ze(`#${u.root} #${u.spinner}`).hide()}))}function Be(t=50,e=50,n=50,r=50){return{top:t,right:e,bottom:n,left:r}}function Ce(t,e=!0){t.forEach((t=>{t.values=e?t.data.map((t=>Math.log10(+t+1))):t.data,t.values.sort(o),t.median=w(t.values)}))}function Ne(t,e,n,r=!0){const a="geneExpression";if(!t.hasOwnProperty(a))throw"Parse Error: required json attribute is missing: "+a;return t[a].forEach((t=>{["data","tissueSiteDetailId","geneSymbol","gencodeId"].forEach((e=>{if(!t.hasOwnProperty(e))throw console.error(t),"Parse Error: required json attribute is missing: "+e})),t.group=void 0===e?t.tissueSiteDetailId:e[t.tissueSiteDetailId],t.label=void 0===t.subsetGroup?t.geneSymbol:t.subsetGroup,t.color=void 0===n?"#90c1c1":void 0===t.subsetGroup?`#${n[t.tissueSiteDetailId]}`:n[t.subsetGroup]})),Ce(t[a],r),t[a]}function Ze(t){const e=t.select(".violin-x-axis");e.attr("transform",`${e.attr("transform")} translate(0, 3)`)}function Pe(t,e){let n=(0,S.Z)(`#${e.svg} g`);void 0!==t.gpConfig.title&&t.addPlotTitle(n,t.gpConfig.title),je(t,e),t.gpConfig.subset?function(t,e,n,r="top"){Ze(e);const a=e.selectAll(".violin-x-axis text");a.attr("transform",`translate(0, 8) ${a.attr("transform")}`),e.append("g").selectAll(".tcolor").data(t.scale.x.domain()).enter().append("rect").classed("tcolor",!0).attr("x",(e=>t.scale.x(e))).attr("y",(e=>"top"==r?t.scale.y.range()[1]:t.scale.y.range()[0])).attr("transform","translate(0, 14)").attr("width",(e=>t.scale.x.bandwidth())).attr("height",5).style("stroke-width",0).style("fill",(t=>`#${n[t].colorHex}`)).style("opacity",.9)}(t,n,t.tissueDict,"bottom"):((0,S.Z)(`#${e.svg} #violinLegend`).remove(),Ze(n)),function(t){(0,k.Z)(".violin-g").on("mouseover",((e,n,r)=>{let a="log"==t.gpConfig.scale?Math.pow(10,e.median)-1:e.median;(0,S.Z)(r[n]).select("path").classed("highlighted",!0),t.gpConfig.subset?t.tooltip.show(e.group+"<br/>"+e.label+` (n = ${e.values.length})<br/>`+`Median${t.unit}: ${a.toPrecision(4)}<br/>`):t.tooltip.show(e.group+"<br/>"+`n = ${e.values.length}<br/>`+`Median${t.unit}: ${a.toPrecision(4)}<br/>`)}))}(t)}function je(t,e){(0,k.Z)(`#${e.svg} path.violin`).classed("outlined",!t.gpConfig.showOutliers),ze(`#${e.svg} .violin-outliers`).toggle(t.gpConfig.showOutliers)}function Ve(t,e,n){switch(t){case n.plotSorts.ascAlphaSort:e.sort(((t,e)=>t.group<e.group?-1:t.group>e.group?1:0));break;case n.plotSorts.descAlphaSort:e.sort(((t,e)=>t.group<e.group?1:t.group>e.group?-1:0));break;case n.plotSorts.ascSort:e.sort(((t,e)=>t.median-e.median));break;case n.plotSorts.descSort:e.sort(((t,e)=>e.median-t.median))}return e.map((t=>t.group))}function Fe(t,e){let n=t.gpConfig.subset?t.geneJson.subsetData:t.geneJson.allData;const r="log"==t.gpConfig.scale?Ne(n,t.tIdNameMap,t.groupColorDict):Ne(n,t.tIdNameMap,t.groupColorDict,!1);let a=t.data.map((t=>t.group));t.allData=r.map((t=>t)),t.data=r.filter((t=>-1!=a.indexOf(t.group)));let o=t.sortData.filter((t=>a.includes(t.group))),i=Ve(t.gpConfig.sort,o,e);Ce(t.data,"log"==t.gpConfig.scale),Ce(t.allData,"log"==t.gpConfig.scale);let s="log"==t.gpConfig.scale?"log10(TPM+1)":"TPM";t.updateXScale(i),t.updateYScale(s),Pe(t,e)}}}]);