"use strict";(self.webpackChunkseqr=self.webpackChunkseqr||[]).push([[651],{14827:function(t,e,n){n.d(e,{Z:function(){return i},D:function(){return a}});var s=n(5130),o=n(12828);function i(t){var e=t.document.documentElement,n=(0,s.Z)(t).on("dragstart.drag",o.Z,!0);"onselectstart"in e?n.on("selectstart.drag",o.Z,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function a(t,e){var n=t.document.documentElement,i=(0,s.Z)(t).on("dragstart.drag",null);e&&(i.on("click.drag",o.Z,!0),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}},12828:function(t,e,n){n.d(e,{r:function(){return o},Z:function(){return i}});var s=n(42274);function o(){s.B.stopImmediatePropagation()}function i(){s.B.preventDefault(),s.B.stopImmediatePropagation()}},52508:function(t,e){var n=Math.PI,s=2*n,o=1e-6,i=s-o;function a(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function r(){return new a}a.prototype=r.prototype={constructor:a,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,s){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+s)},bezierCurveTo:function(t,e,n,s,o,i){this._+="C"+ +t+","+ +e+","+ +n+","+ +s+","+(this._x1=+o)+","+(this._y1=+i)},arcTo:function(t,e,s,i,a){t=+t,e=+e,s=+s,i=+i,a=+a;var r=this._x1,l=this._y1,u=s-t,c=i-e,h=r-t,p=l-e,d=h*h+p*p;if(a<0)throw new Error("negative radius: "+a);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(d>o)if(Math.abs(p*u-c*h)>o&&a){var f=s-r,g=i-l,v=u*u+c*c,b=f*f+g*g,x=Math.sqrt(v),m=Math.sqrt(d),y=a*Math.tan((n-Math.acos((v+d-b)/(2*x*m)))/2),w=y/m,$=y/x;Math.abs(w-1)>o&&(this._+="L"+(t+w*h)+","+(e+w*p)),this._+="A"+a+","+a+",0,0,"+ +(p*f>h*g)+","+(this._x1=t+$*u)+","+(this._y1=e+$*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,a,r,l,u){t=+t,e=+e,u=!!u;var c=(a=+a)*Math.cos(r),h=a*Math.sin(r),p=t+c,d=e+h,f=1^u,g=u?r-l:l-r;if(a<0)throw new Error("negative radius: "+a);null===this._x1?this._+="M"+p+","+d:(Math.abs(this._x1-p)>o||Math.abs(this._y1-d)>o)&&(this._+="L"+p+","+d),a&&(g<0&&(g=g%s+s),g>i?this._+="A"+a+","+a+",0,1,"+f+","+(t-c)+","+(e-h)+"A"+a+","+a+",0,1,"+f+","+(this._x1=p)+","+(this._y1=d):g>o&&(this._+="A"+a+","+a+",0,"+ +(g>=n)+","+f+","+(this._x1=t+a*Math.cos(l))+","+(this._y1=e+a*Math.sin(l))))},rect:function(t,e,n,s){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +s+"h"+-n+"Z"},toString:function(){return this._}},e.Z=r},69607:function(t,e,n){n.d(e,{Z:function(){return i}});var s=n(98861),o=n(47882);function i(t){var e=(0,s.Z)();return e.changedTouches&&(e=e.changedTouches[0]),(0,o.Z)(t,e)}},47882:function(t,e,n){function s(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,[(s=s.matrixTransform(t.getScreenCTM().inverse())).x,s.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}n.d(e,{Z:function(){return s}})},56070:function(t,e,n){n.d(e,{Z:function(){return o}});var s=n(73078);function o(t){return"string"==typeof t?new s.Y1([document.querySelectorAll(t)],[document.documentElement]):new s.Y1([null==t?[]:t],s.Jz)}},98861:function(t,e,n){n.d(e,{Z:function(){return o}});var s=n(42274);function o(){for(var t,e=s.B;t=e.sourceEvent;)e=t;return e}},92992:function(t,e,n){n.d(e,{Z:function(){return i}});var s=n(98861),o=n(47882);function i(t,e,n){arguments.length<3&&(n=e,e=(0,s.Z)().changedTouches);for(var i,a=0,r=e?e.length:0;a<r;++a)if((i=e[a]).identifier===n)return(0,o.Z)(t,i);return null}},45902:function(t,e,n){n.d(e,{Z:function(){return l}});var s=n(52508),o=n(56297),i=n(41545),a=n(23780),r=n(32337);function l(){var t=r.x,e=null,n=(0,o.Z)(0),l=r.y,u=(0,o.Z)(!0),c=null,h=i.Z,p=null;function d(o){var i,a,r,d,f,g=o.length,v=!1,b=new Array(g),x=new Array(g);for(null==c&&(p=h(f=(0,s.Z)())),i=0;i<=g;++i){if(!(i<g&&u(d=o[i],i,o))===v)if(v=!v)a=i,p.areaStart(),p.lineStart();else{for(p.lineEnd(),p.lineStart(),r=i-1;r>=a;--r)p.point(b[r],x[r]);p.lineEnd(),p.areaEnd()}v&&(b[i]=+t(d,i,o),x[i]=+n(d,i,o),p.point(e?+e(d,i,o):b[i],l?+l(d,i,o):x[i]))}if(f)return p=null,f+""||null}function f(){return(0,a.Z)().defined(u).curve(h).context(c)}return d.x=function(n){return arguments.length?(t="function"==typeof n?n:(0,o.Z)(+n),e=null,d):t},d.x0=function(e){return arguments.length?(t="function"==typeof e?e:(0,o.Z)(+e),d):t},d.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:(0,o.Z)(+t),d):e},d.y=function(t){return arguments.length?(n="function"==typeof t?t:(0,o.Z)(+t),l=null,d):n},d.y0=function(t){return arguments.length?(n="function"==typeof t?t:(0,o.Z)(+t),d):n},d.y1=function(t){return arguments.length?(l=null==t?null:"function"==typeof t?t:(0,o.Z)(+t),d):l},d.lineX0=d.lineY0=function(){return f().x(t).y(n)},d.lineY1=function(){return f().x(t).y(l)},d.lineX1=function(){return f().x(e).y(n)},d.defined=function(t){return arguments.length?(u="function"==typeof t?t:(0,o.Z)(!!t),d):u},d.curve=function(t){return arguments.length?(h=t,null!=c&&(p=h(c)),d):h},d.context=function(t){return arguments.length?(null==t?c=p=null:p=h(c=t),d):c},d}},56297:function(t,e,n){function s(t){return function(){return t}}n.d(e,{Z:function(){return s}})},41545:function(t,e,n){function s(t){this._context=t}function o(t){return new s(t)}n.d(e,{Z:function(){return o}}),s.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}}},23780:function(t,e,n){n.d(e,{Z:function(){return r}});var s=n(52508),o=n(56297),i=n(41545),a=n(32337);function r(){var t=a.x,e=a.y,n=(0,o.Z)(!0),r=null,l=i.Z,u=null;function c(o){var i,a,c,h=o.length,p=!1;for(null==r&&(u=l(c=(0,s.Z)())),i=0;i<=h;++i)!(i<h&&n(a=o[i],i,o))===p&&((p=!p)?u.lineStart():u.lineEnd()),p&&u.point(+t(a,i,o),+e(a,i,o));if(c)return u=null,c+""||null}return c.x=function(e){return arguments.length?(t="function"==typeof e?e:(0,o.Z)(+e),c):t},c.y=function(t){return arguments.length?(e="function"==typeof t?t:(0,o.Z)(+t),c):e},c.defined=function(t){return arguments.length?(n="function"==typeof t?t:(0,o.Z)(!!t),c):n},c.curve=function(t){return arguments.length?(l=t,null!=r&&(u=l(r)),c):l},c.context=function(t){return arguments.length?(null==t?r=u=null:u=l(r=t),c):r},c}},32337:function(t,e,n){function s(t){return t[0]}function o(t){return t[1]}n.d(e,{x:function(){return s},y:function(){return o}})},18651:function(t,e,n){function s(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function o(t,e){return fetch(t,e).then(s)}n.d(e,{u:function(){return it}});var i=n(65351),a=n(56070),r=n(5130);var l=n(6939);var u=n(66944),c=n(64361),h=n(45902),p=n(50352),d=n(42274),f=n(3839),g=n(14827),v=n(40565),b=n(92992),x=n(69607),m=n(47306);function y(t){return function(){return t}}function w(t,e,n){this.target=t,this.type=e,this.selection=n}function $(){d.B.stopImmediatePropagation()}function _(){d.B.preventDefault(),d.B.stopImmediatePropagation()}var S={name:"drag"},T={name:"space"},M={name:"handle"},Z={name:"center"};function k(t){return[+t[0],+t[1]]}function E(t){return[k(t[0]),k(t[1])]}function G(t){return function(e){return(0,b.Z)(e,d.B.touches,t)}}var I={name:"x",handles:["w","e"].map(V),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},O={name:"y",handles:["n","s"].map(V),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},D={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(V),input:function(t){return null==t?null:E(t)},output:function(t){return t}},B={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},C={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},A={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},z={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},P={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function V(t){return{type:t}}function q(){return!d.B.ctrlKey&&!d.B.button}function R(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function j(){return navigator.maxTouchPoints||"ontouchstart"in this}function L(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function F(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Y(t){var e,n=R,s=q,o=j,i=!0,a=(0,f.Z)("start","brush","end"),l=6;function u(e){var n=e.property("__brush",Y).selectAll(".overlay").data([V("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",B.overlay).merge(n).each((function(){var t=L(this).extent;(0,r.Z)(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([V("selection")]).enter().append("rect").attr("class","selection").attr("cursor",B.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var s=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));s.exit().remove(),s.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return B[t.type]})),e.each(c).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",b).filter(o).on("touchstart.brush",b).on("touchmove.brush",k).on("touchend.brush touchcancel.brush",D).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function c(){var t=(0,r.Z)(this),e=L(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-l/2:e[0][0]-l/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-l/2:e[0][1]-l/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+l:l})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+l:l}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function h(t,e,n){var s=t.__brush.emitter;return!s||n&&s.clean?new p(t,e,n):s}function p(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function b(){if((!e||d.B.touches)&&s.apply(this,arguments)){var n,o,a,l,u,p,f,v,b,y,w,k=this,E=d.B.target.__data__.type,D="selection"===(i&&d.B.metaKey?E="overlay":E)?S:i&&d.B.altKey?Z:M,V=t===O?null:z[E],q=t===I?null:P[E],R=L(k),j=R.extent,Y=R.selection,X=j[0][0],N=j[0][1],W=j[1][0],H=j[1][1],J=0,K=0,U=V&&q&&i&&d.B.shiftKey,Q=d.B.touches?G(d.B.changedTouches[0].identifier):x.Z,tt=Q(k),et=tt,nt=h(k,arguments,!0).beforestart();"overlay"===E?(Y&&(b=!0),R.selection=Y=[[n=t===O?X:tt[0],a=t===I?N:tt[1]],[u=t===O?W:n,f=t===I?H:a]]):(n=Y[0][0],a=Y[0][1],u=Y[1][0],f=Y[1][1]),o=n,l=a,p=u,v=f;var st=(0,r.Z)(k).attr("pointer-events","none"),ot=st.selectAll(".overlay").attr("cursor",B[E]);if(d.B.touches)nt.moved=at,nt.ended=lt;else{var it=(0,r.Z)(d.B.view).on("mousemove.brush",at,!0).on("mouseup.brush",lt,!0);i&&it.on("keydown.brush",ut,!0).on("keyup.brush",ct,!0),(0,g.Z)(d.B.view)}$(),(0,m.e1)(k),c.call(k),nt.start()}function at(){var t=Q(k);!U||y||w||(Math.abs(t[0]-et[0])>Math.abs(t[1]-et[1])?w=!0:y=!0),et=t,b=!0,_(),rt()}function rt(){var t;switch(J=et[0]-tt[0],K=et[1]-tt[1],D){case T:case S:V&&(J=Math.max(X-n,Math.min(W-u,J)),o=n+J,p=u+J),q&&(K=Math.max(N-a,Math.min(H-f,K)),l=a+K,v=f+K);break;case M:V<0?(J=Math.max(X-n,Math.min(W-n,J)),o=n+J,p=u):V>0&&(J=Math.max(X-u,Math.min(W-u,J)),o=n,p=u+J),q<0?(K=Math.max(N-a,Math.min(H-a,K)),l=a+K,v=f):q>0&&(K=Math.max(N-f,Math.min(H-f,K)),l=a,v=f+K);break;case Z:V&&(o=Math.max(X,Math.min(W,n-J*V)),p=Math.max(X,Math.min(W,u+J*V))),q&&(l=Math.max(N,Math.min(H,a-K*q)),v=Math.max(N,Math.min(H,f+K*q)))}p<o&&(V*=-1,t=n,n=u,u=t,t=o,o=p,p=t,E in C&&ot.attr("cursor",B[E=C[E]])),v<l&&(q*=-1,t=a,a=f,f=t,t=l,l=v,v=t,E in A&&ot.attr("cursor",B[E=A[E]])),R.selection&&(Y=R.selection),y&&(o=Y[0][0],p=Y[1][0]),w&&(l=Y[0][1],v=Y[1][1]),Y[0][0]===o&&Y[0][1]===l&&Y[1][0]===p&&Y[1][1]===v||(R.selection=[[o,l],[p,v]],c.call(k),nt.brush())}function lt(){if($(),d.B.touches){if(d.B.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else(0,g.D)(d.B.view,b),it.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);st.attr("pointer-events","all"),ot.attr("cursor",B.overlay),R.selection&&(Y=R.selection),F(Y)&&(R.selection=null,c.call(k)),nt.end()}function ut(){switch(d.B.keyCode){case 16:U=V&&q;break;case 18:D===M&&(V&&(u=p-J*V,n=o+J*V),q&&(f=v-K*q,a=l+K*q),D=Z,rt());break;case 32:D!==M&&D!==Z||(V<0?u=p-J:V>0&&(n=o-J),q<0?f=v-K:q>0&&(a=l-K),D=T,ot.attr("cursor",B.selection),rt());break;default:return}_()}function ct(){switch(d.B.keyCode){case 16:U&&(y=w=U=!1,rt());break;case 18:D===Z&&(V<0?u=p:V>0&&(n=o),q<0?f=v:q>0&&(a=l),D=M,rt());break;case 32:D===T&&(d.B.altKey?(V&&(u=p-J*V,n=o+J*V),q&&(f=v-K*q,a=l+K*q),D=Z):(V<0?u=p:V>0&&(n=o),q<0?f=v:q>0&&(a=l),D=M),ot.attr("cursor",B[E]),rt());break;default:return}_()}}function k(){h(this,arguments).moved()}function D(){h(this,arguments).ended()}function Y(){var e=this.__brush||{selection:null};return e.extent=E(n.apply(this,arguments)),e.dim=t,e}return u.move=function(e,n){e.selection?e.on("start.brush",(function(){h(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){h(this,arguments).end()})).tween("brush",(function(){var e=this,s=e.__brush,o=h(e,arguments),i=s.selection,a=t.input("function"==typeof n?n.apply(this,arguments):n,s.extent),r=(0,v.Z)(i,a);function l(t){s.selection=1===t&&null===a?null:r(t),c.call(e),o.brush()}return null!==i&&null!==a?l:l(1)})):e.each((function(){var e=this,s=arguments,o=e.__brush,i=t.input("function"==typeof n?n.apply(e,s):n,o.extent),a=h(e,s).beforestart();(0,m.e1)(e),o.selection=null===i?null:i,c.call(e),a.start().brush().end()}))},u.clear=function(t){u.move(t,null)},p.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){(0,d._H)(new w(u,e,t.output(this.state.selection)),a.apply,a,[e,this.that,this.args])}},u.extent=function(t){return arguments.length?(n="function"==typeof t?t:y(E(t)),u):n},u.filter=function(t){return arguments.length?(s="function"==typeof t?t:y(!!t),u):s},u.touchable=function(t){return arguments.length?(o="function"==typeof t?t:y(!!t),u):o},u.handleSize=function(t){return arguments.length?(l=+t,u):l},u.keyModifiers=function(t){return arguments.length?(i=!!t,u):i},u.on=function(){var t=a.on.apply(a,arguments);return t===a?u:t},u}function X(){return Math.random()}(function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n})(X);var N=function t(e){function n(t,n){var s,o;return t=null==t?0:+t,n=null==n?1:+n,function(){var i;if(null!=s)i=s,s=null;else do{s=2*e()-1,i=2*e()-1,o=s*s+i*i}while(!o||o>1);return t+n*i*Math.sqrt(-2*Math.log(o)/o)}}return n.source=t,n}(X),W=(function t(e){function n(){var t=N.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(X),function t(e){function n(t){return function(){for(var n=0,s=0;s<t;++s)n+=e();return n}}return n.source=t,n}(X));(function t(e){function n(t){var n=W.source(e)(t);return function(){return n()/t}}return n.source=t,n})(X),function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(X);const H=function(t){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*t*t)},J=function(t){let e=((0,i.VR)(t,.75)-(0,i.VR)(t,.25))/1.34;return 1.06*Math.min((0,i.P3)(t),e)*Math.pow(t.length,-.2)};var K=n(1300),U=n(6939);function Q(t){for(var e="",n=document.styleSheets,s=0;s<n.length;s++)try{if(null==n[s].cssRules)continue;for(var o=n[s].cssRules,i=0;i<o.length;i++){var a=o[i];if(void 0!==a.style){var r,l=void 0===a.selectorText?a.selectorText:a.selectorText.replace(`#${t[0].id} `,"");try{r=U(t).find(l)}catch(t){r=[]}r.length>0&&(e+=a.selectorText+" { "+a.style.cssText+" }\n")}}}catch(t){if("SecurityError"!==t.name)throw t;continue}var u=document.createElement("style");return u.setAttribute("type","text/css"),u.innerHTML="<![CDATA[\n"+e+"\n]]>",u}var tt=n(6939);class et{constructor(t,e,n=!1){tt(`#${t}`).show();const s=n?"btn-group-vertical btn-group-sm":"btn-group btn-group-sm";this.bar=tt("<div/>").addClass(s).appendTo(`#${t}`),this.buttons={},this.tooltip=e}createDownloadSvgButton(t,e,n,s,o="fa-download"){this.createButton(t,o);(0,r.Z)(`#${t}`).on("click",(()=>{this.downloadSvg(e,n,s)})).on("mouseover",(()=>{this.tooltip.show("Download")})).on("mouseout",(()=>{this.tooltip.hide()}))}createResetButton(t,e,n="fa-expand-arrows-alt"){this.createButton(t,n);(0,r.Z)(`#${t}`).on("click",e).on("mouseover",(()=>{this.tooltip.show("Reset the scales")})).on("mouseout",(()=>{this.tooltip.hide()}))}createButton(t,e="fa-download"){const n=tt("<a/>").attr("id",t).addClass("btn btn-default").appendTo(this.bar);return tt("<i/>").addClass(`fa ${e}`).appendTo(n),this.buttons[t]=n,n}attachTooltip(t){this.tooltip=t}downloadSvg(t,e,n){let s=tt(tt(tt(""+("#"+t)))[0]),o=s.clone().attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg"),i=Q(s.get());o.prepend(i),tt("#"+n).html("").hide();let a=tt(`#${n}`).append(o).html(),r=new Blob([a],{type:"image/svg+xml"});saveAs(r,e),tt(`#${n}`).html("").hide()}}var nt=n(6939);class st{constructor(t,e={}){this._sanityCheck(t),this.data=t,this.groupInfo=e,this.toolbar=void 0,this.tooltip=void 0}render(t,e=500,n=357,s=.05,o,a=[-3,3],l="Y axis",h=!0,d=30,f=!0,g=0,v=!1,b=!1,x=!1,m=!1,y=!1,w=!1,$=0){if(this.reset=()=>{t.selectAll("*").remove(),this.render(t,e,n,s,o,a,l,h,d,f,g,v,b,x,m,y,w)},this.updateYScale=function(i,a){t.selectAll("*").remove(),void 0===a&&(a=[]),this.render(t,e,n,s,o,[],i,h,d,f,g,v,b,x,m,y,w)},this.updateXScale=function(o){void 0===o&&console.error("updateXScale called without new X domain"),t.selectAll("*").remove(),this.render(t,e,n,s,o,[],l,h,d,f,g,v,b,x,m,y,w)},void 0===a||0==a.length){let t=[];this.data.forEach((e=>t=t.concat(e.values))),a=(0,i.We)(t)}this.groups=(0,u.b1)().key((t=>t.group)).entries(this.data),this.scale={x:(0,c.ti)().rangeRound([0,e]).domain(o||this.groups.map((t=>t.key))).paddingInner(s),subx:(0,c.ti)(),y:(0,c.BY)().rangeRound([n,0]).domain(a),z:(0,c.BY)()},this.groups.forEach((e=>{let s=e.key,o=e.values,r=this.groupInfo[s];if(e.index=this.scale.x.domain().indexOf(s),void 0!==r){t.append("g").selectAll(".violin-group-label").data(["pvalue"]).enter().append("text").attr("x",0).attr("y",0).attr("class","violin-group-label").attr("text-anchor","center").attr("fill",(t=>"pvalue"==t&&parseFloat(r[t])<=parseFloat(r.pvalueThreshold)?"orangered":"SlateGray")).attr("transform",((t,e)=>`translate(${this.scale.x(s)+this.scale.x.bandwidth()/2}, ${this.scale.y(a[0])+50})`)).text((t=>`${t}: ${parseFloat(parseFloat(r[t]).toPrecision(3)).toExponential()}`))}y&&o.sort(((t,e)=>t.label<e.label?-1:t.label>e.label?1:0)),this.scale.subx.domain(o.map((t=>t.label))).rangeRound([this.scale.x(s),this.scale.x(s)+this.scale.x.bandwidth()]),o.forEach((n=>{0!=n.values.length&&(n.values=n.values.sort(i.j2),this._drawViolin(t,n,v,e.index,w,$))}));var l=18;if(m){const e=(0,c.ti)().domain(o.map((t=>null==t.size?"(0)":`(${t.size||0})`))).rangeRound([this.scale.x(s),this.scale.x(s)+this.scale.x.bandwidth()]);t.append("g").attr("class","violin-size-axis").attr("transform",`translate(0, ${n+l})`).call((0,p.LL)(e))}if(f){l=5;const e=t.append("g").attr("class","violin-sub-axis").attr("transform",`translate(0, ${n+l})`).call((0,p.LL)(this.scale.subx));g>0&&e.selectAll("text").attr("text-anchor","start").attr("transform",`rotate(${g}, 2, 10)`)}}));let _=f?55:0;if(this.xAxis=h?(0,p.LL)(this.scale.x):(0,p.LL)(this.scale.x).tickFormat(""),t.append("g").attr("class","violin-x-axis axis--x").attr("transform",`translate(0, ${n+_})`).call(this.xAxis).selectAll("text").attr("text-anchor","start").attr("transform",`rotate(${d}, -10, 10)`),_=5,this.yAxis=(0,p.y4)(this.scale.y).tickValues(this.scale.y.ticks(5)),t.append("g").attr("class","violin-y-axis axis--y").attr("transform",`translate(-${_}, 0)`).call(this.yAxis),t.append("text").attr("class","violin-axis-label").attr("text-anchor","middle").attr("transform",`translate(-${2*_+(0,r.Z)(".violin-y-axis").node().getBBox().width}, ${this.scale.y.range()[0]+(this.scale.y.range()[1]-this.scale.y.range()[0])/2}) rotate(-90)`).text(l),t.on("mouseout",(()=>{void 0!==this.tooltip&&this.tooltip.hide()})),b&&this._addGroupDivider(t),x){const e=t.append("g").attr("id","violinLegend").attr("transform","translate(0, 0)");e.append("rect").attr("x",this.scale.x.range()[0]).attr("y",-35).attr("width",60*this.groups[0].values.length+10).attr("height",24).style("fill","none").style("stroke","silver");const n=e.selectAll(".violin-legend").data(this.groups[0].values).enter().append("g").classed("violin-legend",!0),s=10;n.append("rect").attr("x",((t,e)=>5+60*e+this.scale.x.range()[0])).attr("y",-28).attr("width",s).attr("height",s).style("fill",(t=>t.color)),n.append("text").attr("class","violin-legend-text").text((t=>t.label)).attr("x",((t,e)=>17+60*e+this.scale.x.range()[0])).attr("y",-20)}}addPlotTitle(t,e){let n=(this.scale.x.range()[1]-this.scale.x.range()[0]+1)/2,s=this.scale.y.range()[1]-10;t.append("text").attr("class","violin-title").attr("text-anchor","middle").attr("transform",`translate(${n}, ${s})`).text(e)}createTooltip(t){return 0==nt(`#${t}`).length&&nt("<div/>").attr("id",t).appendTo(nt("body")),this.tooltip=new K.Z(t),(0,r.Z)(`#${t}`).classed("violin-tooltip",!0),this.tooltip}createToolbar(t,e){return this.toolbar=new et(t,e),this.toolbar}addBrush(t){const e=Y(D);e.on("end",(()=>{this.zoom(t,e)})),t.append("g").attr("class","brush").call(e)}zoom(t,e){let n,s=d.B.selection;if(void 0===e)this.reset();else if(s){this.scale.x.domain(this.scale.x.domain().filter(((t,e)=>{const n=Math.floor(s[0][0]/this.scale.x.bandwidth()),o=Math.floor(s[1][0]/this.scale.x.bandwidth());return e>=n&&e<=o})));const n=Math.floor(this.scale.y.invert(s[1][1])),o=Math.floor(this.scale.y.invert(s[0][1]));this.scale.y.domain([n,o]),t.select(".brush").call(e.move,null)}else{if(!n)return n=setTimeout((function(){n=null}),350);this.reset()}let o=t.transition().duration(750);t.select(".axis--x").transition(o).call(this.xAxis),t.select(".axis--y").transition(o).call(this.yAxis),this.groups.forEach(((e,n)=>{let s=e.key,a=e.values;this.scale.subx.rangeRound([this.scale.x(s),this.scale.x(s)+this.scale.x.bandwidth()]),a.forEach((n=>{if(0==n.values.length)return;this.scale.x.domain().indexOf(s);this.scale.z.range([this.scale.subx(n.label),this.scale.subx(n.label)+this.scale.subx.bandwidth()]);const a=t.select(`#violin${e.index}-${n.label}`);a.select(".violin").transition(o).attr("d",(0,h.Z)().x0((t=>this.scale.z(t[1]))).x1((t=>this.scale.z(-t[1]))).y((t=>this.scale.y(t[0]))));const r=(0,i.VR)(n.values,.25),l=(0,i.VR)(n.values,.75),u=.1;a.select(".violin-ir").transition(o).attr("x",this.scale.z(-u)).attr("y",this.scale.y(l)).attr("width",Math.abs(this.scale.z(-u)-this.scale.z(u))).attr("height",Math.abs(this.scale.y(l)-this.scale.y(r)));const c=(0,i.C2)(n.values);a.select(".violin-median").transition(o).attr("x1",this.scale.z(-u)).attr("x2",this.scale.z(u)).attr("y1",this.scale.y(c)).attr("y2",this.scale.y(c))}))}))}_drawViolin(t,e,n,s,o,a){let r=function(t,e,n){return function(s){return e.map((e=>[e,(0,i.J6)(s,(s=>t((e-s)/n)))/n]))}}(H,this.scale.y.ticks(100),J(e.values));const l=(0,i.We)(e.values),u=r(e.values).filter((t=>t[0]>=l[0]&&t[0]<=l[1])),c=t.append("g").attr("id",`violin${s}-${e.label}`).attr("class","violin-g").datum(e);if(e.values.length>=a&&u.length&&this._validVertices(u)){let a=(0,i.Fp)(u,(t=>Math.abs(t[1])));this.scale.z.domain([-a,a]).range([this.scale.subx(e.label),this.scale.subx(e.label)+this.scale.subx.bandwidth()]);let r=(0,h.Z)().x0((t=>this.scale.z(t[1]))).x1((t=>this.scale.z(-t[1]))).y((t=>this.scale.y(t[0])));const l=c.append("path").datum(u).attr("d",r).classed("violin",!0).style("fill",(()=>void 0!==e.color?e.color:s%2==0?"#90c1c1":"#94a8b8")),p=(0,i.VR)(e.values,.25),d=(0,i.VR)(e.values,.75),f=this.scale.z.domain()[1]/3;if(n){const n=Math.abs(d-p),s=(0,i.Fp)(e.values.filter((t=>t<=d+1.5*n))),o=(0,i.VV)(e.values.filter((t=>t>=p-1.5*n)));t.append("line").classed("whisker",!0).attr("x1",this.scale.z(0)).attr("x2",this.scale.z(0)).attr("y1",this.scale.y(s)).attr("y2",this.scale.y(o)).style("stroke","#fff")}c.append("rect").attr("x",this.scale.z(-f)).attr("y",this.scale.y(d)).attr("width",Math.abs(this.scale.z(-f)-this.scale.z(f))).attr("height",Math.abs(this.scale.y(d)-this.scale.y(p))).attr("class","violin-ir");const g=(0,i.C2)(e.values);if(c.append("line").attr("x1",this.scale.z(-f)).attr("x2",this.scale.z(f)).attr("y1",this.scale.y(g)).attr("y2",this.scale.y(g)).attr("class","violin-median"),o){let t=N(0,f/2);const n=Math.abs(d-p),s=(0,i.Fp)(e.values.filter((t=>t<=d+1.5*n))),o=(0,i.VV)(e.values.filter((t=>t>=p-1.5*n))),a=e.values.filter((t=>t<o||t>s));c.append("g").attr("class","violin-outliers").selectAll("circle").data(a).enter().append("circle").attr("cx",(()=>this.scale.z(t()))).attr("cy",(t=>this.scale.y(t))).attr("r",2)}c.on("mouseover",(()=>{l.classed("highlighted",!0),void 0===this.tooltip?console.warn("GroupViolin Warning: tooltip not defined"):this.tooltip.show(e.group+"<br/>"+e.label+"<br/>Median: "+g.toPrecision(4)+"<br/>")})),c.on("mouseout",(()=>{l.classed("highlighted",!1)}))}else if(a){let t=(0,i.Fp)(e.values,(t=>Math.abs(t)));this.scale.z.domain([-t,t]).range([this.scale.subx(e.label),this.scale.subx(e.label)+this.scale.subx.bandwidth()]);const n=this.scale.z.domain()[1]/3;let s=N(0,n/2);c.append("g").attr("class","violin-points").selectAll("circle").data(e.values).enter().append("circle").attr("cx",(()=>this.scale.z(s()))).attr("cy",(t=>this.scale.y(t))).attr("r",2)}}_sanityCheck(t){const e=["group","label","values"];t.forEach((t=>{e.forEach((e=>{if(void 0===t[e])throw"GroupedViolin: input data error."}))}))}_addGroupDivider(t){const e=this.scale.x.domain(),n=Math.abs(this.scale.x(this.scale.x.domain()[1])-this.scale.x(this.scale.x.domain()[0])-this.scale.x.bandwidth()),s=(t,s)=>s!==e.length-1?this.scale.x(t)+ +this.scale.x.bandwidth()+n/2:0;t.selectAll(".vline").data(e).enter().append("line").classed("vline",!0).attr("x1",s).attr("x2",s).attr("y1",this.scale.y.range()[0]).attr("y2",this.scale.y.range()[1]).style("stroke-width",((t,n)=>n!=e.length-1?1:0)).style("stroke","rgb(86,98,107)").style("opacity",.5)}_validVertices(t){return!t.reduce(((t,e)=>t.concat(e)),[]).filter((t=>isNaN(t))).length}}var ot=n(6939);function it(t,e,n,s="Gene Expression Violin Plot",u=function(){const t="https://gtexportal.org/rest/v1/";return{singleTissueEqtl:t+"association/singleTissueEqtl?format=json&datasetId=gtex_v7&gencodeId=",ld:t+"dataset/ld?format=json&datasetId=gtex_v7&gencodeId=",dyneqtl:t+"association/dyneqtl",snp:t+"reference/variant?format=json&snpId=",variantId:t+"dataset/variant?format=json&variantId=",exonExp:t+"expression/medianExonExpression?datasetId=gtex_v7&hcluster=true&gencodeId=",transcriptExp:t+"expression/medianTranscriptExpression?datasetId=gtex_v7&hcluster=true&gencodeId=",junctionExp:t+"expression/medianJunctionExpression?datasetId=gtex_v7&hcluster=true&gencodeId=",transcript:t+"reference/transcript?datasetId=gtex_v7&gencodeId=",exon:t+"reference/exon?datasetId=gtex_v7&gencodeId=",geneModel:t+"dataset/collapsedGeneModelExon?datasetId=gtex_v7&gencodeId=",geneModelUnfiltered:t+"dataset/fullCollapsedGeneModelExon?datasetId=gtex_v7&gencodeId=",geneExp:t+"expression/geneExpression?datasetId=gtex_v7&gencodeId=",medGeneExp:t+"expression/medianGeneExpression?datasetId=gtex_v7&hcluster=true&pageSize=10000",geneExpBoxplot:t+"expression/geneExpression?datasetId=gtex_v7&boxplotDetail=full&gencodeId=",topInTissueFiltered:t+"expression/topExpressedGene?datasetId=gtex_v7&filterMtGene=true&sortBy=median&sortDirection=desc&pageSize=50&tissueSiteDetailId=",topInTissue:t+"expression/topExpressedGene?datasetId=gtex_v7&sortBy=median&sortDirection=desc&pageSize=50&tissueSiteDetailId=",geneId:t+"reference/gene?format=json&gencodeVersion=v19&genomeBuild=GRCh37%2Fhg19&geneId=",tissue:t+"dataset/tissueInfo?format=json&datasetId=gtex_v7",sample:"tmpSummaryData/gtex.Sample.csv",rnaseqCram:"tmpSummaryData/rnaseq_cram_files_v7_dbGaP_011516.txt",wgsCram:"tmpSummaryData/wgs_cram_files_v7_hg38_dbGaP_011516.txt",fcBilling:"https://api.firecloud.org/api/profile/billing",fcWorkSpace:"https://api.firecloud.org/api/workspaces",fcPortalWorkSpace:"https://portal.firecloud.org/#workspaces"}}(),c=at(50,75,250,60),h={w:.8*window.innerWidth,h:250}){const p=[o(u.tissue,{credentials:"include"}),o(u.geneExp+n,{credentials:"include"}),o(u.geneExp+n+"&attributeSubset=sex",{credentials:"include"})],d={root:t,spinner:"spinner",svg:`${t}-svg`,tooltip:e,toolbar:`${t}-toolbar`,clone:`${t}-svg-clone`,buttons:{download:`${t}-download`,plotOptions:`${t}-option-modal`,filter:`${t}-filter`,ascAlphaSort:`${t}-asc-alphasort`,descAlphaSort:`${t}-desc-alphasort`,ascSort:`${t}-asc-sort`,descSort:`${t}-desc-sort`,logScale:`${t}-log-scale`,linearScale:`${t}-linear-scale`,noDiff:`${t}-no-diff`,sexDiff:`${t}-sex-diff`,outliersOn:`${t}-outliers-on`,outliersOff:`${t}-outliers-off`},plotOptionGroups:{scale:`${t}-option-scale`,sort:`${t}-option-sort`,differentiation:`${t}-option-differentiation`,outliers:`${t}-option-outlier`},plotSorts:{ascAlphaSort:"asc-alphasort",descAlphaSort:"desc-alphasort",ascSort:"asc-sort",descSort:"desc-sort"},tissueFilter:`${t}-filter-modal`};if(0==ot(`#${d.root}`).length)throw"Violin Plot Error: rootId does not exist.";0==ot(`#${d.tooltip}`).length&&ot("<div/>").attr("id",d.tooltip).appendTo(ot("body")),0==ot(`#${d.toolbar}`).length&&ot("<div/>").attr("id",d.toolbar).appendTo(ot(`#${d.root}`)),0==ot(`#${d.root} #${d.spinner}`).length?ot('<span><i id="spinner" class="fas fa-sync fa-spin"></i></span>').appendTo(ot(`#${d.root}`)):ot(`#${d.root} #${d.spinner}`).show(),0==ot(`#${d.clone}`).length&&ot("<div/>").attr("id",d.clone).appendTo(ot(`#${d.root}`)),Promise.all(p).then((function(t){const e=function(t){const e="tissueInfo";if(!t.hasOwnProperty(e))throw"Parsing Error: required json attr is missing: "+e;const n=t[e];return["tissueSiteDetailId","tissueSiteDetail","colorHex"].forEach((t=>{if(!n[0].hasOwnProperty(t))throw"Parsing Error: required json attr is missing: "+t})),n}(t[0]),o={},u={},p={female:"#e67f7b",male:"#70bcd2"};e.forEach((t=>{u[t.tissueSiteDetailId]=t.tissueSiteDetail,o[t.tissueSiteDetail]=t,p[t.tissueSiteDetailId]=t.colorHex}));const f=lt(t[1],u,p,!1);if(!f.length)return ot(`#${d.toolbar}`).remove(),ot(`<div id="gene-exp-vplot">No gene expression data found for ${n}</div>`).appendTo(`#${d.root}`),void ot(`#${d.root} #${d.spinner}`).hide();let g=new st(f),v=g.createTooltip(d.tooltip);g.sortData=g.data.map((t=>t)),g.allData=g.data.map((t=>t)),g.gencodeId=n,g.tIdNameMap=u,g.groupColorDict=p,g.tissueDict=o,g.geneJson={allData:t[1],subsetData:t[2]},g.unit=f.length>0?` ${f[0].unit}`:"",g.gpConfig={subset:!1,scale:"linear",sort:d.plotSorts.ascAlphaSort,showOutliers:!0,title:s},function(t,e,n,s){const o=e,i=function(t=1200,e=250,n=at()){return{width:t,height:e,outerWidth:t+(n.left+n.right),outerHeight:e+(n.top+n.bottom)}}(n.w,n.h,o),a=(0,r.Z)(`#${s.root}`).append("svg").attr("id",s.svg).attr("width",i.outerWidth).attr("height",i.outerHeight).append("g").attr("transform",`translate(${o.left}, ${o.top})`),l=i.width,u=i.height,c=.2,h=pt(t.gpConfig.sort,t.sortData,s),p=[],d="TPM",f=!0,g=35,v=!1,b=0,x=!1,m=!1,y=!0,w=!1,$=!0,_=!0;t.render(a,l,u,c,h,p,d,f,g,v,b,x,m,y,w,$,_),ct(t,s)}(g,c,h,d),function(t,e,n,s){const o=function(t,e=!1){const n=["Bladder","Cervix_Ectocervix","Cervix_Endocervix","Fallopian_Tube","Kidney_Cortex"],s="tissueInfo";if(!t.hasOwnProperty(s))throw"Parsing Error: required json attribute is missing: "+s;let o=t[s];["tissueSite","tissueSiteDetailId","tissueSiteDetail"].forEach((t=>{if(!o[0].hasOwnProperty(t))throw`parseTissueSites attr error. ${t} is not found`})),o=0==e?o:o.filter((t=>!n.includes(t.tissueSiteDetailId)));let i=o.reduce(((t,e)=>{let n=e.tissueSite,s={id:e.tissueSiteDetailId,name:e.tissueSiteDetail};return t.hasOwnProperty(n)||(t[n]=[]),t[n].push(s),t}),{});return Object.keys(i).forEach((t=>{if(1==i[t].length){let e=i[t][0];delete i[t],i[e.name]=[e]}})),i}(s);(function(t,e,n=!1,s=!1,o=4){const a="tissue-group-main-level";(0,r.Z)(`#${e}`).selectAll("*").remove();const u=l("<div/>").attr("class","col-xs-12 col-md-12").appendTo(l(`#${e}`));n?l(`<label class=${a}><input type="radio" name="allTissues" value="reset"> Reset </label><br/>`).appendTo(u):l(`<label class=${a}><input type="radio" name="allTissues" value="all"> All </label> <label class=${a}><input type="radio" name="allTissues" value="reset"> Reset </label><br/>`).appendTo(u),l('input[name="allTissues"]').change((function(){switch(l(this).val()){case"all":l(".tissueGroup").prop("checked",!0),l(".tissueSubGroup").prop("checked",!0);break;case"reset":l(".tissueGroup").prop("checked",!1),l(".tissueSubGroup").prop("checked",!1)}}));let c=Object.keys(t).sort(((t,e)=>"Brain"==t?-1:"Brain"==e?1:t<e?-1:t>e?1:void 0)),h=Object.keys(t).reduce(((e,n)=>t[n].length>1?e+1+t[n].length:e+t[n].length),0),p=Math.ceil(h/o),d=h%o,f=Math.floor(12/o);const g=(0,i.w6)(0,o).map((t=>l(`<div id="section${t}" class="col-xs-12 col-md-${f}">`).appendTo(l(`#${e}`))));let v=0,b=0;c.forEach((e=>{let n=t[e];const s=e.replace(/ /g,"_");let o=n.length;o=1==o?o:o+1,0!=v&&o+v>p+d&&(v=0,b+=1),v+=o;let i=g[b];l(`<label class=${a}><input type="checkbox" id="${s}" class="tissueGroup"> <span>${e}</span></label><br/>`).appendTo(i),n.length>1&&n.sort(((t,e)=>t.id>e.id?1:t.id<e.id?-1:0)).forEach((function(t,e){let s=l(`<label class=tissue-group-sub-level><input type="checkbox" id="${t.id}" class="tissueSubGroup"> <span>${t.name}</span></label><br/>`).appendTo(i);e==n.length-1&&s.addClass("last-site"),s.click((function(){l('input[name="allTissues"]').prop("checked",!1)}))})),l("#"+s).click((function(){l('input[name="allTissues"]').prop("checked",!1),l("#"+s).is(":checked")?n.forEach((function(t){"id"!=t.id&&l("#"+t.id).prop("checked",!0)})):n.forEach((function(t){"id"!=t.id&&l("#"+t.id).prop("checked",!1)}))}))})),s&&(l('input[name="allTissues"][value="all"]').prop("checked",!0),l(".tissueGroup").prop("checked",!0),l(".tissueSubGroup").prop("checked",!0))})(o,`${e}-body`,!1,!0,3),function(t,e,n,s){ot(`#${e}`).on("hidden.bs.modal",(o=>{let i=function(t,e,n=!1){let s=[];return l(`#${e}`).find(":input").each((function(){if(l(this).is(":checked")){const e=l(this).attr("id");if(l(this).hasClass("tissueGroup")){let o=e.replace(/_/g," ");1==t[o].length&&(n?s.push(t[o][0].name):s.push(t[o][0].id))}else n?s.push(l(l(this).siblings()[0]).text()):s.push(e)}})),s.filter((t=>void 0!==t))}(s,`${e}-body`,!0);!function(t,e,n){let s=t.allData.filter((t=>n.includes(t.group)));t.data=s,dt(t,e)}(t,n,i)}))}(t,e,n,o)}(g,d.tissueFilter,d,t[0]),function(t,e,n,s){let o=t.createToolbar(n.toolbar,e);o.createDownloadSvgButton(n.buttons.download,n.svg,"gene-exp-plot.svg",n.clone),ot(`#${n.toolbar}`).addClass("row"),ot(`#${n.toolbar} .btn-group`).addClass("col-xs-12 col-lg-1 text-nowrap").css("display","flex"),ot("<div></div>").appendTo(`#${n.toolbar}`).attr("id",`${n.toolbar}-plot-options`).attr("class","col-lg-11 text-nowrap");let i=ot(`#${n.toolbar}-plot-options`);ot("<div/>").appendTo(i).attr("id",n.plotOptionGroups.differentiation).attr("class","col-lg-2 col-xl-2"),ot("<span/>").appendTo(`#${n.plotOptionGroups.differentiation}`).attr("class",`${n.root}-option-label`).html("Subset"),ot("<div/>").appendTo(`#${n.plotOptionGroups.differentiation}`).attr("class","btn-group btn-group-sm");let l=ot(`#${n.plotOptionGroups.differentiation} .btn-group`);ot(`<button class="btn btn-default" id="${n.buttons.noDiff}">None</button>`).appendTo(l),ot(`<button class="btn btn-default" id="${n.buttons.sexDiff}">Sex</button>`).appendTo(l),ot("<div/>").appendTo(i).attr("id",n.plotOptionGroups.scale).attr("class","col-lg-2 col-xl-2"),ot("<span/>").appendTo(`#${n.plotOptionGroups.scale}`).attr("class",`${n.root}-option-label`).html("Scale"),ot("<div/>").appendTo(`#${n.plotOptionGroups.scale}`).attr("class","btn-group btn-group-sm");let u=ot(`#${n.plotOptionGroups.scale} .btn-group`);ot(`<button class="btn btn-default" id="${n.buttons.logScale}">Log</button>`).appendTo(u),ot(`<button class="btn btn-default" id="${n.buttons.linearScale}">Linear</button>`).appendTo(u),ot("<div/>").appendTo(i).attr("class",`${n.plotOptionGroups.sort} col-lg-2 col-xl-2`).attr("id","vplot-alpha-sorts"),ot("<span/>").appendTo(`.${n.plotOptionGroups.sort}#vplot-alpha-sorts`).attr("class",`${n.root}-option-label`).html("Tissue Sort"),ot("<div/>").appendTo(`.${n.plotOptionGroups.sort}#vplot-alpha-sorts`).attr("class","btn-group btn-group-sm").attr("id",`${n.plotOptionGroups.sort}-alpha`);let c=ot(`#${n.plotOptionGroups.sort}-alpha.btn-group`);ot(`<button class="btn btn-default fa fa-caret-up" id="${n.buttons.ascAlphaSort}"></button>`).appendTo(c),ot(`<button class="btn btn-default fa fa-caret-down" id="${n.buttons.descAlphaSort}"></button>`).appendTo(c),ot("<div/>").appendTo(i).attr("class",`${n.plotOptionGroups.sort} col-lg-2 col-xl-2`).attr("id","vplot-num-sorts"),ot("<span/>").appendTo(`.${n.plotOptionGroups.sort}#vplot-num-sorts`).attr("class",`${n.root}-option-label`).html("Median Sort"),ot("<div/>").appendTo(`.${n.plotOptionGroups.sort}#vplot-num-sorts`).attr("class","btn-group btn-group-sm").attr("id",`${n.plotOptionGroups.sort}-num`);let h=ot(`#${n.plotOptionGroups.sort}-num.btn-group`);ot(`<button class="btn btn-default fa fa-caret-up" id="${n.buttons.ascSort}"></button>`).appendTo(h),ot(`<button class="btn btn-default fa fa-caret-down" id="${n.buttons.descSort}"></button>`).appendTo(h),ot("<div/>").appendTo(i).attr("id",n.plotOptionGroups.outliers).attr("class","col-lg-2 col-xl-2"),ot("<span/>").appendTo(`#${n.plotOptionGroups.outliers}`).attr("class",`${n.root}-option-label`).html("Outliers"),ot("<div/>").appendTo(`#${n.plotOptionGroups.outliers}`).attr("class","btn-group btn-group-sm");let p=ot(`#${n.plotOptionGroups.outliers} .btn-group`);ot(`<button class="btn btn-default" id="${n.buttons.outliersOn}">On</button>`).appendTo(p),ot(`<button class="btn btn-default" id="${n.buttons.outliersOff}">Off</button>`).appendTo(p),(0,a.Z)(`#${n.plotOptionsModal} .modal-body button`).classed("active",!1),(0,a.Z)(`#${n.buttons.ascAlphaSort},\n               #${n.buttons.linearScale},\n               #${n.buttons.noDiff},\n               #${n.buttons.outliersOn}`).classed("active",!0),o.createButton(n.buttons.filter,"fa-filter"),(0,r.Z)(`#${n.buttons.filter}`).on("mouseover",(()=>{o.tooltip.show("Filter Tissues")})).on("mouseout",(()=>{o.tooltip.hide()})).on("click",((t,e,n)=>{ot("#gene-expr-vplot-filter-modal").modal("show")})),ot(`.${n.plotOptionGroups.sort} button`).on("click",(function(e){let s=(0,r.Z)(this);s.classed("active")||((0,a.Z)(`.${n.plotOptionGroups.sort} button`).classed("active",!1),s.classed("active",!0),t.gpConfig.sort=e.target.id.replace(`${n.root}-`,""),dt(t,n))})),ot(`#${n.plotOptionGroups.scale} button`).on("click",(function(e){let s=(0,r.Z)(this);s.classed("active")||((0,a.Z)(`#${n.plotOptionGroups.scale} button`).classed("active",!1),s.classed("active",!0),t.gpConfig.scale=e.target.id==n.buttons.logScale?"log":"linear",dt(t,n))})),ot(`#${n.plotOptionGroups.outliers} button`).on("click",(function(e){let s=(0,r.Z)(this);s.classed("active")||((0,a.Z)(`#${n.plotOptionGroups.outliers} button`).classed("active",!1),s.classed("active",!0),t.gpConfig.showOutliers=e.target.id==n.buttons.outliersOn,ht(t,n))})),ot(`#${n.plotOptionGroups.differentiation} button`).on("click",(function(e){let s=(0,r.Z)(this);s.classed("active")||((0,a.Z)(`#${n.plotOptionGroups.differentiation} button`).classed("active",!1),s.classed("active",!0),t.gpConfig.subset=e.target.id==n.buttons.sexDiff,dt(t,n))}))}(g,v,d),ot(`#${d.root} #${d.spinner}`).hide()}))}function at(t=50,e=50,n=50,s=50){return{top:t,right:e,bottom:n,left:s}}function rt(t,e=!0){t.forEach((t=>{t.values=e?t.data.map((t=>Math.log10(+t+1))):t.data,t.values.sort(i.j2),t.median=(0,i.C2)(t.values)}))}function lt(t,e,n,s=!0){const o="geneExpression";if(!t.hasOwnProperty(o))throw"Parse Error: required json attribute is missing: "+o;return t[o].forEach((t=>{["data","tissueSiteDetailId","geneSymbol","gencodeId"].forEach((e=>{if(!t.hasOwnProperty(e))throw console.error(t),"Parse Error: required json attribute is missing: "+e})),t.group=void 0===e?t.tissueSiteDetailId:e[t.tissueSiteDetailId],t.label=void 0===t.subsetGroup?t.geneSymbol:t.subsetGroup,t.color=void 0===n?"#90c1c1":void 0===t.subsetGroup?`#${n[t.tissueSiteDetailId]}`:n[t.subsetGroup]})),rt(t[o],s),t[o]}function ut(t){const e=t.select(".violin-x-axis");e.attr("transform",`${e.attr("transform")} translate(0, 3)`)}function ct(t,e){let n=(0,r.Z)(`#${e.svg} g`);void 0!==t.gpConfig.title&&t.addPlotTitle(n,t.gpConfig.title),ht(t,e),t.gpConfig.subset?function(t,e,n,s="top"){ut(e);const o=e.selectAll(".violin-x-axis text");o.attr("transform",`translate(0, 8) ${o.attr("transform")}`),e.append("g").selectAll(".tcolor").data(t.scale.x.domain()).enter().append("rect").classed("tcolor",!0).attr("x",(e=>t.scale.x(e))).attr("y",(e=>"top"==s?t.scale.y.range()[1]:t.scale.y.range()[0])).attr("transform","translate(0, 14)").attr("width",(e=>t.scale.x.bandwidth())).attr("height",5).style("stroke-width",0).style("fill",(t=>`#${n[t].colorHex}`)).style("opacity",.9)}(t,n,t.tissueDict,"bottom"):((0,r.Z)(`#${e.svg} #violinLegend`).remove(),ut(n)),function(t){(0,a.Z)(".violin-g").on("mouseover",((e,n,s)=>{let o="log"==t.gpConfig.scale?Math.pow(10,e.median)-1:e.median;(0,r.Z)(s[n]).select("path").classed("highlighted",!0),t.gpConfig.subset?t.tooltip.show(e.group+"<br/>"+e.label+` (n = ${e.values.length})<br/>`+`Median${t.unit}: ${o.toPrecision(4)}<br/>`):t.tooltip.show(e.group+"<br/>"+`n = ${e.values.length}<br/>`+`Median${t.unit}: ${o.toPrecision(4)}<br/>`)}))}(t)}function ht(t,e){(0,a.Z)(`#${e.svg} path.violin`).classed("outlined",!t.gpConfig.showOutliers),ot(`#${e.svg} .violin-outliers`).toggle(t.gpConfig.showOutliers)}function pt(t,e,n){switch(t){case n.plotSorts.ascAlphaSort:e.sort(((t,e)=>t.group<e.group?-1:t.group>e.group?1:0));break;case n.plotSorts.descAlphaSort:e.sort(((t,e)=>t.group<e.group?1:t.group>e.group?-1:0));break;case n.plotSorts.ascSort:e.sort(((t,e)=>t.median-e.median));break;case n.plotSorts.descSort:e.sort(((t,e)=>e.median-t.median))}return e.map((t=>t.group))}function dt(t,e){let n=t.gpConfig.subset?t.geneJson.subsetData:t.geneJson.allData;const s="log"==t.gpConfig.scale?lt(n,t.tIdNameMap,t.groupColorDict):lt(n,t.tIdNameMap,t.groupColorDict,!1);let o=t.data.map((t=>t.group));t.allData=s.map((t=>t)),t.data=s.filter((t=>-1!=o.indexOf(t.group)));let i=t.sortData.filter((t=>o.includes(t.group))),a=pt(t.gpConfig.sort,i,e);rt(t.data,"log"==t.gpConfig.scale),rt(t.allData,"log"==t.gpConfig.scale);let r="log"==t.gpConfig.scale?"log10(TPM+1)":"TPM";t.updateXScale(a),t.updateYScale(r),ct(t,e)}},1300:function(t,e,n){n.d(e,{Z:function(){return i}});var s=n(5130),o=n(42274);n(47306);class i{constructor(t,e=!1,n=30,s=-40,o=100){this.id=t,this.verbose=e,this.offsetX=n,this.offsetY=s,this.duration=o}show(t){this.verbose&&console.log(t),this.edit(t),this.move(),(0,s.Z)("#"+this.id).style("display","inline").transition().duration(this.duration).style("opacity",1)}hide(){(0,s.Z)("#"+this.id).transition().duration(this.duration).style("opacity",0),this.edit("")}move(t=o.B.pageX,e=o.B.pageY){this.verbose&&(console.log(t),console.log(e)),t+=this.offsetX,e=e+this.offsetY<0?10:e+this.offsetY;(0,s.Z)("#"+this.id).style("left",`${t}px`).style("top",`${e}px`)}edit(t){(0,s.Z)("#"+this.id).html(t)}}}}]);