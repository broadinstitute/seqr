"use strict";(self.webpackChunkseqr=self.webpackChunkseqr||[]).push([[180],{44449:function(e,t,n){n.r(t),n.d(t,{drag:function(){return r.oh},dragDisable:function(){return r.Kn},dragEnable:function(){return r.eF},cluster:function(){return i.ki},hierarchy:function(){return i.bT},pack:function(){return i.P2},packEnclose:function(){return i.O1},packSiblings:function(){return i.jA},partition:function(){return i.uK},stratify:function(){return i.QP},tree:function(){return i.G_},treemap:function(){return i.pN},treemapBinary:function(){return i.wL},treemapDice:function(){return i.LQ},treemapResquarify:function(){return i.eA},treemapSlice:function(){return i.Km},treemapSliceDice:function(){return i.E_},treemapSquarify:function(){return i.o$},arc:function(){return o.Nb},area:function(){return o.SO},areaRadial:function(){return o.am},curveBasis:function(){return o.$0},curveBasisClosed:function(){return o.Dt},curveBasisOpen:function(){return o.WQ},curveBundle:function(){return o.tF},curveCardinal:function(){return o.YY},curveCardinalClosed:function(){return o.Ov},curveCardinalOpen:function(){return o.dC},curveCatmullRom:function(){return o.zg},curveCatmullRomClosed:function(){return o.fG},curveCatmullRomOpen:function(){return o.$m},curveLinear:function(){return o.c_},curveLinearClosed:function(){return o.fx},curveMonotoneX:function(){return o.Fd},curveMonotoneY:function(){return o.ak},curveNatural:function(){return o.Sx},curveStep:function(){return o.eA},curveStepAfter:function(){return o.js},curveStepBefore:function(){return o.iJ},line:function(){return o.jv},lineRadial:function(){return o.XB},linkHorizontal:function(){return o.h5},linkRadial:function(){return o.M4},linkVertical:function(){return o.rR},pie:function(){return o.ve},pointRadial:function(){return o.Hs},radialArea:function(){return o.N1},radialLine:function(){return o.aJ},stack:function(){return o.kn},stackOffsetDiverging:function(){return o.W$},stackOffsetExpand:function(){return o.pB},stackOffsetNone:function(){return o.HL},stackOffsetSilhouette:function(){return o.Ku},stackOffsetWiggle:function(){return o.YG},stackOrderAppearance:function(){return o.mG},stackOrderAscending:function(){return o.$K},stackOrderDescending:function(){return o.IX},stackOrderInsideOut:function(){return o.FP},stackOrderNone:function(){return o.Qx},stackOrderReverse:function(){return o.cY},symbol:function(){return o.NA},symbolCircle:function(){return o.JF},symbolCross:function(){return o.tJ},symbolDiamond:function(){return o.rZ},symbolSquare:function(){return o.m_},symbolStar:function(){return o.Hm},symbolTriangle:function(){return o.P6},symbolWye:function(){return o.n3},symbols:function(){return o.uH},clientPoint:function(){return a.Eb},create:function(){return a.Ue},creator:function(){return a.Du},customEvent:function(){return a._H},event:function(){return a.B},local:function(){return a.I_},matcher:function(){return a.C2},mouse:function(){return a.Jz},namespace:function(){return a.uD},namespaces:function(){return a.aC},select:function(){return a.Ys},selectAll:function(){return a.td},selection:function(){return a.f_},selector:function(){return a.nZ},selectorAll:function(){return a.UK},style:function(){return a.oB},touch:function(){return a.Fq},touches:function(){return a.W4},window:function(){return a.u9},zoom:function(){return u.sP},zoomIdentity:function(){return u.CR},zoomTransform:function(){return u.P2}});var r=n(37345),i=n(47367),o=n(60508),a=n(56164),u=n(66842)},16028:function(e,t,n){n.r(t),n.d(t,{default:function(){return ye}});var r=n(92437),i=n(66318),o=n.n(i),a=n(20347),u=n(18063),c=n(19804),l=n(15161),f=n(53417),s=n(38396),d=n(10527),m=n(56327),p=n(85516),y=n(91843),b=n(769),g=n(75234),v=n(93755),h=n(51084),O=n(5718),P=n(20738),S=n(26493),E=n(75041),I=n(31722),w=n(77178),j=n(29332),k=n(22322),_=n(62699),D=n(66211);function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t){return T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},T(e,t)}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=r.lazy((function(){return Promise.all([n.e(190),n.e(557)]).then(n.bind(n,32639))})),z=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}(this,x(t).call(this,e)),F(A(n),"state",{error:null}),F(A(n),"onFinished",(function(e){var t=n.props.onSuccess;return 200===e.status?t(JSON.parse(e.response),n.modalId):n.setState({error:"Error: ".concat(e.statusText," (").concat(e.status,")")})})),n.modalId="uploadPedigree-".concat(e.family.familyGuid),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,e),n=t,(i=[{key:"render",value:function(){var e=this.props.family,t=this.state.error;return r.createElement(S.Z,{title:"Upload Pedigree for Family ".concat(e.familyId),modalName:this.modalId,trigger:r.createElement(E.ZP,{content:"Upload New Image",icon:"upload",labelPosition:"right"})},r.createElement(r.Suspense,{fallback:r.createElement(I.Z,null)},r.createElement(G,{onUploadFinished:this.onFinished,url:"/api/family/".concat(e.familyGuid,"/update_pedigree_image"),clearTimeOut:0,auto:!0,maxFiles:1,dropzoneLabel:"Drag and drop or click to upload pedigree image"})),t&&r.createElement(w.Z,{error:!0,content:t}))}}])&&C(n.prototype,i),o&&C(n,o),t}(r.PureComponent);F(z,"propTypes",{family:o().object,onSuccess:o().func});var N=(0,a.$j)(null,(function(e){return{onSuccess:function(t,n){e({type:k.Yt,updatesById:{familiesByGuid:t}}),e((0,g.Mr)(n))}}}))(z),B=r.memo((function(e){var t=e.onSubmit,n=e.onSuccess;return r.createElement(_.Z,{onSubmit:t,onSuccess:n,confirmDialog:"Are you sure you want to delete the pedigree image for this family?",buttonText:"Delete Pedigree Image"})}));B.propTypes={onSubmit:o().func,onSuccess:o().func};var R=(0,a.$j)(null,(function(e,t){return{onSubmit:function(){return e((0,j.S)({familyField:"pedigree_image",familyGuid:t.familyGuid}))},onSuccess:function(){return e((0,g.Mr)(t.modalId))}}}))(B),Y=r.memo((function(e){var t=e.onSubmit,n=e.onSuccess;return r.createElement(D.Z,{onSubmit:t,onSuccess:n,icon:"save",size:"huge",confirmDialog:"Are you sure you want to save this pedigree?"})}));Y.propTypes={onSubmit:o().func,onSuccess:o().func};var H=(0,a.$j)(null,(function(e,t){return{onSubmit:function(){return e((0,j.S)({pedigreeDataset:t.getPedigreeDataset(),familyGuid:t.familyGuid}))},onSuccess:function(){return e((0,g.Mr)(t.modalId))}}}))(Y),M=n(6939);function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function L(){return L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},L.apply(this,arguments)}function $(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){u=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw i}}return o}(e,t)||ne(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){return W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},W(e,t)}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e){return function(e){if(Array.isArray(e))return re(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ne(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){if(e){if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?re(e,t):void 0}}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ie=s.ZP.img.attrs({alt:"pedigree"}).withConfig({displayName:"LazyPedigreeImagePanel__PedigreeImg"})(["max-height:","px;max-width:225px;vertical-align:top;cursor:",";"],(function(e){return e.maxHeight}),(function(e){return e.disablePedigreeZoom?"auto":"zoom-in"})),oe=(0,s.ZP)(E.S_).withConfig({displayName:"LazyPedigreeImagePanel__PedigreeJsContainer"})(["display:",";cursor:",";i.fa{cursor:pointer;}@font-face{font-family:'ped-icon-overrides';src:url(\"/static/fonts/icon-overrides.eot\");src:url(\"/static/fonts/icon-overrides.eot?#iefix\") format('embedded-opentype'),url(\"/static/fonts/icon-overrides.woff\") format('woff'),url(\"/static/fonts/icon-overrides.ttf\") format('truetype'),url(\"/static/fonts/icon-overrides.svg#icons\") format('svg');}.addchild,.addsibling,.addpartner,.addparents,.delete,.settings,.popup_selection{font-family:Icons !important;cursor:pointer;&.fa-circle,&.fa-square,&.fa-unspecified{font-family:ped-icon-overrides !important;}}"],(function(e){return e.disablePedigreeZoom&&e.isEditable?"auto":"none"}),(function(e){return e.disablePedigreeZoom?"auto":"zoom-in"})),ae="editPedIndividual",ue=[{name:"label",label:"Individual ID"},{name:"affected",label:"Affected?",component:P.JV,fullHeight:!0,asFormInput:!0},X({name:v.Sk,label:"Sex"},v.HO[v.Sk].formFieldProps),{name:"yob",label:"Birth Year",component:P.p6,width:6},{name:"status",label:"Living?",component:P.Ee,options:[{value:0,text:"Alive"},{value:1,text:"Deceased"}]}].concat(te(["adopted_in","adopted_out","miscarriage","termination"].map((function(e){return{name:e,label:(0,h._e)(e),component:P.a1,inline:!0}})))),ce={name:"individualGuid",label:"displayName",sex:"sex",affected:"affected",yob:"birthYear",mother:"maternalGuid",father:"paternalGuid",status:"deathYear"},le={background:"#fff",diseases:[],labels:["label","age"],zoomIn:3,zoomOut:3,zoomSrc:["button"]},fe=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){if(t&&("object"===J(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return V(e)}(this,K(t).call(this,e)),ee(V(n),"state",{}),ee(V(n),"setContainerElement",(function(e){n.container=e})),ee(V(n),"redrawPedigree",(function(e,t){e.dataset=(0,y.KY)(n.yobToAge(t||e.dataset));try{(0,p.ZR)(e)}catch(e){throw(0,y.sY)("Error",e.message),e}return(0,p.VU)(e),e})),ee(V(n),"setPedigreeImage",(function(e){var t=M(n.container.children[0]);(0,d.PI)(t,"pedigree",{resolution:10}).done((function(t){var r=t.img;n.setState({pedigreeOpts:e,imgSrc:r})}))})),ee(V(n),"unsetPedigreeImage",(function(){n.setState({imgSrc:null})})),ee(V(n),"isEditablePedigree",(function(){var e=n.props,t=e.disablePedigreeZoom,r=e.isEditable;return t&&r})),ee(V(n),"getFamilyDataset",(function(){var e=n.props,t=e.family,r=e.individuals,i=t.pedigreeDataset||(r||[]).map((function(e){return Object.entries(ce).reduce((function(t,n){var r=U(n,2),i=r[0],o=r[1],a=e[o];if("affected"===i)a=a===v.H5;else if("status"===i)a=a||0===a?1:0;else if(!a&&("mother"===i||"father"===i))return t;return X({},t,ee({},i,a))}),{})})).map((function(e){return e.mother||e.father?e:X({},e,{top_level:!0})})),o={};return i.filter((function(e){var t=e.mother,n=e.father;return t&&!n||!t&&n})).forEach((function(e){var t="".concat(e.mother||e.father,"-spouse-placeholder");o[t]||(o[t]={name:t,sex:e.mother?"M":"F",top_level:!0}),e.mother?e.father=t:e.mother=t})),n.yobToAge([].concat(te(i),te(Object.values(o))))})),ee(V(n),"yobToAge",(function(e){return e.map((function(e){return X({},e,{age:e.yob&&(new Date).getFullYear()-e.yob})}))})),ee(V(n),"editIndividual",(function(e,t){var r=t.data,i=n.props.openIndividualModal;n.setState({editIndividual:{data:r,save:function(t){Object.assign(r,t),n.redrawPedigree(e)}}}),i()})),ee(V(n),"getPedigreeDataset",(function(){var e=n.state.pedigreeOpts;return(0,m.Vk)(e)})),n.containerId="pedigreeJS-".concat(e.family.familyGuid),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,e),n=t,(i=[{key:"componentDidMount",value:function(){this.props.family.pedigreeImage||this.drawPedigree()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,r=n.family,i=n.individuals,o=this.state,a=o.imgSrc,u=o.pedigreeOpts;if(!r.pedigreeImage&&(e.family.pedigreeImage||e.family.pedigreeDataset!==r.pedigreeDataset||e.individuals!==i&&!r.pedigreeDataset||t.imgSrc&&!a))if(a)this.unsetPedigreeImage();else{var c=this.redrawPedigree(u,this.getFamilyDataset());this.isEditablePedigree()||this.setPedigreeImage(c)}}},{key:"drawPedigree",value:function(){var e=this.getFamilyDataset(),t=X({dataset:this.getFamilyDataset(),targetDiv:this.containerId,btn_target:"".concat(this.containerId,"-buttons"),edit:this.editIndividual,font_size:e.length<6?"1.3em":".8em",symbol_size:e.length<6?60:40},le),n=(0,p.J_)(t);this.isEditablePedigree()?(M(".fa-refresh").remove(),this.setState({pedigreeOpts:n})):this.setPedigreeImage(n)}},{key:"render",value:function(){var e=this.props,t=e.family,n=e.modalId,i=$(e,["family","modalId"]),o=this.state,a=o.imgSrc,u=o.editIndividual,l=void 0===u?{}:u,f=t.pedigreeImage||a;return f?r.createElement(ie,L({src:f},i)):r.createElement(oe,i,r.createElement(E._N,{basic:"very",compact:"very"},r.createElement(c.Z.Body,null,r.createElement(c.Z.Row,null,r.createElement(c.Z.Cell,null,r.createElement("div",{id:"".concat(this.containerId,"-buttons")})),r.createElement(c.Z.Cell,{collapsing:!0},r.createElement(H,{modalId:n,familyGuid:t.familyGuid,getPedigreeDataset:this.getPedigreeDataset}))))),r.createElement("div",{ref:this.setContainerElement,id:this.containerId}),r.createElement(S.Z,{title:(l.data||{}).label,modalName:ae},r.createElement(O.Z,{onSubmit:l.save,modalName:ae,initialValues:l.data,fields:ue,submitButtonText:"Update",confirmCloseIfNotSaved:!0})))}}])&&q(n.prototype,i),o&&q(n,o),t}(r.PureComponent);ee(fe,"propTypes",{family:o().object,disablePedigreeZoom:o().bool,isEditable:o().bool,individuals:o().arrayOf(o().object),openIndividualModal:o().func,modalId:o().string});var se=(0,a.$j)((function(e,t){return{individuals:(0,b.ae)(e)[t.family.familyGuid]}}),(function(e){return{openIndividualModal:function(){e((0,g.h7)(ae))}}}))(fe),de=function(){return r.createElement(l.Z,{name:"picture"})},me=function(e){return r.createElement(u.ErrorBoundary,{FallbackComponent:de},r.createElement(se,e))},pe=r.memo((function(e){var t=e.family,n=e.isEditable,i=e.disablePedigreeZoom,o=t.pedigreeImage||t.pedigreeDataset||t.individualGuids.length>1;if(!o&&!n)return null;var a=o&&r.createElement(me,{family:t,disablePedigreeZoom:i,maxHeight:"150"});if(i)return a;var u="Pedigree-".concat(t.familyGuid);return r.createElement(S.Z,{modalName:u,title:"Family ".concat(t.displayName),trigger:a||r.createElement(E.ZP,{content:"Edit Pedigree Image",icon:"edit"})},r.createElement(f.Z,{basic:!0,textAlign:"center"},r.createElement(me,{family:t,disablePedigreeZoom:!0,isEditable:n,modalId:u,maxHeight:"250"}),r.createElement("br",null)),r.createElement(E._N,{basic:"very",compact:"very",collapsing:!0},r.createElement(c.Z.Body,null,r.createElement(c.Z.Row,null,t.pedigreeImage&&r.createElement(c.Z.Cell,null,r.createElement("a",{key:"zoom",href:t.pedigreeImage,target:"_blank",rel:"noreferrer"},"Original Size",r.createElement(l.Z,{name:"zoom"}))),n&&r.createElement(c.Z.Cell,null,r.createElement(N,{key:"upload",family:t})),n&&t.pedigreeImage&&r.createElement(c.Z.Cell,null,r.createElement(R,{familyGuid:t.familyGuid,modalId:u}))))))}));pe.propTypes={family:o().object.isRequired,disablePedigreeZoom:o().bool,isEditable:o().bool};var ye=pe}}]);